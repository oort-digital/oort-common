"use strict";var Ru=require("ethers");const zi="cur_connector",Pu=()=>{const t=localStorage.getItem(zi);return t?JSON.parse(t):void 0},Fu=t=>localStorage.setItem(zi,JSON.stringify(t)),Lu=()=>localStorage.removeItem(zi);class Mu{constructor(e,r){this.connectorsByName={},this._logger=e,this.WaitInitialisationAsync=this.InitAsync(r,Pu())}async InitAsync(e,r){let i;for(let n=0;n<e.length;n++){const s=e[n];this.connectorsByName[s.name]=s,s.name===r?.name&&await s.isConnected&&(i=s)}i&&await i.connect(r.chainId)&&(this._curConnector=i,this._logger.debug(`Current connector is ${this._curConnector.name}`))}get CurConnector(){return this._curConnector}async connect(e,r){await this.WaitInitialisationAsync;const i=this.connectorsByName[r];await i.connect(e)&&(Fu({chainId:e,name:r}),this._curConnector=i)}async disconnect(){var e;await((e=this._curConnector)==null?void 0:e.disconnect()),Lu(),this._curConnector=void 0}}class Es{constructor(e,r,i){this._chains={},this._externalAccountChangedHandlers=[],this._externalChainChangedHandlers=[],this._externalDisconnectHandlers=[],this._checkConnectionDelayMs=500,this.name=r,this.logger=e,i.forEach(n=>this._chains[n.chainId]=n)}async CheckConnection(){await this.isConnected||(this._timerId&&(clearInterval(this._timerId),this.logger.debug(`${this.name}Connector. CheckConnection stopped`)),this._externalDisconnectHandlers.forEach(e=>e(void 0)),this._externalDisconnectHandlers=[])}initListeners(e){this.logger.debug("initListeners");const r=this;this.accountsChangedHandler=i=>{this.logger.debug(`${this.name}.accountsChangedHandler`),r._externalAccountChangedHandlers.forEach(n=>n(i))},this.chainChangedHandler=i=>{this.logger.debug(`${this.name}.chainChangedHandler`),r._externalChainChangedHandlers.forEach(n=>n(i))},this.disconnectHandler=i=>{this.logger.debug(`${this.name}.disconnectHandler ${JSON.stringify(i)}`),r._externalDisconnectHandlers.forEach(n=>n(i))},e.on("accountsChanged",this.accountsChangedHandler),e.on("chainChanged",this.chainChangedHandler)}removeListeners(e){e.removeListener("accountsChanged",this.accountsChangedHandler),e.removeListener("chainChanged",this.chainChangedHandler),this._externalAccountChangedHandlers=[],this._externalChainChangedHandlers=[],this._externalDisconnectHandlers=[]}onAccountsChanged(e){this._externalAccountChangedHandlers.push(e)}onChainChanged(e){this._externalChainChangedHandlers.push(e)}onDisconnect(e){if(!this._timerId){const r=this;this._timerId=setInterval(()=>r.CheckConnection(),this._checkConnectionDelayMs)}this._externalDisconnectHandlers.push(e)}async getSigner(){return new Ru.providers.Web3Provider(await this.getRawProvider()).getSigner()}async disconnect(){this.removeListeners(await this.getRawProvider())}}var ui=(t=>(t.Undefined="",t.Injected="Injected",t.WalletConnect="WalletConnect",t))(ui||{});const hi={UserReject:4001,UnknownChain:4902};class Bu extends Es{constructor(e,r){super(e,ui.Injected,r),this.addEthereumChain=async(i,n)=>{try{const s=this._chains[i],l=s.blockExplorer?[s.blockExplorer]:void 0;await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:n,chainName:s.name,rpcUrls:[s.rpcUrl],nativeCurrency:s.nativeCurrency,blockExplorerUrls:l}]})}catch(s){if(s.code===hi.UserReject)return!1;throw s}return!0},this._ethRequestAccounts=void 0,this.isInstalled&&this.initListeners(window.ethereum)}get canSwitchChain(){return!!window.ethereum.isMetaMask}async connect(e){if(this._ethRequestAccounts)return this.logger.debug("InjectedConnector.enable already called"),await this._ethRequestAccounts;this.logger.debug("InjectedConnector.enable"),this._ethRequestAccounts=this.prvEnable();const r=await this._ethRequestAccounts;return this._ethRequestAccounts=void 0,await(await this.getSigner()).getChainId()!==e&&await this.switchChain(e),r}async switchChain(e){const r=`0x${e.toString(16)}`;try{if(!this._chains[e])throw new Error(`Chain ${e} not supported`);await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]})}catch(i){if(i.code===hi.UnknownChain)return await this.addEthereumChain(e,r);if(i.code===hi.UserReject)return!1;throw i}return!0}get isConnected(){return this.isConnectedAsync()}get isInstalled(){return!!window.ethereum}get installUrl(){return"https://metamask.io/download"}getRawProvider(){return Promise.resolve(window.ethereum)}async prvEnable(){try{await window.ethereum.request({method:"eth_requestAccounts"})}catch(e){return e.code===hi.UserReject?this.logger.warn("Please connect to MetaMask."):this.logger.error(e),!1}return!0}async isConnectedAsync(){return(await window.ethereum.request({method:"eth_accounts"})).length>0}}var ht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $u(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function qi(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}function ju(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Hu=zu;function zu(t,e,r){var i=r&&r.stringify||ju,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var l=new Array(s);l[0]=i(t);for(var o=1;o<s;o++)l[o]=i(e[o]);return l.join(" ")}if(typeof t!="string")return t;var d=e.length;if(d===0)return t;for(var _="",E=1-n,S=-1,N=t&&t.length||0,I=0;I<N;){if(t.charCodeAt(I)===37&&I+1<N){switch(S=S>-1?S:0,t.charCodeAt(I+1)){case 100:case 102:if(E>=d||e[E]==null)break;S<I&&(_+=t.slice(S,I)),_+=Number(e[E]),S=I+2,I++;break;case 105:if(E>=d||e[E]==null)break;S<I&&(_+=t.slice(S,I)),_+=Math.floor(Number(e[E])),S=I+2,I++;break;case 79:case 111:case 106:if(E>=d||e[E]===void 0)break;S<I&&(_+=t.slice(S,I));var O=typeof e[E];if(O==="string"){_+="'"+e[E]+"'",S=I+2,I++;break}if(O==="function"){_+=e[E].name||"<anonymous>",S=I+2,I++;break}_+=i(e[E]),S=I+2,I++;break;case 115:if(E>=d)break;S<I&&(_+=t.slice(S,I)),_+=String(e[E]),S=I+2,I++;break;case 37:S<I&&(_+=t.slice(S,I)),_+="%",S=I+2,I++,E--;break}++E}++I}return S===-1?t:(S<N&&(_+=t.slice(S)),_)}const vs=Hu;var Ir=Ct;const Or=Zu().console||{},qu={mapHttpRequest:fi,mapHttpResponse:fi,wrapRequestSerializer:Vi,wrapResponseSerializer:Vi,wrapErrorSerializer:Vi,req:fi,res:fi,err:Gu};function Ku(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Ct(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||Or;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=Ku(t.browser.serialize,i);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const l=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const o=t.level||"info",d=Object.create(r);d.log||(d.log=Ar),Object.defineProperty(d,"levelVal",{get:E}),Object.defineProperty(d,"level",{get:S,set:N});const _={transmit:e,serialize:n,asObject:t.browser.asObject,levels:l,timestamp:Yu(t)};d.levels=Ct.levels,d.level=o,d.setMaxListeners=d.getMaxListeners=d.emit=d.addListener=d.on=d.prependListener=d.once=d.prependOnceListener=d.removeListener=d.removeAllListeners=d.listeners=d.listenerCount=d.eventNames=d.write=d.flush=Ar,d.serializers=i,d._serialize=n,d._stdErrSerialize=s,d.child=I,e&&(d._logEvent=Ki());function E(){return this.level==="silent"?1/0:this.levels.values[this.level]}function S(){return this._level}function N(O){if(O!=="silent"&&!this.levels.values[O])throw Error("unknown level "+O);this._level=O,ur(_,d,"error","log"),ur(_,d,"fatal","error"),ur(_,d,"warn","error"),ur(_,d,"info","log"),ur(_,d,"debug","log"),ur(_,d,"trace","log")}function I(O,$){if(!O)throw new Error("missing bindings for child Pino");$=$||{},n&&O.serializers&&($.serializers=O.serializers);const F=$.serializers;if(n&&F){var H=Object.assign({},i,F),f=t.browser.serialize===!0?Object.keys(H):n;delete O.serializers,li([O],f,H,this._stdErrSerialize)}function w(p){this._childLevel=(p._childLevel|0)+1,this.error=hr(p,O,"error"),this.fatal=hr(p,O,"fatal"),this.warn=hr(p,O,"warn"),this.info=hr(p,O,"info"),this.debug=hr(p,O,"debug"),this.trace=hr(p,O,"trace"),H&&(this.serializers=H,this._serialize=f),e&&(this._logEvent=Ki([].concat(p._logEvent.bindings,O)))}return w.prototype=this,new w(this)}return d}Ct.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Ct.stdSerializers=qu,Ct.stdTimeFunctions=Object.assign({},{nullTime:Ds,epochTime:xs,unixTime:Ju,isoTime:Xu});function ur(t,e,r,i){const n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Ar:n[r]?n[r]:Or[r]||Or[i]||Ar,Vu(t,e,r)}function Vu(t,e,r){!t.transmit&&e[r]===Ar||(e[r]=function(i){return function(){const s=t.timestamp(),l=new Array(arguments.length),o=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Or?Or:this;for(var d=0;d<l.length;d++)l[d]=arguments[d];if(t.serialize&&!t.asObject&&li(l,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(o,ku(this,r,l,s)):i.apply(o,l),t.transmit){const _=t.transmit.level||e.level,E=Ct.levels.values[_],S=Ct.levels.values[r];if(S<E)return;Wu(this,{ts:s,methodLevel:r,methodValue:S,transmitLevel:_,transmitValue:Ct.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},l)}}}(e[r]))}function ku(t,e,r,i){t._serialize&&li(r,t._serialize,t.serializers,t._stdErrSerialize);const n=r.slice();let s=n[0];const l={};i&&(l.time=i),l.level=Ct.levels.values[e];let o=(t._childLevel|0)+1;if(o<1&&(o=1),s!==null&&typeof s=="object"){for(;o--&&typeof n[0]=="object";)Object.assign(l,n.shift());s=n.length?vs(n.shift(),n):void 0}else typeof s=="string"&&(s=vs(n.shift(),n));return s!==void 0&&(l.msg=s),l}function li(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=Ct.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(const s in t[n])e&&e.indexOf(s)>-1&&s in r&&(t[n][s]=r[s](t[n][s]))}function hr(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function Wu(t,e,r){const i=e.send,n=e.ts,s=e.methodLevel,l=e.methodValue,o=e.val,d=t._logEvent.bindings;li(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(_){return d.indexOf(_)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=l,i(s,t._logEvent,o),t._logEvent=Ki(d)}function Ki(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Gu(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Yu(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Ds:xs}function fi(){return{}}function Vi(t){return t}function Ar(){}function Ds(){return!1}function xs(){return Date.now()}function Ju(){return Math.round(Date.now()/1e3)}function Xu(){return new Date(Date.now()).toISOString()}function Zu(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var ot={exports:{}},lr=typeof Reflect=="object"?Reflect:null,Ss=lr&&typeof lr.apply=="function"?lr.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},di;lr&&typeof lr.ownKeys=="function"?di=lr.ownKeys:Object.getOwnPropertySymbols?di=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:di=function(e){return Object.getOwnPropertyNames(e)};function Qu(t){console&&console.warn&&console.warn(t)}var Is=Number.isNaN||function(e){return e!==e};function Ae(){Ae.init.call(this)}ot.exports=Ae,ot.exports.once=ih,Ae.EventEmitter=Ae,Ae.prototype._events=void 0,Ae.prototype._eventsCount=0,Ae.prototype._maxListeners=void 0;var Os=10;function pi(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ae,"defaultMaxListeners",{enumerable:!0,get:function(){return Os},set:function(t){if(typeof t!="number"||t<0||Is(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Os=t}}),Ae.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ae.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Is(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function As(t){return t._maxListeners===void 0?Ae.defaultMaxListeners:t._maxListeners}Ae.prototype.getMaxListeners=function(){return As(this)},Ae.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var l;if(r.length>0&&(l=r[0]),l instanceof Error)throw l;var o=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw o.context=l,o}var d=s[e];if(d===void 0)return!1;if(typeof d=="function")Ss(d,this,r);else for(var _=d.length,E=Rs(d,_),i=0;i<_;++i)Ss(E[i],this,r);return!0};function Cs(t,e,r,i){var n,s,l;if(pi(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),l=s[e]),l===void 0)l=s[e]=r,++t._eventsCount;else if(typeof l=="function"?l=s[e]=i?[r,l]:[l,r]:i?l.unshift(r):l.push(r),n=As(t),n>0&&l.length>n&&!l.warned){l.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=l.length,Qu(o)}return t}Ae.prototype.addListener=function(e,r){return Cs(this,e,r,!1)},Ae.prototype.on=Ae.prototype.addListener,Ae.prototype.prependListener=function(e,r){return Cs(this,e,r,!0)};function eh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ts(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=eh.bind(i);return n.listener=r,i.wrapFn=n,n}Ae.prototype.once=function(e,r){return pi(r),this.on(e,Ts(this,e,r)),this},Ae.prototype.prependOnceListener=function(e,r){return pi(r),this.prependListener(e,Ts(this,e,r)),this},Ae.prototype.removeListener=function(e,r){var i,n,s,l,o;if(pi(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,l=i.length-1;l>=0;l--)if(i[l]===r||i[l].listener===r){o=i[l].listener,s=l;break}if(s<0)return this;s===0?i.shift():th(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,o||r)}return this},Ae.prototype.off=Ae.prototype.removeListener,Ae.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),l;for(n=0;n<s.length;++n)l=s[n],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function Ns(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?rh(n):Rs(n,n.length)}Ae.prototype.listeners=function(e){return Ns(this,e,!0)},Ae.prototype.rawListeners=function(e){return Ns(this,e,!1)},Ae.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Us.call(t,e)},Ae.prototype.listenerCount=Us;function Us(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ae.prototype.eventNames=function(){return this._eventsCount>0?di(this._events):[]};function Rs(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function th(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function rh(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function ih(t,e){return new Promise(function(r,i){function n(l){t.removeListener(e,s),i(l)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}Ps(t,e,s,{once:!0}),e!=="error"&&nh(t,n,{once:!0})})}function nh(t,e,r){typeof t.on=="function"&&Ps(t,"error",e,r)}function Ps(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var gi={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ki=function(t,e){return ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},ki(t,e)};function sh(t,e){ki(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Wi=function(){return Wi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Wi.apply(this,arguments)};function oh(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function ah(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var o=t.length-1;o>=0;o--)(l=t[o])&&(s=(n<3?l(s):n>3?l(e,r,s):l(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function ch(t,e){return function(r,i){e(r,i,t)}}function uh(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function hh(t,e,r,i){function n(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function o(E){try{_(i.next(E))}catch(S){l(S)}}function d(E){try{_(i.throw(E))}catch(S){l(S)}}function _(E){E.done?s(E.value):n(E.value).then(o,d)}_((i=i.apply(t,e||[])).next())})}function lh(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(_){return function(E){return d([_,E])}}function d(_){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=_[0]&2?n.return:_[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,_[1])).done)return s;switch(n=0,s&&(_=[_[0]&2,s.value]),_[0]){case 0:case 1:s=_;break;case 4:return r.label++,{value:_[1],done:!1};case 5:r.label++,n=_[1],_=[0];continue;case 7:_=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(_[0]===6||_[0]===2)){r=0;continue}if(_[0]===3&&(!s||_[1]>s[0]&&_[1]<s[3])){r.label=_[1];break}if(_[0]===6&&r.label<s[1]){r.label=s[1],s=_;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(_);break}s[2]&&r.ops.pop(),r.trys.pop();continue}_=e.call(t,r)}catch(E){_=[6,E],n=0}finally{i=s=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}}function fh(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function dh(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Gi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],l;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(o){l={error:o}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(l)throw l.error}}return s}function ph(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Fs(arguments[e]));return t}function gh(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],l=0,o=s.length;l<o;l++,n++)i[n]=s[l];return i}function Cr(t){return this instanceof Cr?(this.v=t,this):new Cr(t)}function yh(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},l("next"),l("throw"),l("return"),n[Symbol.asyncIterator]=function(){return this},n;function l(N){i[N]&&(n[N]=function(I){return new Promise(function(O,$){s.push([N,I,O,$])>1||o(N,I)})})}function o(N,I){try{d(i[N](I))}catch(O){S(s[0][3],O)}}function d(N){N.value instanceof Cr?Promise.resolve(N.value.v).then(_,E):S(s[0][2],N)}function _(N){o("next",N)}function E(N){o("throw",N)}function S(N,I){N(I),s.shift(),s.length&&o(s[0][0],s[0][1])}}function wh(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(l){return(r=!r)?{value:Cr(t[n](l)),done:n==="return"}:s?s(l):l}:s}}function mh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Gi=="function"?Gi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(l){return new Promise(function(o,d){l=t[s](l),n(o,d,l.done,l.value)})}}function n(s,l,o,d){Promise.resolve(d).then(function(_){s({value:_,done:o})},l)}}function bh(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _h(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Eh(t){return t&&t.__esModule?t:{default:t}}function vh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Dh(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var xh=Object.freeze({__proto__:null,__extends:sh,get __assign(){return Wi},__rest:oh,__decorate:ah,__param:ch,__metadata:uh,__awaiter:hh,__generator:lh,__createBinding:fh,__exportStar:dh,__values:Gi,__read:Fs,__spread:ph,__spreadArrays:gh,__await:Cr,__asyncGenerator:yh,__asyncDelegator:wh,__asyncValues:mh,__makeTemplateObject:bh,__importStar:_h,__importDefault:Eh,__classPrivateFieldGet:vh,__classPrivateFieldSet:Dh}),Et=qi(xh),Tr={};Object.defineProperty(Tr,"__esModule",{value:!0});function Sh(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}Tr.safeJsonParse=Sh;function Ih(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}Tr.safeJsonStringify=Ih;var Nr={exports:{}},Ls;function Oh(){return Ls||(Ls=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ht<"u"&&ht.localStorage?Nr.exports=ht.localStorage:typeof window<"u"&&window.localStorage?Nr.exports=window.localStorage:Nr.exports=new e}()),Nr.exports}var Yi={},Ur={},Ms;function Ah(){if(Ms)return Ur;Ms=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.IKeyValueStorage=void 0;class t{}return Ur.IKeyValueStorage=t,Ur}var Rr={},Bs;function Ch(){if(Bs)return Rr;Bs=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.parseEntry=void 0;const t=Tr;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return Rr.parseEntry=e,Rr}var $s;function Th(){return $s||($s=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(Ah(),t),e.__exportStar(Ch(),t)}(Yi)),Yi}Object.defineProperty(gi,"__esModule",{value:!0}),gi.KeyValueStorage=void 0;const fr=Et,js=Tr,Nh=fr.__importDefault(Oh()),Uh=Th();class Hs{constructor(){this.localStorage=Nh.default}getKeys(){return fr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return fr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Uh.parseEntry)})}getItem(e){return fr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return js.safeJsonParse(r)})}setItem(e,r){return fr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,js.safeJsonStringify(r))})}removeItem(e){return fr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}gi.KeyValueStorage=Hs;var Rh=gi.default=Hs,Pr={},Fr={},ae={},Ji={},Lr={},zs;function Ph(){if(zs)return Lr;zs=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Lr.delay=t,Lr}var Qt={},Xi={},er={},qs;function Fh(){return qs||(qs=1,Object.defineProperty(er,"__esModule",{value:!0}),er.ONE_THOUSAND=er.ONE_HUNDRED=void 0,er.ONE_HUNDRED=100,er.ONE_THOUSAND=1e3),er}var Zi={},Ks;function Lh(){return Ks||(Ks=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Zi)),Zi}var Vs;function ks(){return Vs||(Vs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(Fh(),t),e.__exportStar(Lh(),t)}(Xi)),Xi}var Ws;function Mh(){if(Ws)return Qt;Ws=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.fromMiliseconds=Qt.toMiliseconds=void 0;const t=ks();function e(i){return i*t.ONE_THOUSAND}Qt.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return Qt.fromMiliseconds=r,Qt}var Gs;function Bh(){return Gs||(Gs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(Ph(),t),e.__exportStar(Mh(),t)}(Ji)),Ji}var dr={},Ys;function $h(){if(Ys)return dr;Ys=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return dr.Watch=t,dr.default=t,dr}var Qi={},Mr={},Js;function jh(){if(Js)return Mr;Js=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.IWatch=void 0;class t{}return Mr.IWatch=t,Mr}var Xs;function Hh(){return Xs||(Xs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Et.__exportStar(jh(),t)}(Qi)),Qi}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(Bh(),t),e.__exportStar($h(),t),e.__exportStar(Hh(),t),e.__exportStar(ks(),t)})(ae);var en={},Br={};class tr{}var zh=Object.freeze({__proto__:null,IEvents:tr}),qh=qi(zh),Zs;function Kh(){if(Zs)return Br;Zs=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.IHeartBeat=void 0;const t=qh;class e extends t.IEvents{constructor(i){super()}}return Br.IHeartBeat=e,Br}var Qs;function eo(){return Qs||(Qs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Et.__exportStar(Kh(),t)}(en)),en}var tn={},rr={},to;function Vh(){if(to)return rr;to=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.HEARTBEAT_EVENTS=rr.HEARTBEAT_INTERVAL=void 0;const t=ae;return rr.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,rr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},rr}var ro;function io(){return ro||(ro=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Et.__exportStar(Vh(),t)}(tn)),tn}var no;function kh(){if(no)return Fr;no=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.HeartBeat=void 0;const t=Et,e=ot.exports,r=ae,i=eo(),n=io();class s extends i.IHeartBeat{constructor(o){super(o),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=o?.interval||n.HEARTBEAT_INTERVAL}static init(o){return t.__awaiter(this,void 0,void 0,function*(){const d=new s(o);return yield d.init(),d})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}on(o,d){this.events.on(o,d)}once(o,d){this.events.once(o,d)}off(o,d){this.events.off(o,d)}removeListener(o,d){this.events.removeListener(o,d)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return Fr.HeartBeat=s,Fr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(kh(),t),e.__exportStar(eo(),t),e.__exportStar(io(),t)})(Pr);var Oe={},ir={},so;function oo(){return so||(so=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.PINO_CUSTOM_CONTEXT_KEY=ir.PINO_LOGGER_DEFAULTS=void 0,ir.PINO_LOGGER_DEFAULTS={level:"info"},ir.PINO_CUSTOM_CONTEXT_KEY="custom_context"),ir}var ct={},ao;function Wh(){if(ao)return ct;ao=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.generateChildLogger=ct.formatChildLoggerContext=ct.getLoggerContext=ct.setBrowserLoggerContext=ct.getBrowserLoggerContext=ct.getDefaultLoggerOptions=void 0;const t=oo();function e(o){return Object.assign(Object.assign({},o),{level:o?.level||t.PINO_LOGGER_DEFAULTS.level})}ct.getDefaultLoggerOptions=e;function r(o,d=t.PINO_CUSTOM_CONTEXT_KEY){return o[d]||""}ct.getBrowserLoggerContext=r;function i(o,d,_=t.PINO_CUSTOM_CONTEXT_KEY){return o[_]=d,o}ct.setBrowserLoggerContext=i;function n(o,d=t.PINO_CUSTOM_CONTEXT_KEY){let _="";return typeof o.bindings>"u"?_=r(o,d):_=o.bindings().context||"",_}ct.getLoggerContext=n;function s(o,d,_=t.PINO_CUSTOM_CONTEXT_KEY){const E=n(o,_);return E.trim()?`${E}/${d}`:d}ct.formatChildLoggerContext=s;function l(o,d,_=t.PINO_CUSTOM_CONTEXT_KEY){const E=s(o,d,_),S=o.child({context:E});return i(S,E,_)}return ct.generateChildLogger=l,ct}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Et,r=e.__importDefault(Ir);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(oo(),t),e.__exportStar(Wh(),t)})(Oe);class Gh extends tr{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Yh extends tr{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Jh{constructor(e,r){this.logger=e,this.core=r}}class Xh extends tr{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Zh extends tr{constructor(e){super()}}class Qh{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class el extends tr{constructor(e,r){super(),this.relayer=e,this.logger=r}}class tl extends tr{constructor(e,r){super(),this.core=e,this.logger=r}}function rn(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function $r(t){return typeof t=="string"?t:JSON.stringify(t)}var nn={},pr={},yi={},wi={};Object.defineProperty(wi,"__esModule",{value:!0}),wi.BrowserRandomSource=void 0;const co=65536;class rl{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=co)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,co)));return r}}wi.BrowserRandomSource=rl;function il(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var mi={},yt={};Object.defineProperty(yt,"__esModule",{value:!0});function nl(t){for(var e=0;e<t.length;e++)t[e]=0;return t}yt.wipe=nl;var sl={},ol=Object.freeze({__proto__:null,default:sl}),al=qi(ol);Object.defineProperty(mi,"__esModule",{value:!0}),mi.NodeRandomSource=void 0;const cl=yt;class ul{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof il<"u"){const e=al;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,cl.wipe)(r),i}}mi.NodeRandomSource=ul,Object.defineProperty(yi,"__esModule",{value:!0}),yi.SystemRandomSource=void 0;const hl=wi,ll=mi;class fl{constructor(){if(this.isAvailable=!1,this.name="",this._source=new hl.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new ll.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}yi.SystemRandomSource=fl;var pe={},uo={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(o,d){var _=o>>>16&65535,E=o&65535,S=d>>>16&65535,N=d&65535;return E*N+(_*N+E*S<<16>>>0)|0}t.mul=Math.imul||e;function r(o,d){return o+d|0}t.add=r;function i(o,d){return o-d|0}t.sub=i;function n(o,d){return o<<d|o>>>32-d}t.rotl=n;function s(o,d){return o<<32-d|o>>>d}t.rotr=s;function l(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o}t.isInteger=Number.isInteger||l,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(o){return t.isInteger(o)&&o>=-t.MAX_SAFE_INTEGER&&o<=t.MAX_SAFE_INTEGER}})(uo),Object.defineProperty(pe,"__esModule",{value:!0});var ho=uo;function dl(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}pe.readInt16BE=dl;function pl(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}pe.readUint16BE=pl;function gl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}pe.readInt16LE=gl;function yl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}pe.readUint16LE=yl;function lo(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}pe.writeUint16BE=lo,pe.writeInt16BE=lo;function fo(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}pe.writeUint16LE=fo,pe.writeInt16LE=fo;function sn(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}pe.readInt32BE=sn;function on(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}pe.readUint32BE=on;function an(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}pe.readInt32LE=an;function cn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}pe.readUint32LE=cn;function bi(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}pe.writeUint32BE=bi,pe.writeInt32BE=bi;function _i(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}pe.writeUint32LE=_i,pe.writeInt32LE=_i;function wl(t,e){e===void 0&&(e=0);var r=sn(t,e),i=sn(t,e+4);return r*4294967296+i-(i>>31)*4294967296}pe.readInt64BE=wl;function ml(t,e){e===void 0&&(e=0);var r=on(t,e),i=on(t,e+4);return r*4294967296+i}pe.readUint64BE=ml;function bl(t,e){e===void 0&&(e=0);var r=an(t,e),i=an(t,e+4);return i*4294967296+r-(r>>31)*4294967296}pe.readInt64LE=bl;function _l(t,e){e===void 0&&(e=0);var r=cn(t,e),i=cn(t,e+4);return i*4294967296+r}pe.readUint64LE=_l;function po(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),bi(t/4294967296>>>0,e,r),bi(t>>>0,e,r+4),e}pe.writeUint64BE=po,pe.writeInt64BE=po;function go(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),_i(t>>>0,e,r),_i(t/4294967296>>>0,e,r+4),e}pe.writeUint64LE=go,pe.writeInt64LE=go;function El(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}pe.readUintBE=El;function vl(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}pe.readUintLE=vl;function Dl(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ho.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}pe.writeUintBE=Dl;function xl(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ho.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}pe.writeUintLE=xl;function Sl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}pe.readFloat32BE=Sl;function Il(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}pe.readFloat32LE=Il;function Ol(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}pe.readFloat64BE=Ol;function Al(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}pe.readFloat64LE=Al;function Cl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}pe.writeFloat32BE=Cl;function Tl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}pe.writeFloat32LE=Tl;function Nl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}pe.writeFloat64BE=Nl;function Ul(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}pe.writeFloat64LE=Ul,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=yi,r=pe,i=yt;t.defaultRandomSource=new e.SystemRandomSource;function n(_,E=t.defaultRandomSource){return E.randomBytes(_)}t.randomBytes=n;function s(_=t.defaultRandomSource){const E=n(4,_),S=(0,r.readUint32LE)(E);return(0,i.wipe)(E),S}t.randomUint32=s;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function o(_,E=l,S=t.defaultRandomSource){if(E.length<2)throw new Error("randomString charset is too short");if(E.length>256)throw new Error("randomString charset is too long");let N="";const I=E.length,O=256-256%I;for(;_>0;){const $=n(Math.ceil(_*256/O),S);for(let F=0;F<$.length&&_>0;F++){const H=$[F];H<O&&(N+=E.charAt(H%I),_--)}(0,i.wipe)($)}return N}t.randomString=o;function d(_,E=l,S=t.defaultRandomSource){const N=Math.ceil(_/(Math.log(E.length)/Math.LN2));return o(N,E,S)}t.randomStringForEntropy=d}(pr);var yo={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=pe,r=yt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function o(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return o.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},o.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},o.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},o.prototype.update=function(d,_){if(_===void 0&&(_=d.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=_,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&_>0;)this._buffer[this._bufferLength++]=d[E++],_--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(_>=this.blockSize&&(E=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,d,E,_),_%=this.blockSize);_>0;)this._buffer[this._bufferLength++]=d[E++],_--;return this},o.prototype.finish=function(d){if(!this._finished){var _=this._bytesHashed,E=this._bufferLength,S=_/536870912|0,N=_<<3,I=_%128<112?128:256;this._buffer[E]=128;for(var O=E+1;O<I-8;O++)this._buffer[O]=0;e.writeUint32BE(S,this._buffer,I-8),e.writeUint32BE(N,this._buffer,I-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,I),this._finished=!0}for(var O=0;O<this.digestLength/8;O++)e.writeUint32BE(this._stateHi[O],d,O*8),e.writeUint32BE(this._stateLo[O],d,O*8+4);return this},o.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},o.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},o.prototype.restoreState=function(d){return this._stateHi.set(d.stateHi),this._stateLo.set(d.stateLo),this._bufferLength=d.bufferLength,d.buffer&&this._buffer.set(d.buffer),this._bytesHashed=d.bytesHashed,this._finished=!1,this},o.prototype.cleanSavedState=function(d){r.wipe(d.stateHi),r.wipe(d.stateLo),d.buffer&&r.wipe(d.buffer),d.bufferLength=0,d.bytesHashed=0},o}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(o,d,_,E,S,N,I){for(var O=_[0],$=_[1],F=_[2],H=_[3],f=_[4],w=_[5],p=_[6],y=_[7],b=E[0],a=E[1],m=E[2],M=E[3],z=E[4],W=E[5],ee=E[6],re=E[7],D,A,k,V,K,q,J,G;I>=128;){for(var se=0;se<16;se++){var X=8*se+N;o[se]=e.readUint32BE(S,X),d[se]=e.readUint32BE(S,X+4)}for(var se=0;se<80;se++){var ce=O,ie=$,ge=F,B=H,L=f,U=w,h=p,C=y,Z=b,Q=a,fe=m,xe=M,_e=z,Se=W,Fe=ee,Re=re;if(D=y,A=re,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=(f>>>14|z<<32-14)^(f>>>18|z<<32-18)^(z>>>41-32|f<<32-(41-32)),A=(z>>>14|f<<32-14)^(z>>>18|f<<32-18)^(f>>>41-32|z<<32-(41-32)),K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,D=f&w^~f&p,A=z&W^~z&ee,K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,D=n[se*2],A=n[se*2+1],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,D=o[se%16],A=d[se%16],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,k=J&65535|G<<16,V=K&65535|q<<16,D=k,A=V,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=(O>>>28|b<<32-28)^(b>>>34-32|O<<32-(34-32))^(b>>>39-32|O<<32-(39-32)),A=(b>>>28|O<<32-28)^(O>>>34-32|b<<32-(34-32))^(O>>>39-32|b<<32-(39-32)),K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,D=O&$^O&F^$&F,A=b&a^b&m^a&m,K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,C=J&65535|G<<16,Re=K&65535|q<<16,D=B,A=xe,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=k,A=V,K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,B=J&65535|G<<16,xe=K&65535|q<<16,$=ce,F=ie,H=ge,f=B,w=L,p=U,y=h,O=C,a=Z,m=Q,M=fe,z=xe,W=_e,ee=Se,re=Fe,b=Re,se%16===15)for(var X=0;X<16;X++)D=o[X],A=d[X],K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=o[(X+9)%16],A=d[(X+9)%16],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,k=o[(X+1)%16],V=d[(X+1)%16],D=(k>>>1|V<<32-1)^(k>>>8|V<<32-8)^k>>>7,A=(V>>>1|k<<32-1)^(V>>>8|k<<32-8)^(V>>>7|k<<32-7),K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,k=o[(X+14)%16],V=d[(X+14)%16],D=(k>>>19|V<<32-19)^(V>>>61-32|k<<32-(61-32))^k>>>6,A=(V>>>19|k<<32-19)^(k>>>61-32|V<<32-(61-32))^(V>>>6|k<<32-6),K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,o[X]=J&65535|G<<16,d[X]=K&65535|q<<16}D=O,A=b,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=_[0],A=E[0],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,_[0]=O=J&65535|G<<16,E[0]=b=K&65535|q<<16,D=$,A=a,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=_[1],A=E[1],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,_[1]=$=J&65535|G<<16,E[1]=a=K&65535|q<<16,D=F,A=m,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=_[2],A=E[2],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,_[2]=F=J&65535|G<<16,E[2]=m=K&65535|q<<16,D=H,A=M,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=_[3],A=E[3],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,_[3]=H=J&65535|G<<16,E[3]=M=K&65535|q<<16,D=f,A=z,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=_[4],A=E[4],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,_[4]=f=J&65535|G<<16,E[4]=z=K&65535|q<<16,D=w,A=W,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=_[5],A=E[5],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,_[5]=w=J&65535|G<<16,E[5]=W=K&65535|q<<16,D=p,A=ee,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=_[6],A=E[6],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,_[6]=p=J&65535|G<<16,E[6]=ee=K&65535|q<<16,D=y,A=re,K=A&65535,q=A>>>16,J=D&65535,G=D>>>16,D=_[7],A=E[7],K+=A&65535,q+=A>>>16,J+=D&65535,G+=D>>>16,q+=K>>>16,J+=q>>>16,G+=J>>>16,_[7]=y=J&65535|G<<16,E[7]=re=K&65535|q<<16,N+=128,I-=128}return N}function l(o){var d=new i;d.update(o);var _=d.digest();return d.clean(),_}t.hash=l})(yo),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=pr,r=yo,i=yt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(B){const L=new Float64Array(16);if(B)for(let U=0;U<B.length;U++)L[U]=B[U];return L}const s=new Uint8Array(32);s[0]=9;const l=n(),o=n([1]),d=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),_=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),S=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),N=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function I(B,L){for(let U=0;U<16;U++)B[U]=L[U]|0}function O(B){let L=1;for(let U=0;U<16;U++){let h=B[U]+L+65535;L=Math.floor(h/65536),B[U]=h-L*65536}B[0]+=L-1+37*(L-1)}function $(B,L,U){const h=~(U-1);for(let C=0;C<16;C++){const Z=h&(B[C]^L[C]);B[C]^=Z,L[C]^=Z}}function F(B,L){const U=n(),h=n();for(let C=0;C<16;C++)h[C]=L[C];O(h),O(h),O(h);for(let C=0;C<2;C++){U[0]=h[0]-65517;for(let Q=1;Q<15;Q++)U[Q]=h[Q]-65535-(U[Q-1]>>16&1),U[Q-1]&=65535;U[15]=h[15]-32767-(U[14]>>16&1);const Z=U[15]>>16&1;U[14]&=65535,$(h,U,1-Z)}for(let C=0;C<16;C++)B[2*C]=h[C]&255,B[2*C+1]=h[C]>>8}function H(B,L){let U=0;for(let h=0;h<32;h++)U|=B[h]^L[h];return(1&U-1>>>8)-1}function f(B,L){const U=new Uint8Array(32),h=new Uint8Array(32);return F(U,B),F(h,L),H(U,h)}function w(B){const L=new Uint8Array(32);return F(L,B),L[0]&1}function p(B,L){for(let U=0;U<16;U++)B[U]=L[2*U]+(L[2*U+1]<<8);B[15]&=32767}function y(B,L,U){for(let h=0;h<16;h++)B[h]=L[h]+U[h]}function b(B,L,U){for(let h=0;h<16;h++)B[h]=L[h]-U[h]}function a(B,L,U){let h,C,Z=0,Q=0,fe=0,xe=0,_e=0,Se=0,Fe=0,Re=0,Ee=0,me=0,he=0,ye=0,be=0,ue=0,de=0,g=0,c=0,u=0,v=0,T=0,P=0,j=0,te=0,oe=0,ve=0,Ie=0,De=0,pt=0,Yt=0,Dr=0,ri=0,je=U[0],Me=U[1],He=U[2],ze=U[3],qe=U[4],Be=U[5],ke=U[6],We=U[7],Ge=U[8],Ye=U[9],Je=U[10],Ve=U[11],Ke=U[12],Pe=U[13],Xe=U[14],Ze=U[15];h=L[0],Z+=h*je,Q+=h*Me,fe+=h*He,xe+=h*ze,_e+=h*qe,Se+=h*Be,Fe+=h*ke,Re+=h*We,Ee+=h*Ge,me+=h*Ye,he+=h*Je,ye+=h*Ve,be+=h*Ke,ue+=h*Pe,de+=h*Xe,g+=h*Ze,h=L[1],Q+=h*je,fe+=h*Me,xe+=h*He,_e+=h*ze,Se+=h*qe,Fe+=h*Be,Re+=h*ke,Ee+=h*We,me+=h*Ge,he+=h*Ye,ye+=h*Je,be+=h*Ve,ue+=h*Ke,de+=h*Pe,g+=h*Xe,c+=h*Ze,h=L[2],fe+=h*je,xe+=h*Me,_e+=h*He,Se+=h*ze,Fe+=h*qe,Re+=h*Be,Ee+=h*ke,me+=h*We,he+=h*Ge,ye+=h*Ye,be+=h*Je,ue+=h*Ve,de+=h*Ke,g+=h*Pe,c+=h*Xe,u+=h*Ze,h=L[3],xe+=h*je,_e+=h*Me,Se+=h*He,Fe+=h*ze,Re+=h*qe,Ee+=h*Be,me+=h*ke,he+=h*We,ye+=h*Ge,be+=h*Ye,ue+=h*Je,de+=h*Ve,g+=h*Ke,c+=h*Pe,u+=h*Xe,v+=h*Ze,h=L[4],_e+=h*je,Se+=h*Me,Fe+=h*He,Re+=h*ze,Ee+=h*qe,me+=h*Be,he+=h*ke,ye+=h*We,be+=h*Ge,ue+=h*Ye,de+=h*Je,g+=h*Ve,c+=h*Ke,u+=h*Pe,v+=h*Xe,T+=h*Ze,h=L[5],Se+=h*je,Fe+=h*Me,Re+=h*He,Ee+=h*ze,me+=h*qe,he+=h*Be,ye+=h*ke,be+=h*We,ue+=h*Ge,de+=h*Ye,g+=h*Je,c+=h*Ve,u+=h*Ke,v+=h*Pe,T+=h*Xe,P+=h*Ze,h=L[6],Fe+=h*je,Re+=h*Me,Ee+=h*He,me+=h*ze,he+=h*qe,ye+=h*Be,be+=h*ke,ue+=h*We,de+=h*Ge,g+=h*Ye,c+=h*Je,u+=h*Ve,v+=h*Ke,T+=h*Pe,P+=h*Xe,j+=h*Ze,h=L[7],Re+=h*je,Ee+=h*Me,me+=h*He,he+=h*ze,ye+=h*qe,be+=h*Be,ue+=h*ke,de+=h*We,g+=h*Ge,c+=h*Ye,u+=h*Je,v+=h*Ve,T+=h*Ke,P+=h*Pe,j+=h*Xe,te+=h*Ze,h=L[8],Ee+=h*je,me+=h*Me,he+=h*He,ye+=h*ze,be+=h*qe,ue+=h*Be,de+=h*ke,g+=h*We,c+=h*Ge,u+=h*Ye,v+=h*Je,T+=h*Ve,P+=h*Ke,j+=h*Pe,te+=h*Xe,oe+=h*Ze,h=L[9],me+=h*je,he+=h*Me,ye+=h*He,be+=h*ze,ue+=h*qe,de+=h*Be,g+=h*ke,c+=h*We,u+=h*Ge,v+=h*Ye,T+=h*Je,P+=h*Ve,j+=h*Ke,te+=h*Pe,oe+=h*Xe,ve+=h*Ze,h=L[10],he+=h*je,ye+=h*Me,be+=h*He,ue+=h*ze,de+=h*qe,g+=h*Be,c+=h*ke,u+=h*We,v+=h*Ge,T+=h*Ye,P+=h*Je,j+=h*Ve,te+=h*Ke,oe+=h*Pe,ve+=h*Xe,Ie+=h*Ze,h=L[11],ye+=h*je,be+=h*Me,ue+=h*He,de+=h*ze,g+=h*qe,c+=h*Be,u+=h*ke,v+=h*We,T+=h*Ge,P+=h*Ye,j+=h*Je,te+=h*Ve,oe+=h*Ke,ve+=h*Pe,Ie+=h*Xe,De+=h*Ze,h=L[12],be+=h*je,ue+=h*Me,de+=h*He,g+=h*ze,c+=h*qe,u+=h*Be,v+=h*ke,T+=h*We,P+=h*Ge,j+=h*Ye,te+=h*Je,oe+=h*Ve,ve+=h*Ke,Ie+=h*Pe,De+=h*Xe,pt+=h*Ze,h=L[13],ue+=h*je,de+=h*Me,g+=h*He,c+=h*ze,u+=h*qe,v+=h*Be,T+=h*ke,P+=h*We,j+=h*Ge,te+=h*Ye,oe+=h*Je,ve+=h*Ve,Ie+=h*Ke,De+=h*Pe,pt+=h*Xe,Yt+=h*Ze,h=L[14],de+=h*je,g+=h*Me,c+=h*He,u+=h*ze,v+=h*qe,T+=h*Be,P+=h*ke,j+=h*We,te+=h*Ge,oe+=h*Ye,ve+=h*Je,Ie+=h*Ve,De+=h*Ke,pt+=h*Pe,Yt+=h*Xe,Dr+=h*Ze,h=L[15],g+=h*je,c+=h*Me,u+=h*He,v+=h*ze,T+=h*qe,P+=h*Be,j+=h*ke,te+=h*We,oe+=h*Ge,ve+=h*Ye,Ie+=h*Je,De+=h*Ve,pt+=h*Ke,Yt+=h*Pe,Dr+=h*Xe,ri+=h*Ze,Z+=38*c,Q+=38*u,fe+=38*v,xe+=38*T,_e+=38*P,Se+=38*j,Fe+=38*te,Re+=38*oe,Ee+=38*ve,me+=38*Ie,he+=38*De,ye+=38*pt,be+=38*Yt,ue+=38*Dr,de+=38*ri,C=1,h=Z+C+65535,C=Math.floor(h/65536),Z=h-C*65536,h=Q+C+65535,C=Math.floor(h/65536),Q=h-C*65536,h=fe+C+65535,C=Math.floor(h/65536),fe=h-C*65536,h=xe+C+65535,C=Math.floor(h/65536),xe=h-C*65536,h=_e+C+65535,C=Math.floor(h/65536),_e=h-C*65536,h=Se+C+65535,C=Math.floor(h/65536),Se=h-C*65536,h=Fe+C+65535,C=Math.floor(h/65536),Fe=h-C*65536,h=Re+C+65535,C=Math.floor(h/65536),Re=h-C*65536,h=Ee+C+65535,C=Math.floor(h/65536),Ee=h-C*65536,h=me+C+65535,C=Math.floor(h/65536),me=h-C*65536,h=he+C+65535,C=Math.floor(h/65536),he=h-C*65536,h=ye+C+65535,C=Math.floor(h/65536),ye=h-C*65536,h=be+C+65535,C=Math.floor(h/65536),be=h-C*65536,h=ue+C+65535,C=Math.floor(h/65536),ue=h-C*65536,h=de+C+65535,C=Math.floor(h/65536),de=h-C*65536,h=g+C+65535,C=Math.floor(h/65536),g=h-C*65536,Z+=C-1+37*(C-1),C=1,h=Z+C+65535,C=Math.floor(h/65536),Z=h-C*65536,h=Q+C+65535,C=Math.floor(h/65536),Q=h-C*65536,h=fe+C+65535,C=Math.floor(h/65536),fe=h-C*65536,h=xe+C+65535,C=Math.floor(h/65536),xe=h-C*65536,h=_e+C+65535,C=Math.floor(h/65536),_e=h-C*65536,h=Se+C+65535,C=Math.floor(h/65536),Se=h-C*65536,h=Fe+C+65535,C=Math.floor(h/65536),Fe=h-C*65536,h=Re+C+65535,C=Math.floor(h/65536),Re=h-C*65536,h=Ee+C+65535,C=Math.floor(h/65536),Ee=h-C*65536,h=me+C+65535,C=Math.floor(h/65536),me=h-C*65536,h=he+C+65535,C=Math.floor(h/65536),he=h-C*65536,h=ye+C+65535,C=Math.floor(h/65536),ye=h-C*65536,h=be+C+65535,C=Math.floor(h/65536),be=h-C*65536,h=ue+C+65535,C=Math.floor(h/65536),ue=h-C*65536,h=de+C+65535,C=Math.floor(h/65536),de=h-C*65536,h=g+C+65535,C=Math.floor(h/65536),g=h-C*65536,Z+=C-1+37*(C-1),B[0]=Z,B[1]=Q,B[2]=fe,B[3]=xe,B[4]=_e,B[5]=Se,B[6]=Fe,B[7]=Re,B[8]=Ee,B[9]=me,B[10]=he,B[11]=ye,B[12]=be,B[13]=ue,B[14]=de,B[15]=g}function m(B,L){a(B,L,L)}function M(B,L){const U=n();let h;for(h=0;h<16;h++)U[h]=L[h];for(h=253;h>=0;h--)m(U,U),h!==2&&h!==4&&a(U,U,L);for(h=0;h<16;h++)B[h]=U[h]}function z(B,L){const U=n();let h;for(h=0;h<16;h++)U[h]=L[h];for(h=250;h>=0;h--)m(U,U),h!==1&&a(U,U,L);for(h=0;h<16;h++)B[h]=U[h]}function W(B,L){const U=n(),h=n(),C=n(),Z=n(),Q=n(),fe=n(),xe=n(),_e=n(),Se=n();b(U,B[1],B[0]),b(Se,L[1],L[0]),a(U,U,Se),y(h,B[0],B[1]),y(Se,L[0],L[1]),a(h,h,Se),a(C,B[3],L[3]),a(C,C,_),a(Z,B[2],L[2]),y(Z,Z,Z),b(Q,h,U),b(fe,Z,C),y(xe,Z,C),y(_e,h,U),a(B[0],Q,fe),a(B[1],_e,xe),a(B[2],xe,fe),a(B[3],Q,_e)}function ee(B,L,U){for(let h=0;h<4;h++)$(B[h],L[h],U)}function re(B,L){const U=n(),h=n(),C=n();M(C,L[2]),a(U,L[0],C),a(h,L[1],C),F(B,h),B[31]^=w(U)<<7}function D(B,L,U){I(B[0],l),I(B[1],o),I(B[2],o),I(B[3],l);for(let h=255;h>=0;--h){const C=U[h/8|0]>>(h&7)&1;ee(B,L,C),W(L,B),W(B,B),ee(B,L,C)}}function A(B,L){const U=[n(),n(),n(),n()];I(U[0],E),I(U[1],S),I(U[2],o),a(U[3],E,S),D(B,U,L)}function k(B){if(B.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const L=(0,r.hash)(B);L[0]&=248,L[31]&=127,L[31]|=64;const U=new Uint8Array(32),h=[n(),n(),n(),n()];A(h,L),re(U,h);const C=new Uint8Array(64);return C.set(B),C.set(U,32),{publicKey:U,secretKey:C}}t.generateKeyPairFromSeed=k;function V(B){const L=(0,e.randomBytes)(32,B),U=k(L);return(0,i.wipe)(L),U}t.generateKeyPair=V;function K(B){if(B.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(B.subarray(32))}t.extractPublicKeyFromSecretKey=K;const q=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(B,L){let U,h,C,Z;for(h=63;h>=32;--h){for(U=0,C=h-32,Z=h-12;C<Z;++C)L[C]+=U-16*L[h]*q[C-(h-32)],U=Math.floor((L[C]+128)/256),L[C]-=U*256;L[C]+=U,L[h]=0}for(U=0,C=0;C<32;C++)L[C]+=U-(L[31]>>4)*q[C],U=L[C]>>8,L[C]&=255;for(C=0;C<32;C++)L[C]-=U*q[C];for(h=0;h<32;h++)L[h+1]+=L[h]>>8,B[h]=L[h]&255}function G(B){const L=new Float64Array(64);for(let U=0;U<64;U++)L[U]=B[U];for(let U=0;U<64;U++)B[U]=0;J(B,L)}function se(B,L){const U=new Float64Array(64),h=[n(),n(),n(),n()],C=(0,r.hash)(B.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;const Z=new Uint8Array(64);Z.set(C.subarray(32),32);const Q=new r.SHA512;Q.update(Z.subarray(32)),Q.update(L);const fe=Q.digest();Q.clean(),G(fe),A(h,fe),re(Z,h),Q.reset(),Q.update(Z.subarray(0,32)),Q.update(B.subarray(32)),Q.update(L);const xe=Q.digest();G(xe);for(let _e=0;_e<32;_e++)U[_e]=fe[_e];for(let _e=0;_e<32;_e++)for(let Se=0;Se<32;Se++)U[_e+Se]+=xe[_e]*C[Se];return J(Z.subarray(32),U),Z}t.sign=se;function X(B,L){const U=n(),h=n(),C=n(),Z=n(),Q=n(),fe=n(),xe=n();return I(B[2],o),p(B[1],L),m(C,B[1]),a(Z,C,d),b(C,C,B[2]),y(Z,B[2],Z),m(Q,Z),m(fe,Q),a(xe,fe,Q),a(U,xe,C),a(U,U,Z),z(U,U),a(U,U,C),a(U,U,Z),a(U,U,Z),a(B[0],U,Z),m(h,B[0]),a(h,h,Z),f(h,C)&&a(B[0],B[0],N),m(h,B[0]),a(h,h,Z),f(h,C)?-1:(w(B[0])===L[31]>>7&&b(B[0],l,B[0]),a(B[3],B[0],B[1]),0)}function ce(B,L,U){const h=new Uint8Array(32),C=[n(),n(),n(),n()],Z=[n(),n(),n(),n()];if(U.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(X(Z,B))return!1;const Q=new r.SHA512;Q.update(U.subarray(0,32)),Q.update(B),Q.update(L);const fe=Q.digest();return G(fe),D(C,Z,fe),A(Z,U.subarray(32)),W(C,Z),re(h,C),!H(U,h)}t.verify=ce;function ie(B){let L=[n(),n(),n(),n()];if(X(L,B))throw new Error("Ed25519: invalid public key");let U=n(),h=n(),C=L[1];y(U,o,C),b(h,o,C),M(h,h),a(U,U,h);let Z=new Uint8Array(32);return F(Z,U),Z}t.convertPublicKeyToX25519=ie;function ge(B){const L=(0,r.hash)(B.subarray(0,32));L[0]&=248,L[31]&=127,L[31]|=64;const U=new Uint8Array(L.subarray(0,32));return(0,i.wipe)(L),U}t.convertSecretKeyToX25519=ge}(nn);const Rl="EdDSA",Pl="JWT",wo=".",mo="base64url",Fl="utf8",Ll="utf8",Ml=":",Bl="did",$l="key",bo="base58btc",jl="z",Hl="K36",zl=32;function un(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function _o(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?un(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function ql(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=_o(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return un(r)}function Kl(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),l=s.charCodeAt(0);if(r[l]!==255)throw new TypeError(s+" is ambiguous");r[l]=n}var o=t.length,d=t.charAt(0),_=Math.log(o)/Math.log(256),E=Math.log(256)/Math.log(o);function S(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var $=0,F=0,H=0,f=O.length;H!==f&&O[H]===0;)H++,$++;for(var w=(f-H)*E+1>>>0,p=new Uint8Array(w);H!==f;){for(var y=O[H],b=0,a=w-1;(y!==0||b<F)&&a!==-1;a--,b++)y+=256*p[a]>>>0,p[a]=y%o>>>0,y=y/o>>>0;if(y!==0)throw new Error("Non-zero carry");F=b,H++}for(var m=w-F;m!==w&&p[m]===0;)m++;for(var M=d.repeat($);m<w;++m)M+=t.charAt(p[m]);return M}function N(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var $=0;if(O[$]!==" "){for(var F=0,H=0;O[$]===d;)F++,$++;for(var f=(O.length-$)*_+1>>>0,w=new Uint8Array(f);O[$];){var p=r[O.charCodeAt($)];if(p===255)return;for(var y=0,b=f-1;(p!==0||y<H)&&b!==-1;b--,y++)p+=o*w[b]>>>0,w[b]=p%256>>>0,p=p/256>>>0;if(p!==0)throw new Error("Non-zero carry");H=y,$++}if(O[$]!==" "){for(var a=f-H;a!==f&&w[a]===0;)a++;for(var m=new Uint8Array(F+(f-a)),M=F;a!==f;)m[M++]=w[a++];return m}}}function I(O){var $=N(O);if($)return $;throw new Error(`Non-${e} character`)}return{encode:S,decodeUnsafe:N,decode:I}}var Vl=Kl,kl=Vl;const Eo=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Wl=t=>new TextEncoder().encode(t),Gl=t=>new TextDecoder().decode(t);class Yl{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Jl{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return vo(this,e)}}class Xl{constructor(e){this.decoders=e}or(e){return vo(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const vo=(t,e)=>new Xl({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Zl{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Yl(e,r,i),this.decoder=new Jl(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ei=({name:t,prefix:e,encode:r,decode:i})=>new Zl(t,e,r,i),jr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=kl(r,e);return Ei({prefix:t,name:e,encode:i,decode:s=>Eo(n(s))})},Ql=(t,e,r,i)=>{const n={};for(let E=0;E<e.length;++E)n[e[E]]=E;let s=t.length;for(;t[s-1]==="=";)--s;const l=new Uint8Array(s*r/8|0);let o=0,d=0,_=0;for(let E=0;E<s;++E){const S=n[t[E]];if(S===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<r|S,o+=r,o>=8&&(o-=8,l[_++]=255&d>>o)}if(o>=r||255&d<<8-o)throw new SyntaxError("Unexpected end of data");return l},ef=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",l=0,o=0;for(let d=0;d<t.length;++d)for(o=o<<8|t[d],l+=8;l>r;)l-=r,s+=e[n&o>>l];if(l&&(s+=e[n&o<<r-l]),i)for(;s.length*r&7;)s+="=";return s},it=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Ei({prefix:e,name:t,encode(n){return ef(n,i,r)},decode(n){return Ql(n,i,r,t)}}),tf=Ei({prefix:"\0",name:"identity",encode:t=>Gl(t),decode:t=>Wl(t)});var rf=Object.freeze({__proto__:null,identity:tf});const nf=it({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var sf=Object.freeze({__proto__:null,base2:nf});const of=it({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var af=Object.freeze({__proto__:null,base8:of});const cf=jr({prefix:"9",name:"base10",alphabet:"0123456789"});var uf=Object.freeze({__proto__:null,base10:cf});const hf=it({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),lf=it({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ff=Object.freeze({__proto__:null,base16:hf,base16upper:lf});const df=it({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),pf=it({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),gf=it({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),yf=it({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),wf=it({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mf=it({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),bf=it({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_f=it({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ef=it({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var vf=Object.freeze({__proto__:null,base32:df,base32upper:pf,base32pad:gf,base32padupper:yf,base32hex:wf,base32hexupper:mf,base32hexpad:bf,base32hexpadupper:_f,base32z:Ef});const Df=jr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),xf=jr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Sf=Object.freeze({__proto__:null,base36:Df,base36upper:xf});const If=jr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Of=jr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Af=Object.freeze({__proto__:null,base58btc:If,base58flickr:Of});const Cf=it({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Tf=it({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Nf=it({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Uf=it({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Rf=Object.freeze({__proto__:null,base64:Cf,base64pad:Tf,base64url:Nf,base64urlpad:Uf});const Do=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Pf=Do.reduce((t,e,r)=>(t[r]=e,t),[]),Ff=Do.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Lf(t){return t.reduce((e,r)=>(e+=Pf[r],e),"")}function Mf(t){const e=[];for(const r of t){const i=Ff[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Bf=Ei({prefix:"\u{1F680}",name:"base256emoji",encode:Lf,decode:Mf});var $f=Object.freeze({__proto__:null,base256emoji:Bf}),jf=So,xo=128,Hf=127,zf=~Hf,qf=Math.pow(2,31);function So(t,e,r){e=e||[],r=r||0;for(var i=r;t>=qf;)e[r++]=t&255|xo,t/=128;for(;t&zf;)e[r++]=t&255|xo,t>>>=7;return e[r]=t|0,So.bytes=r-i+1,e}var Kf=hn,Vf=128,Io=127;function hn(t,i){var r=0,i=i||0,n=0,s=i,l,o=t.length;do{if(s>=o)throw hn.bytes=0,new RangeError("Could not decode varint");l=t[s++],r+=n<28?(l&Io)<<n:(l&Io)*Math.pow(2,n),n+=7}while(l>=Vf);return hn.bytes=s-i,r}var kf=Math.pow(2,7),Wf=Math.pow(2,14),Gf=Math.pow(2,21),Yf=Math.pow(2,28),Jf=Math.pow(2,35),Xf=Math.pow(2,42),Zf=Math.pow(2,49),Qf=Math.pow(2,56),ed=Math.pow(2,63),td=function(t){return t<kf?1:t<Wf?2:t<Gf?3:t<Yf?4:t<Jf?5:t<Xf?6:t<Zf?7:t<Qf?8:t<ed?9:10},rd={encode:jf,decode:Kf,encodingLength:td},Oo=rd;const Ao=(t,e,r=0)=>(Oo.encode(t,e,r),e),Co=t=>Oo.encodingLength(t),ln=(t,e)=>{const r=e.byteLength,i=Co(t),n=i+Co(r),s=new Uint8Array(n+r);return Ao(t,s,0),Ao(r,s,i),s.set(e,n),new id(t,r,e,s)};class id{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const To=({name:t,code:e,encode:r})=>new nd(t,e,r);class nd{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ln(this.code,r):r.then(i=>ln(this.code,i))}else throw Error("Unknown type, must be binary type")}}const No=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),sd=To({name:"sha2-256",code:18,encode:No("SHA-256")}),od=To({name:"sha2-512",code:19,encode:No("SHA-512")});var ad=Object.freeze({__proto__:null,sha256:sd,sha512:od});const Uo=0,cd="identity",Ro=Eo,ud=t=>ln(Uo,Ro(t)),hd={code:Uo,name:cd,encode:Ro,digest:ud};var ld=Object.freeze({__proto__:null,identity:hd});new TextEncoder,new TextDecoder;const vi={...rf,...sf,...af,...uf,...ff,...vf,...Sf,...Af,...Rf,...$f};({...ad,...ld});function Po(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Fo=Po("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),fn=Po("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=_o(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Lo={utf8:Fo,"utf-8":Fo,hex:vi.base16,latin1:fn,ascii:fn,binary:fn,...vi};function dn(t,e="utf8"){const r=Lo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function pn(t,e="utf8"){const r=Lo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?un(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Di(t){return dn(pn($r(t),Fl),mo)}function Mo(t){const e=pn(Hl,bo),r=jl+dn(ql([e,t]),bo);return[Bl,$l,r].join(Ml)}function fd(t){return dn(t,mo)}function dd(t){return pn([Di(t.header),Di(t.payload)].join(wo),Ll)}function pd(t){return[Di(t.header),Di(t.payload),fd(t.signature)].join(wo)}function Bo(t=pr.randomBytes(zl)){return nn.generateKeyPairFromSeed(t)}async function gd(t,e,r,i,n=ae.fromMiliseconds(Date.now())){const s={alg:Rl,typ:Pl},l=Mo(i.publicKey),o=n+r,d={iss:l,sub:t,aud:e,iat:n,exp:o},_=dd({header:s,payload:d}),E=nn.sign(i.secretKey,_);return pd({header:s,payload:d,signature:E})}var gn={},xi={};Object.defineProperty(xi,"__esModule",{value:!0});var at=pe,yn=yt,yd=20;function wd(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,l=1797285236,o=r[3]<<24|r[2]<<16|r[1]<<8|r[0],d=r[7]<<24|r[6]<<16|r[5]<<8|r[4],_=r[11]<<24|r[10]<<16|r[9]<<8|r[8],E=r[15]<<24|r[14]<<16|r[13]<<8|r[12],S=r[19]<<24|r[18]<<16|r[17]<<8|r[16],N=r[23]<<24|r[22]<<16|r[21]<<8|r[20],I=r[27]<<24|r[26]<<16|r[25]<<8|r[24],O=r[31]<<24|r[30]<<16|r[29]<<8|r[28],$=e[3]<<24|e[2]<<16|e[1]<<8|e[0],F=e[7]<<24|e[6]<<16|e[5]<<8|e[4],H=e[11]<<24|e[10]<<16|e[9]<<8|e[8],f=e[15]<<24|e[14]<<16|e[13]<<8|e[12],w=i,p=n,y=s,b=l,a=o,m=d,M=_,z=E,W=S,ee=N,re=I,D=O,A=$,k=F,V=H,K=f,q=0;q<yd;q+=2)w=w+a|0,A^=w,A=A>>>32-16|A<<16,W=W+A|0,a^=W,a=a>>>32-12|a<<12,p=p+m|0,k^=p,k=k>>>32-16|k<<16,ee=ee+k|0,m^=ee,m=m>>>32-12|m<<12,y=y+M|0,V^=y,V=V>>>32-16|V<<16,re=re+V|0,M^=re,M=M>>>32-12|M<<12,b=b+z|0,K^=b,K=K>>>32-16|K<<16,D=D+K|0,z^=D,z=z>>>32-12|z<<12,y=y+M|0,V^=y,V=V>>>32-8|V<<8,re=re+V|0,M^=re,M=M>>>32-7|M<<7,b=b+z|0,K^=b,K=K>>>32-8|K<<8,D=D+K|0,z^=D,z=z>>>32-7|z<<7,p=p+m|0,k^=p,k=k>>>32-8|k<<8,ee=ee+k|0,m^=ee,m=m>>>32-7|m<<7,w=w+a|0,A^=w,A=A>>>32-8|A<<8,W=W+A|0,a^=W,a=a>>>32-7|a<<7,w=w+m|0,K^=w,K=K>>>32-16|K<<16,re=re+K|0,m^=re,m=m>>>32-12|m<<12,p=p+M|0,A^=p,A=A>>>32-16|A<<16,D=D+A|0,M^=D,M=M>>>32-12|M<<12,y=y+z|0,k^=y,k=k>>>32-16|k<<16,W=W+k|0,z^=W,z=z>>>32-12|z<<12,b=b+a|0,V^=b,V=V>>>32-16|V<<16,ee=ee+V|0,a^=ee,a=a>>>32-12|a<<12,y=y+z|0,k^=y,k=k>>>32-8|k<<8,W=W+k|0,z^=W,z=z>>>32-7|z<<7,b=b+a|0,V^=b,V=V>>>32-8|V<<8,ee=ee+V|0,a^=ee,a=a>>>32-7|a<<7,p=p+M|0,A^=p,A=A>>>32-8|A<<8,D=D+A|0,M^=D,M=M>>>32-7|M<<7,w=w+m|0,K^=w,K=K>>>32-8|K<<8,re=re+K|0,m^=re,m=m>>>32-7|m<<7;at.writeUint32LE(w+i|0,t,0),at.writeUint32LE(p+n|0,t,4),at.writeUint32LE(y+s|0,t,8),at.writeUint32LE(b+l|0,t,12),at.writeUint32LE(a+o|0,t,16),at.writeUint32LE(m+d|0,t,20),at.writeUint32LE(M+_|0,t,24),at.writeUint32LE(z+E|0,t,28),at.writeUint32LE(W+S|0,t,32),at.writeUint32LE(ee+N|0,t,36),at.writeUint32LE(re+I|0,t,40),at.writeUint32LE(D+O|0,t,44),at.writeUint32LE(A+$|0,t,48),at.writeUint32LE(k+F|0,t,52),at.writeUint32LE(V+H|0,t,56),at.writeUint32LE(K+f|0,t,60)}function $o(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,l;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),l=s.length-e.length,s.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,l=n}for(var o=new Uint8Array(64),d=0;d<r.length;d+=64){wd(o,s,t);for(var _=d;_<d+64&&_<r.length;_++)i[_]=r[_]^o[_-d];bd(s,0,l)}return yn.wipe(o),n===0&&yn.wipe(s),i}xi.streamXOR=$o;function md(t,e,r,i){return i===void 0&&(i=0),yn.wipe(r),$o(t,e,r,r,i)}xi.stream=md;function bd(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var jo={},Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});function _d(t,e,r){return~(t-1)&e|t-1&r}Vt.select=_d;function Ed(t,e){return(t|0)-(e|0)-1>>>31&1}Vt.lessOrEqual=Ed;function Ho(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}Vt.compare=Ho;function vd(t,e){return t.length===0||e.length===0?!1:Ho(t,e)!==0}Vt.equal=vd,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Vt,r=yt;t.DIGEST_LENGTH=16;var i=function(){function l(o){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var d=o[0]|o[1]<<8;this._r[0]=d&8191;var _=o[2]|o[3]<<8;this._r[1]=(d>>>13|_<<3)&8191;var E=o[4]|o[5]<<8;this._r[2]=(_>>>10|E<<6)&7939;var S=o[6]|o[7]<<8;this._r[3]=(E>>>7|S<<9)&8191;var N=o[8]|o[9]<<8;this._r[4]=(S>>>4|N<<12)&255,this._r[5]=N>>>1&8190;var I=o[10]|o[11]<<8;this._r[6]=(N>>>14|I<<2)&8191;var O=o[12]|o[13]<<8;this._r[7]=(I>>>11|O<<5)&8065;var $=o[14]|o[15]<<8;this._r[8]=(O>>>8|$<<8)&8191,this._r[9]=$>>>5&127,this._pad[0]=o[16]|o[17]<<8,this._pad[1]=o[18]|o[19]<<8,this._pad[2]=o[20]|o[21]<<8,this._pad[3]=o[22]|o[23]<<8,this._pad[4]=o[24]|o[25]<<8,this._pad[5]=o[26]|o[27]<<8,this._pad[6]=o[28]|o[29]<<8,this._pad[7]=o[30]|o[31]<<8}return l.prototype._blocks=function(o,d,_){for(var E=this._fin?0:2048,S=this._h[0],N=this._h[1],I=this._h[2],O=this._h[3],$=this._h[4],F=this._h[5],H=this._h[6],f=this._h[7],w=this._h[8],p=this._h[9],y=this._r[0],b=this._r[1],a=this._r[2],m=this._r[3],M=this._r[4],z=this._r[5],W=this._r[6],ee=this._r[7],re=this._r[8],D=this._r[9];_>=16;){var A=o[d+0]|o[d+1]<<8;S+=A&8191;var k=o[d+2]|o[d+3]<<8;N+=(A>>>13|k<<3)&8191;var V=o[d+4]|o[d+5]<<8;I+=(k>>>10|V<<6)&8191;var K=o[d+6]|o[d+7]<<8;O+=(V>>>7|K<<9)&8191;var q=o[d+8]|o[d+9]<<8;$+=(K>>>4|q<<12)&8191,F+=q>>>1&8191;var J=o[d+10]|o[d+11]<<8;H+=(q>>>14|J<<2)&8191;var G=o[d+12]|o[d+13]<<8;f+=(J>>>11|G<<5)&8191;var se=o[d+14]|o[d+15]<<8;w+=(G>>>8|se<<8)&8191,p+=se>>>5|E;var X=0,ce=X;ce+=S*y,ce+=N*(5*D),ce+=I*(5*re),ce+=O*(5*ee),ce+=$*(5*W),X=ce>>>13,ce&=8191,ce+=F*(5*z),ce+=H*(5*M),ce+=f*(5*m),ce+=w*(5*a),ce+=p*(5*b),X+=ce>>>13,ce&=8191;var ie=X;ie+=S*b,ie+=N*y,ie+=I*(5*D),ie+=O*(5*re),ie+=$*(5*ee),X=ie>>>13,ie&=8191,ie+=F*(5*W),ie+=H*(5*z),ie+=f*(5*M),ie+=w*(5*m),ie+=p*(5*a),X+=ie>>>13,ie&=8191;var ge=X;ge+=S*a,ge+=N*b,ge+=I*y,ge+=O*(5*D),ge+=$*(5*re),X=ge>>>13,ge&=8191,ge+=F*(5*ee),ge+=H*(5*W),ge+=f*(5*z),ge+=w*(5*M),ge+=p*(5*m),X+=ge>>>13,ge&=8191;var B=X;B+=S*m,B+=N*a,B+=I*b,B+=O*y,B+=$*(5*D),X=B>>>13,B&=8191,B+=F*(5*re),B+=H*(5*ee),B+=f*(5*W),B+=w*(5*z),B+=p*(5*M),X+=B>>>13,B&=8191;var L=X;L+=S*M,L+=N*m,L+=I*a,L+=O*b,L+=$*y,X=L>>>13,L&=8191,L+=F*(5*D),L+=H*(5*re),L+=f*(5*ee),L+=w*(5*W),L+=p*(5*z),X+=L>>>13,L&=8191;var U=X;U+=S*z,U+=N*M,U+=I*m,U+=O*a,U+=$*b,X=U>>>13,U&=8191,U+=F*y,U+=H*(5*D),U+=f*(5*re),U+=w*(5*ee),U+=p*(5*W),X+=U>>>13,U&=8191;var h=X;h+=S*W,h+=N*z,h+=I*M,h+=O*m,h+=$*a,X=h>>>13,h&=8191,h+=F*b,h+=H*y,h+=f*(5*D),h+=w*(5*re),h+=p*(5*ee),X+=h>>>13,h&=8191;var C=X;C+=S*ee,C+=N*W,C+=I*z,C+=O*M,C+=$*m,X=C>>>13,C&=8191,C+=F*a,C+=H*b,C+=f*y,C+=w*(5*D),C+=p*(5*re),X+=C>>>13,C&=8191;var Z=X;Z+=S*re,Z+=N*ee,Z+=I*W,Z+=O*z,Z+=$*M,X=Z>>>13,Z&=8191,Z+=F*m,Z+=H*a,Z+=f*b,Z+=w*y,Z+=p*(5*D),X+=Z>>>13,Z&=8191;var Q=X;Q+=S*D,Q+=N*re,Q+=I*ee,Q+=O*W,Q+=$*z,X=Q>>>13,Q&=8191,Q+=F*M,Q+=H*m,Q+=f*a,Q+=w*b,Q+=p*y,X+=Q>>>13,Q&=8191,X=(X<<2)+X|0,X=X+ce|0,ce=X&8191,X=X>>>13,ie+=X,S=ce,N=ie,I=ge,O=B,$=L,F=U,H=h,f=C,w=Z,p=Q,d+=16,_-=16}this._h[0]=S,this._h[1]=N,this._h[2]=I,this._h[3]=O,this._h[4]=$,this._h[5]=F,this._h[6]=H,this._h[7]=f,this._h[8]=w,this._h[9]=p},l.prototype.finish=function(o,d){d===void 0&&(d=0);var _=new Uint16Array(10),E,S,N,I;if(this._leftover){for(I=this._leftover,this._buffer[I++]=1;I<16;I++)this._buffer[I]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(E=this._h[1]>>>13,this._h[1]&=8191,I=2;I<10;I++)this._h[I]+=E,E=this._h[I]>>>13,this._h[I]&=8191;for(this._h[0]+=E*5,E=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=E,E=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=E,_[0]=this._h[0]+5,E=_[0]>>>13,_[0]&=8191,I=1;I<10;I++)_[I]=this._h[I]+E,E=_[I]>>>13,_[I]&=8191;for(_[9]-=1<<13,S=(E^1)-1,I=0;I<10;I++)_[I]&=S;for(S=~S,I=0;I<10;I++)this._h[I]=this._h[I]&S|_[I];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,N=this._h[0]+this._pad[0],this._h[0]=N&65535,I=1;I<8;I++)N=(this._h[I]+this._pad[I]|0)+(N>>>16)|0,this._h[I]=N&65535;return o[d+0]=this._h[0]>>>0,o[d+1]=this._h[0]>>>8,o[d+2]=this._h[1]>>>0,o[d+3]=this._h[1]>>>8,o[d+4]=this._h[2]>>>0,o[d+5]=this._h[2]>>>8,o[d+6]=this._h[3]>>>0,o[d+7]=this._h[3]>>>8,o[d+8]=this._h[4]>>>0,o[d+9]=this._h[4]>>>8,o[d+10]=this._h[5]>>>0,o[d+11]=this._h[5]>>>8,o[d+12]=this._h[6]>>>0,o[d+13]=this._h[6]>>>8,o[d+14]=this._h[7]>>>0,o[d+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(o){var d=0,_=o.length,E;if(this._leftover){E=16-this._leftover,E>_&&(E=_);for(var S=0;S<E;S++)this._buffer[this._leftover+S]=o[d+S];if(_-=E,d+=E,this._leftover+=E,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(_>=16&&(E=_-_%16,this._blocks(o,d,E),d+=E,_-=E),_){for(var S=0;S<_;S++)this._buffer[this._leftover+S]=o[d+S];this._leftover+=_}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var o=new Uint8Array(16);return this.finish(o),o},l.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();t.Poly1305=i;function n(l,o){var d=new i(l);d.update(o);var _=d.digest();return d.clean(),_}t.oneTimeAuth=n;function s(l,o){return l.length!==t.DIGEST_LENGTH||o.length!==t.DIGEST_LENGTH?!1:e.equal(l,o)}t.equal=s}(jo),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=xi,r=jo,i=yt,n=pe,s=Vt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var l=new Uint8Array(16),o=function(){function d(_){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,_.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(_)}return d.prototype.seal=function(_,E,S,N){if(_.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var I=new Uint8Array(16);I.set(_,I.length-_.length);var O=new Uint8Array(32);e.stream(this._key,I,O,4);var $=E.length+this.tagLength,F;if(N){if(N.length!==$)throw new Error("ChaCha20Poly1305: incorrect destination length");F=N}else F=new Uint8Array($);return e.streamXOR(this._key,I,E,F,4),this._authenticate(F.subarray(F.length-this.tagLength,F.length),O,F.subarray(0,F.length-this.tagLength),S),i.wipe(I),F},d.prototype.open=function(_,E,S,N){if(_.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(E.length<this.tagLength)return null;var I=new Uint8Array(16);I.set(_,I.length-_.length);var O=new Uint8Array(32);e.stream(this._key,I,O,4);var $=new Uint8Array(this.tagLength);if(this._authenticate($,O,E.subarray(0,E.length-this.tagLength),S),!s.equal($,E.subarray(E.length-this.tagLength,E.length)))return null;var F=E.length-this.tagLength,H;if(N){if(N.length!==F)throw new Error("ChaCha20Poly1305: incorrect destination length");H=N}else H=new Uint8Array(F);return e.streamXOR(this._key,I,E.subarray(0,E.length-this.tagLength),H,4),i.wipe(I),H},d.prototype.clean=function(){return i.wipe(this._key),this},d.prototype._authenticate=function(_,E,S,N){var I=new r.Poly1305(E);N&&(I.update(N),N.length%16>0&&I.update(l.subarray(N.length%16))),I.update(S),S.length%16>0&&I.update(l.subarray(S.length%16));var O=new Uint8Array(8);N&&n.writeUint64LE(N.length,O),I.update(O),n.writeUint64LE(S.length,O),I.update(O);for(var $=I.digest(),F=0;F<$.length;F++)_[F]=$[F];I.clean(),i.wipe($),i.wipe(O)},d}();t.ChaCha20Poly1305=o}(gn);var zo={},Hr={},wn={};Object.defineProperty(wn,"__esModule",{value:!0});function Dd(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}wn.isSerializableHash=Dd,Object.defineProperty(Hr,"__esModule",{value:!0});var Tt=wn,xd=Vt,Sd=yt,qo=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Tt.isSerializableHash(this._inner)&&Tt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Sd.wipe(i)}return t.prototype.reset=function(){if(!Tt.isSerializableHash(this._inner)||!Tt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Tt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Tt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Tt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Tt.isSerializableHash(this._inner)||!Tt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Tt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Hr.HMAC=qo;function Id(t,e,r){var i=new qo(t,e);i.update(r);var n=i.digest();return i.clean(),n}Hr.hmac=Id,Hr.equal=xd.equal,Object.defineProperty(zo,"__esModule",{value:!0});var Ko=Hr,Vo=yt,Od=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=Ko.hmac(this._hash,i,r);this._hmac=new Ko.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Vo.wipe(this._buffer),Vo.wipe(this._counter),this._bufpos=0},t}(),Ad=zo.HKDF=Od,Si={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=pe,r=yt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function o(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return o.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},o.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},o.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},o.prototype.update=function(d,_){if(_===void 0&&(_=d.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var E=0;if(this._bytesHashed+=_,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&_>0;)this._buffer[this._bufferLength++]=d[E++],_--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(_>=this.blockSize&&(E=s(this._temp,this._state,d,E,_),_%=this.blockSize);_>0;)this._buffer[this._bufferLength++]=d[E++],_--;return this},o.prototype.finish=function(d){if(!this._finished){var _=this._bytesHashed,E=this._bufferLength,S=_/536870912|0,N=_<<3,I=_%64<56?64:128;this._buffer[E]=128;for(var O=E+1;O<I-8;O++)this._buffer[O]=0;e.writeUint32BE(S,this._buffer,I-8),e.writeUint32BE(N,this._buffer,I-4),s(this._temp,this._state,this._buffer,0,I),this._finished=!0}for(var O=0;O<this.digestLength/4;O++)e.writeUint32BE(this._state[O],d,O*4);return this},o.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},o.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},o.prototype.restoreState=function(d){return this._state.set(d.state),this._bufferLength=d.bufferLength,d.buffer&&this._buffer.set(d.buffer),this._bytesHashed=d.bytesHashed,this._finished=!1,this},o.prototype.cleanSavedState=function(d){r.wipe(d.state),d.buffer&&r.wipe(d.buffer),d.bufferLength=0,d.bytesHashed=0},o}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(o,d,_,E,S){for(;S>=64;){for(var N=d[0],I=d[1],O=d[2],$=d[3],F=d[4],H=d[5],f=d[6],w=d[7],p=0;p<16;p++){var y=E+p*4;o[p]=e.readUint32BE(_,y)}for(var p=16;p<64;p++){var b=o[p-2],a=(b>>>17|b<<32-17)^(b>>>19|b<<32-19)^b>>>10;b=o[p-15];var m=(b>>>7|b<<32-7)^(b>>>18|b<<32-18)^b>>>3;o[p]=(a+o[p-7]|0)+(m+o[p-16]|0)}for(var p=0;p<64;p++){var a=(((F>>>6|F<<26)^(F>>>11|F<<21)^(F>>>25|F<<7))+(F&H^~F&f)|0)+(w+(n[p]+o[p]|0)|0)|0,m=((N>>>2|N<<32-2)^(N>>>13|N<<32-13)^(N>>>22|N<<32-22))+(N&I^N&O^I&O)|0;w=f,f=H,H=F,F=$+a|0,$=O,O=I,I=N,N=a+m|0}d[0]+=N,d[1]+=I,d[2]+=O,d[3]+=$,d[4]+=F,d[5]+=H,d[6]+=f,d[7]+=w,E+=64,S-=64}return E}function l(o){var d=new i;d.update(o);var _=d.digest();return d.clean(),_}t.hash=l})(Si);var mn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=pr,r=yt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(p){const y=new Float64Array(16);if(p)for(let b=0;b<p.length;b++)y[b]=p[b];return y}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function l(p){let y=1;for(let b=0;b<16;b++){let a=p[b]+y+65535;y=Math.floor(a/65536),p[b]=a-y*65536}p[0]+=y-1+37*(y-1)}function o(p,y,b){const a=~(b-1);for(let m=0;m<16;m++){const M=a&(p[m]^y[m]);p[m]^=M,y[m]^=M}}function d(p,y){const b=i(),a=i();for(let m=0;m<16;m++)a[m]=y[m];l(a),l(a),l(a);for(let m=0;m<2;m++){b[0]=a[0]-65517;for(let z=1;z<15;z++)b[z]=a[z]-65535-(b[z-1]>>16&1),b[z-1]&=65535;b[15]=a[15]-32767-(b[14]>>16&1);const M=b[15]>>16&1;b[14]&=65535,o(a,b,1-M)}for(let m=0;m<16;m++)p[2*m]=a[m]&255,p[2*m+1]=a[m]>>8}function _(p,y){for(let b=0;b<16;b++)p[b]=y[2*b]+(y[2*b+1]<<8);p[15]&=32767}function E(p,y,b){for(let a=0;a<16;a++)p[a]=y[a]+b[a]}function S(p,y,b){for(let a=0;a<16;a++)p[a]=y[a]-b[a]}function N(p,y,b){let a,m,M=0,z=0,W=0,ee=0,re=0,D=0,A=0,k=0,V=0,K=0,q=0,J=0,G=0,se=0,X=0,ce=0,ie=0,ge=0,B=0,L=0,U=0,h=0,C=0,Z=0,Q=0,fe=0,xe=0,_e=0,Se=0,Fe=0,Re=0,Ee=b[0],me=b[1],he=b[2],ye=b[3],be=b[4],ue=b[5],de=b[6],g=b[7],c=b[8],u=b[9],v=b[10],T=b[11],P=b[12],j=b[13],te=b[14],oe=b[15];a=y[0],M+=a*Ee,z+=a*me,W+=a*he,ee+=a*ye,re+=a*be,D+=a*ue,A+=a*de,k+=a*g,V+=a*c,K+=a*u,q+=a*v,J+=a*T,G+=a*P,se+=a*j,X+=a*te,ce+=a*oe,a=y[1],z+=a*Ee,W+=a*me,ee+=a*he,re+=a*ye,D+=a*be,A+=a*ue,k+=a*de,V+=a*g,K+=a*c,q+=a*u,J+=a*v,G+=a*T,se+=a*P,X+=a*j,ce+=a*te,ie+=a*oe,a=y[2],W+=a*Ee,ee+=a*me,re+=a*he,D+=a*ye,A+=a*be,k+=a*ue,V+=a*de,K+=a*g,q+=a*c,J+=a*u,G+=a*v,se+=a*T,X+=a*P,ce+=a*j,ie+=a*te,ge+=a*oe,a=y[3],ee+=a*Ee,re+=a*me,D+=a*he,A+=a*ye,k+=a*be,V+=a*ue,K+=a*de,q+=a*g,J+=a*c,G+=a*u,se+=a*v,X+=a*T,ce+=a*P,ie+=a*j,ge+=a*te,B+=a*oe,a=y[4],re+=a*Ee,D+=a*me,A+=a*he,k+=a*ye,V+=a*be,K+=a*ue,q+=a*de,J+=a*g,G+=a*c,se+=a*u,X+=a*v,ce+=a*T,ie+=a*P,ge+=a*j,B+=a*te,L+=a*oe,a=y[5],D+=a*Ee,A+=a*me,k+=a*he,V+=a*ye,K+=a*be,q+=a*ue,J+=a*de,G+=a*g,se+=a*c,X+=a*u,ce+=a*v,ie+=a*T,ge+=a*P,B+=a*j,L+=a*te,U+=a*oe,a=y[6],A+=a*Ee,k+=a*me,V+=a*he,K+=a*ye,q+=a*be,J+=a*ue,G+=a*de,se+=a*g,X+=a*c,ce+=a*u,ie+=a*v,ge+=a*T,B+=a*P,L+=a*j,U+=a*te,h+=a*oe,a=y[7],k+=a*Ee,V+=a*me,K+=a*he,q+=a*ye,J+=a*be,G+=a*ue,se+=a*de,X+=a*g,ce+=a*c,ie+=a*u,ge+=a*v,B+=a*T,L+=a*P,U+=a*j,h+=a*te,C+=a*oe,a=y[8],V+=a*Ee,K+=a*me,q+=a*he,J+=a*ye,G+=a*be,se+=a*ue,X+=a*de,ce+=a*g,ie+=a*c,ge+=a*u,B+=a*v,L+=a*T,U+=a*P,h+=a*j,C+=a*te,Z+=a*oe,a=y[9],K+=a*Ee,q+=a*me,J+=a*he,G+=a*ye,se+=a*be,X+=a*ue,ce+=a*de,ie+=a*g,ge+=a*c,B+=a*u,L+=a*v,U+=a*T,h+=a*P,C+=a*j,Z+=a*te,Q+=a*oe,a=y[10],q+=a*Ee,J+=a*me,G+=a*he,se+=a*ye,X+=a*be,ce+=a*ue,ie+=a*de,ge+=a*g,B+=a*c,L+=a*u,U+=a*v,h+=a*T,C+=a*P,Z+=a*j,Q+=a*te,fe+=a*oe,a=y[11],J+=a*Ee,G+=a*me,se+=a*he,X+=a*ye,ce+=a*be,ie+=a*ue,ge+=a*de,B+=a*g,L+=a*c,U+=a*u,h+=a*v,C+=a*T,Z+=a*P,Q+=a*j,fe+=a*te,xe+=a*oe,a=y[12],G+=a*Ee,se+=a*me,X+=a*he,ce+=a*ye,ie+=a*be,ge+=a*ue,B+=a*de,L+=a*g,U+=a*c,h+=a*u,C+=a*v,Z+=a*T,Q+=a*P,fe+=a*j,xe+=a*te,_e+=a*oe,a=y[13],se+=a*Ee,X+=a*me,ce+=a*he,ie+=a*ye,ge+=a*be,B+=a*ue,L+=a*de,U+=a*g,h+=a*c,C+=a*u,Z+=a*v,Q+=a*T,fe+=a*P,xe+=a*j,_e+=a*te,Se+=a*oe,a=y[14],X+=a*Ee,ce+=a*me,ie+=a*he,ge+=a*ye,B+=a*be,L+=a*ue,U+=a*de,h+=a*g,C+=a*c,Z+=a*u,Q+=a*v,fe+=a*T,xe+=a*P,_e+=a*j,Se+=a*te,Fe+=a*oe,a=y[15],ce+=a*Ee,ie+=a*me,ge+=a*he,B+=a*ye,L+=a*be,U+=a*ue,h+=a*de,C+=a*g,Z+=a*c,Q+=a*u,fe+=a*v,xe+=a*T,_e+=a*P,Se+=a*j,Fe+=a*te,Re+=a*oe,M+=38*ie,z+=38*ge,W+=38*B,ee+=38*L,re+=38*U,D+=38*h,A+=38*C,k+=38*Z,V+=38*Q,K+=38*fe,q+=38*xe,J+=38*_e,G+=38*Se,se+=38*Fe,X+=38*Re,m=1,a=M+m+65535,m=Math.floor(a/65536),M=a-m*65536,a=z+m+65535,m=Math.floor(a/65536),z=a-m*65536,a=W+m+65535,m=Math.floor(a/65536),W=a-m*65536,a=ee+m+65535,m=Math.floor(a/65536),ee=a-m*65536,a=re+m+65535,m=Math.floor(a/65536),re=a-m*65536,a=D+m+65535,m=Math.floor(a/65536),D=a-m*65536,a=A+m+65535,m=Math.floor(a/65536),A=a-m*65536,a=k+m+65535,m=Math.floor(a/65536),k=a-m*65536,a=V+m+65535,m=Math.floor(a/65536),V=a-m*65536,a=K+m+65535,m=Math.floor(a/65536),K=a-m*65536,a=q+m+65535,m=Math.floor(a/65536),q=a-m*65536,a=J+m+65535,m=Math.floor(a/65536),J=a-m*65536,a=G+m+65535,m=Math.floor(a/65536),G=a-m*65536,a=se+m+65535,m=Math.floor(a/65536),se=a-m*65536,a=X+m+65535,m=Math.floor(a/65536),X=a-m*65536,a=ce+m+65535,m=Math.floor(a/65536),ce=a-m*65536,M+=m-1+37*(m-1),m=1,a=M+m+65535,m=Math.floor(a/65536),M=a-m*65536,a=z+m+65535,m=Math.floor(a/65536),z=a-m*65536,a=W+m+65535,m=Math.floor(a/65536),W=a-m*65536,a=ee+m+65535,m=Math.floor(a/65536),ee=a-m*65536,a=re+m+65535,m=Math.floor(a/65536),re=a-m*65536,a=D+m+65535,m=Math.floor(a/65536),D=a-m*65536,a=A+m+65535,m=Math.floor(a/65536),A=a-m*65536,a=k+m+65535,m=Math.floor(a/65536),k=a-m*65536,a=V+m+65535,m=Math.floor(a/65536),V=a-m*65536,a=K+m+65535,m=Math.floor(a/65536),K=a-m*65536,a=q+m+65535,m=Math.floor(a/65536),q=a-m*65536,a=J+m+65535,m=Math.floor(a/65536),J=a-m*65536,a=G+m+65535,m=Math.floor(a/65536),G=a-m*65536,a=se+m+65535,m=Math.floor(a/65536),se=a-m*65536,a=X+m+65535,m=Math.floor(a/65536),X=a-m*65536,a=ce+m+65535,m=Math.floor(a/65536),ce=a-m*65536,M+=m-1+37*(m-1),p[0]=M,p[1]=z,p[2]=W,p[3]=ee,p[4]=re,p[5]=D,p[6]=A,p[7]=k,p[8]=V,p[9]=K,p[10]=q,p[11]=J,p[12]=G,p[13]=se,p[14]=X,p[15]=ce}function I(p,y){N(p,y,y)}function O(p,y){const b=i();for(let a=0;a<16;a++)b[a]=y[a];for(let a=253;a>=0;a--)I(b,b),a!==2&&a!==4&&N(b,b,y);for(let a=0;a<16;a++)p[a]=b[a]}function $(p,y){const b=new Uint8Array(32),a=new Float64Array(80),m=i(),M=i(),z=i(),W=i(),ee=i(),re=i();for(let V=0;V<31;V++)b[V]=p[V];b[31]=p[31]&127|64,b[0]&=248,_(a,y);for(let V=0;V<16;V++)M[V]=a[V];m[0]=W[0]=1;for(let V=254;V>=0;--V){const K=b[V>>>3]>>>(V&7)&1;o(m,M,K),o(z,W,K),E(ee,m,z),S(m,m,z),E(z,M,W),S(M,M,W),I(W,ee),I(re,m),N(m,z,m),N(z,M,ee),E(ee,m,z),S(m,m,z),I(M,m),S(z,W,re),N(m,z,s),E(m,m,W),N(z,z,m),N(m,W,re),N(W,M,a),I(M,ee),o(m,M,K),o(z,W,K)}for(let V=0;V<16;V++)a[V+16]=m[V],a[V+32]=z[V],a[V+48]=M[V],a[V+64]=W[V];const D=a.subarray(32),A=a.subarray(16);O(D,D),N(A,A,D);const k=new Uint8Array(32);return d(k,A),k}t.scalarMult=$;function F(p){return $(p,n)}t.scalarMultBase=F;function H(p){if(p.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const y=new Uint8Array(p);return{publicKey:F(y),secretKey:y}}t.generateKeyPairFromSeed=H;function f(p){const y=(0,e.randomBytes)(32,p),b=H(y);return(0,r.wipe)(y),b}t.generateKeyPair=f;function w(p,y,b=!1){if(p.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(y.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const a=$(p,y);if(b){let m=0;for(let M=0;M<a.length;M++)m|=a[M];if(m===0)throw new Error("X25519: invalid shared key")}return a}t.sharedKey=w})(mn);function ko(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Wo(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=ko(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function Go(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Yo=Go("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),bn=Go("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=ko(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Jo={utf8:Yo,"utf-8":Yo,hex:vi.base16,latin1:bn,ascii:bn,binary:bn,...vi};function St(t,e="utf8"){const r=Jo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function It(t,e="utf8"){const r=Jo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Xo=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},Cd=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),Td=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Nd=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),Ud=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Rd=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Pd=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Fd=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Zo=3,Ld=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Pd]],Qo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Md(t){return t?ea(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Rd:typeof navigator<"u"?ea(navigator.userAgent):jd()}function Bd(t){return t!==""&&Ld.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function ea(t){var e=Bd(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new Ud;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Zo&&(n=Xo(Xo([],n,!0),Hd(Zo-n.length),!0)):n=[];var s=n.join("."),l=$d(t),o=Fd.exec(t);return o&&o[1]?new Nd(r,s,l,o[1]):new Cd(r,s,l)}function $d(t){for(var e=0,r=Qo.length;e<r;e++){var i=Qo[e],n=i[0],s=i[1],l=s.exec(t);if(l)return n}return null}function jd(){var t=typeof process<"u"&&process.version;return t?new Td(process.version.slice(1)):null}function Hd(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.getLocalStorage=Ce.getLocalStorageOrThrow=Ce.getCrypto=Ce.getCryptoOrThrow=ra=Ce.getLocation=Ce.getLocationOrThrow=_n=Ce.getNavigator=Ce.getNavigatorOrThrow=ta=Ce.getDocument=Ce.getDocumentOrThrow=Ce.getFromWindowOrThrow=Ce.getFromWindow=void 0;function nr(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ce.getFromWindow=nr;function gr(t){const e=nr(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ce.getFromWindowOrThrow=gr;function zd(){return gr("document")}Ce.getDocumentOrThrow=zd;function qd(){return nr("document")}var ta=Ce.getDocument=qd;function Kd(){return gr("navigator")}Ce.getNavigatorOrThrow=Kd;function Vd(){return nr("navigator")}var _n=Ce.getNavigator=Vd;function kd(){return gr("location")}Ce.getLocationOrThrow=kd;function Wd(){return nr("location")}var ra=Ce.getLocation=Wd;function Gd(){return gr("crypto")}Ce.getCryptoOrThrow=Gd;function Yd(){return nr("crypto")}Ce.getCrypto=Yd;function Jd(){return gr("localStorage")}Ce.getLocalStorageOrThrow=Jd;function Xd(){return nr("localStorage")}Ce.getLocalStorage=Xd;var En={};Object.defineProperty(En,"__esModule",{value:!0}),En.getWindowMetadata=void 0;const ia=Ce;function Zd(){let t,e;try{t=ia.getDocumentOrThrow(),e=ia.getLocationOrThrow()}catch{return null}function r(){const S=t.getElementsByTagName("link"),N=[];for(let I=0;I<S.length;I++){const O=S[I],$=O.getAttribute("rel");if($&&$.toLowerCase().indexOf("icon")>-1){const F=O.getAttribute("href");if(F)if(F.toLowerCase().indexOf("https:")===-1&&F.toLowerCase().indexOf("http:")===-1&&F.indexOf("//")!==0){let H=e.protocol+"//"+e.host;if(F.indexOf("/")===0)H+=F;else{const f=e.pathname.split("/");f.pop();const w=f.join("/");H+=w+"/"+F}N.push(H)}else if(F.indexOf("//")===0){const H=e.protocol+F;N.push(H)}else N.push(F)}}return N}function i(...S){const N=t.getElementsByTagName("meta");for(let I=0;I<N.length;I++){const O=N[I],$=["itemprop","property","name"].map(F=>O.getAttribute(F)).filter(F=>F?S.includes(F):!1);if($.length&&$){const F=O.getAttribute("content");if(F)return F}}return""}function n(){let S=i("name","og:site_name","og:title","twitter:title");return S||(S=t.title),S}function s(){return i("description","og:description","twitter:description","keywords")}const l=n(),o=s(),d=e.origin,_=r();return{description:o,url:d,icons:_,name:l}}En.getWindowMetadata=Zd;var zr={},vn=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),na="%[a-f0-9]{2}",sa=new RegExp("("+na+")|([^%]+?)","gi"),oa=new RegExp("("+na+")+","gi");function Dn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],Dn(r),Dn(i))}function Qd(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(sa)||[],r=1;r<e.length;r++)t=Dn(e,r).join(""),e=t.match(sa)||[];return t}}function ep(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=oa.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=Qd(r[0]);i!==r[0]&&(e[r[0]]=i)}r=oa.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var l=n[s];t=t.replace(new RegExp(l,"g"),e[l])}return t}var xn=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return ep(t)}},Sn=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},tp=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var l=i[s],o=t[l];(n?e.indexOf(l)!==-1:e(l,o,t))&&(r[l]=o)}return r};(function(t){const e=vn,r=xn,i=Sn,n=tp,s=f=>f==null,l=Symbol("encodeFragmentIdentifier");function o(f){switch(f.arrayFormat){case"index":return w=>(p,y)=>{const b=p.length;return y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,[E(w,f),"[",b,"]"].join("")]:[...p,[E(w,f),"[",E(b,f),"]=",E(y,f)].join("")]};case"bracket":return w=>(p,y)=>y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,[E(w,f),"[]"].join("")]:[...p,[E(w,f),"[]=",E(y,f)].join("")];case"colon-list-separator":return w=>(p,y)=>y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,[E(w,f),":list="].join("")]:[...p,[E(w,f),":list=",E(y,f)].join("")];case"comma":case"separator":case"bracket-separator":{const w=f.arrayFormat==="bracket-separator"?"[]=":"=";return p=>(y,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?y:(b=b===null?"":b,y.length===0?[[E(p,f),w,E(b,f)].join("")]:[[y,E(b,f)].join(f.arrayFormatSeparator)])}default:return w=>(p,y)=>y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,E(w,f)]:[...p,[E(w,f),"=",E(y,f)].join("")]}}function d(f){let w;switch(f.arrayFormat){case"index":return(p,y,b)=>{if(w=/\[(\d*)\]$/.exec(p),p=p.replace(/\[\d*\]$/,""),!w){b[p]=y;return}b[p]===void 0&&(b[p]={}),b[p][w[1]]=y};case"bracket":return(p,y,b)=>{if(w=/(\[\])$/.exec(p),p=p.replace(/\[\]$/,""),!w){b[p]=y;return}if(b[p]===void 0){b[p]=[y];return}b[p]=[].concat(b[p],y)};case"colon-list-separator":return(p,y,b)=>{if(w=/(:list)$/.exec(p),p=p.replace(/:list$/,""),!w){b[p]=y;return}if(b[p]===void 0){b[p]=[y];return}b[p]=[].concat(b[p],y)};case"comma":case"separator":return(p,y,b)=>{const a=typeof y=="string"&&y.includes(f.arrayFormatSeparator),m=typeof y=="string"&&!a&&S(y,f).includes(f.arrayFormatSeparator);y=m?S(y,f):y;const M=a||m?y.split(f.arrayFormatSeparator).map(z=>S(z,f)):y===null?y:S(y,f);b[p]=M};case"bracket-separator":return(p,y,b)=>{const a=/(\[\])$/.test(p);if(p=p.replace(/\[\]$/,""),!a){b[p]=y&&S(y,f);return}const m=y===null?[]:y.split(f.arrayFormatSeparator).map(M=>S(M,f));if(b[p]===void 0){b[p]=m;return}b[p]=[].concat(b[p],m)};default:return(p,y,b)=>{if(b[p]===void 0){b[p]=y;return}b[p]=[].concat(b[p],y)}}}function _(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(f,w){return w.encode?w.strict?e(f):encodeURIComponent(f):f}function S(f,w){return w.decode?r(f):f}function N(f){return Array.isArray(f)?f.sort():typeof f=="object"?N(Object.keys(f)).sort((w,p)=>Number(w)-Number(p)).map(w=>f[w]):f}function I(f){const w=f.indexOf("#");return w!==-1&&(f=f.slice(0,w)),f}function O(f){let w="";const p=f.indexOf("#");return p!==-1&&(w=f.slice(p)),w}function $(f){f=I(f);const w=f.indexOf("?");return w===-1?"":f.slice(w+1)}function F(f,w){return w.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):w.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function H(f,w){w=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},w),_(w.arrayFormatSeparator);const p=d(w),y=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return y;for(const b of f.split("&")){if(b==="")continue;let[a,m]=i(w.decode?b.replace(/\+/g," "):b,"=");m=m===void 0?null:["comma","separator","bracket-separator"].includes(w.arrayFormat)?m:S(m,w),p(S(a,w),m,y)}for(const b of Object.keys(y)){const a=y[b];if(typeof a=="object"&&a!==null)for(const m of Object.keys(a))a[m]=F(a[m],w);else y[b]=F(a,w)}return w.sort===!1?y:(w.sort===!0?Object.keys(y).sort():Object.keys(y).sort(w.sort)).reduce((b,a)=>{const m=y[a];return Boolean(m)&&typeof m=="object"&&!Array.isArray(m)?b[a]=N(m):b[a]=m,b},Object.create(null))}t.extract=$,t.parse=H,t.stringify=(f,w)=>{if(!f)return"";w=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},w),_(w.arrayFormatSeparator);const p=m=>w.skipNull&&s(f[m])||w.skipEmptyString&&f[m]==="",y=o(w),b={};for(const m of Object.keys(f))p(m)||(b[m]=f[m]);const a=Object.keys(b);return w.sort!==!1&&a.sort(w.sort),a.map(m=>{const M=f[m];return M===void 0?"":M===null?E(m,w):Array.isArray(M)?M.length===0&&w.arrayFormat==="bracket-separator"?E(m,w)+"[]":M.reduce(y(m),[]).join("&"):E(m,w)+"="+E(M,w)}).filter(m=>m.length>0).join("&")},t.parseUrl=(f,w)=>{w=Object.assign({decode:!0},w);const[p,y]=i(f,"#");return Object.assign({url:p.split("?")[0]||"",query:H($(f),w)},w&&w.parseFragmentIdentifier&&y?{fragmentIdentifier:S(y,w)}:{})},t.stringifyUrl=(f,w)=>{w=Object.assign({encode:!0,strict:!0,[l]:!0},w);const p=I(f.url).split("?")[0]||"",y=t.extract(f.url),b=t.parse(y,{sort:!1}),a=Object.assign(b,f.query);let m=t.stringify(a,w);m&&(m=`?${m}`);let M=O(f.url);return f.fragmentIdentifier&&(M=`#${w[l]?E(f.fragmentIdentifier,w):f.fragmentIdentifier}`),`${p}${m}${M}`},t.pick=(f,w,p)=>{p=Object.assign({parseFragmentIdentifier:!0,[l]:!1},p);const{url:y,query:b,fragmentIdentifier:a}=t.parseUrl(f,p);return t.stringifyUrl({url:y,query:n(b,w),fragmentIdentifier:a},p)},t.exclude=(f,w,p)=>{const y=Array.isArray(w)?b=>!w.includes(b):(b,a)=>!w(b,a);return t.pick(f,y,p)}})(zr);const rp={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},aa="base10",lt="base16",In="base64pad",On="utf8",ca=0,yr=1,ip=0,ua=1,An=12,Cn=32;function np(){const t=mn.generateKeyPair();return{privateKey:It(t.secretKey,lt),publicKey:It(t.publicKey,lt)}}function Tn(){const t=pr.randomBytes(Cn);return It(t,lt)}function sp(t,e){const r=mn.sharedKey(St(t,lt),St(e,lt)),i=new Ad(Si.SHA256,r).expand(Cn);return It(i,lt)}function op(t){const e=Si.hash(St(t,lt));return It(e,lt)}function Nn(t){const e=Si.hash(St(t,On));return It(e,lt)}function ap(t){return St(`${t}`,aa)}function qr(t){return Number(It(t,aa))}function cp(t){const e=ap(typeof t.type<"u"?t.type:ca);if(qr(e)===yr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?St(t.senderPublicKey,lt):void 0,i=typeof t.iv<"u"?St(t.iv,lt):pr.randomBytes(An),n=new gn.ChaCha20Poly1305(St(t.symKey,lt)).seal(i,St(t.message,On));return hp({type:e,sealed:n,iv:i,senderPublicKey:r})}function up(t){const e=new gn.ChaCha20Poly1305(St(t.symKey,lt)),{sealed:r,iv:i}=Un(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return It(n,On)}function hp(t){if(qr(t.type)===yr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return It(Wo([t.type,t.senderPublicKey,t.iv,t.sealed]),In)}return It(Wo([t.type,t.iv,t.sealed]),In)}function Un(t){const e=St(t,In),r=e.slice(ip,ua),i=ua;if(qr(r)===yr){const o=i+Cn,d=o+An,_=e.slice(i,o),E=e.slice(o,d),S=e.slice(d);return{type:r,sealed:S,iv:E,senderPublicKey:_}}const n=i+An,s=e.slice(i,n),l=e.slice(n);return{type:r,sealed:l,iv:s}}function lp(t,e){const r=Un(t);return ha({type:qr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?It(r.senderPublicKey,lt):void 0,receiverPublicKey:e?.receiverPublicKey})}function ha(t){const e=t?.type||ca;if(e===yr){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function la(t){return t.type===yr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var fp=Object.defineProperty,fa=Object.getOwnPropertySymbols,dp=Object.prototype.hasOwnProperty,pp=Object.prototype.propertyIsEnumerable,da=(t,e,r)=>e in t?fp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pa=(t,e)=>{for(var r in e||(e={}))dp.call(e,r)&&da(t,r,e[r]);if(fa)for(var r of fa(e))pp.call(e,r)&&da(t,r,e[r]);return t};const gp="ReactNative",Kr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},yp="js";function ga(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function wp(){return!ta()&&!!_n()&&navigator.product===gp}function mp(){return!ga()&&!!_n()}function bp(){return wp()?Kr.reactNative:ga()?Kr.node:mp()?Kr.browser:Kr.unknown}function _p(t,e){let r=zr.parse(t);return r=pa(pa({},r),e),t=zr.stringify(r),t}function Ep(){const t=Md();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function vp(){var t;const e=bp();return e===Kr.browser?[e,((t=ra())==null?void 0:t.host)||"unknown"].join(":"):e}function Dp(t,e,r){const i=Ep(),n=vp();return[[t,e].join("-"),[yp,r].join("-"),i,n].join("/")}function xp({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s}){const l=r.split("?"),o=Dp(t,e,i),d={auth:n,ua:o,projectId:s},_=_p(l[1]||"",d);return l[0]+"?"+_}function ya(t){return Object.fromEntries(t.entries())}function wa(t){return new Map(Object.entries(t))}function Rn(t,e){return ae.fromMiliseconds((e||Date.now())+ae.toMiliseconds(t))}function ma(t){return ae.fromMiliseconds(Date.now())>=ae.toMiliseconds(t)}function Sp(){const t=ae.toMiliseconds(ae.FIVE_MINUTES);let e,r,i;return{resolve:n=>{i&&e&&(clearTimeout(i),e(n))},reject:n=>{i&&r&&(clearTimeout(i),r(n))},done:()=>new Promise((n,s)=>{i=setTimeout(s,t),e=n,r=s})}}function ba(t,e){return new Promise(async(r,i)=>{const n=setTimeout(()=>i(),e),s=await t;clearTimeout(n),r(s)})}function _a(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Ip(t){return _a("topic",t)}function Op(t){return _a("id",t)}function Ap(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Pn(t,e){return`${t}${e?`:${e}`:""}`}const Cp="irn";function Fn(t){return t?.relay||{protocol:Cp}}function Ln(t){const e=rp[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Tp=Object.defineProperty,Ea=Object.getOwnPropertySymbols,Np=Object.prototype.hasOwnProperty,Up=Object.prototype.propertyIsEnumerable,va=(t,e,r)=>e in t?Tp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rp=(t,e)=>{for(var r in e||(e={}))Np.call(e,r)&&va(t,r,e[r]);if(Ea)for(var r of Ea(e))Up.call(e,r)&&va(t,r,e[r]);return t};function Pp(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),l=t[n];r[s]=l}}),r}function Fp(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",l=zr.parse(s);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:l.symKey,relay:Pp(l)}}function Lp(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function Mp(t){return`${t.protocol}:${t.topic}@${t.version}?`+zr.stringify(Rp({symKey:t.symKey},Lp(t.relay)))}const Bp={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},$p={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Ne(t,e){const{message:r,code:i}=$p[t];return{message:e?`${r} ${e}`:r,code:i}}function Vr(t,e){const{message:r,code:i}=Bp[t];return{message:e?`${r} ${e}`:r,code:i}}function Ii(t){return typeof t>"u"}function Da(t,e){return e&&Ii(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function jp(t){if(Da(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Hp(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function zp(t){return t?.topic}function Mn(t){return typeof t<"u"&&typeof t!==null}const qp="PARSE_ERROR",Kp="INVALID_REQUEST",Vp="METHOD_NOT_FOUND",kp="INVALID_PARAMS",xa="INTERNAL_ERROR",Bn="SERVER_ERROR",Wp=[-32700,-32600,-32601,-32602,-32603],kr={[qp]:{code:-32700,message:"Parse error"},[Kp]:{code:-32600,message:"Invalid Request"},[Vp]:{code:-32601,message:"Method not found"},[kp]:{code:-32602,message:"Invalid params"},[xa]:{code:-32603,message:"Internal error"},[Bn]:{code:-32e3,message:"Server error"}},Sa=Bn;function Gp(t){return Wp.includes(t)}function Ia(t){return Object.keys(kr).includes(t)?kr[t]:kr[Sa]}function Yp(t){const e=Object.values(kr).find(r=>r.code===t);return e||kr[Sa]}function Oa(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Aa={},Bt={},Ca;function Jp(){if(Ca)return Bt;Ca=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.isBrowserCryptoAvailable=Bt.getSubtleCrypto=Bt.getBrowerCrypto=void 0;function t(){return ht?.crypto||ht?.msCrypto||{}}Bt.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}Bt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Bt.isBrowserCryptoAvailable=r,Bt}var $t={},Ta;function Xp(){if(Ta)return $t;Ta=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.isBrowser=$t.isNode=$t.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}$t.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}$t.isNode=e;function r(){return!t()&&!e()}return $t.isBrowser=r,$t}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(Jp(),t),e.__exportStar(Xp(),t)})(Aa);function Zp(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function Oi(t,e,r){return{id:r||Zp(),jsonrpc:"2.0",method:t,params:e}}function $n(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Ai(t,e,r){return{id:t,jsonrpc:"2.0",error:Qp(e,r)}}function Qp(t,e){return typeof t>"u"?Ia(xa):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ia(Bn)),{message:t})),typeof e<"u"&&(t.data=e),Gp(t.code)&&(t=Yp(t.code)),t)}class eg{}class tg extends eg{constructor(){super()}}class rg extends tg{constructor(e){super()}}const ig="^https?:",ng="^wss?:";function sg(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Na(t,e){const r=sg(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Ua(t){return Na(t,ig)}function Ra(t){return Na(t,ng)}function og(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Pa(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function jn(t){return Pa(t)&&"method"in t}function Hn(t){return Pa(t)&&(jt(t)||Ot(t))}function jt(t){return"result"in t}function Ot(t){return"error"in t}class zn extends rg{constructor(e){super(e),this.events=new ot.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Oi(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{Ot(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Hn(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}const Fa=10,ag=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),cg=()=>typeof window<"u",ug=ag();class hg{constructor(e){if(this.url=e,this.events=new ot.exports.EventEmitter,this.registering=!1,!Ra(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send($r(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!Ra(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=Aa.isReactNative()?void 0:{rejectUnauthorized:!og(e)},s=new ug(e,[],n);cg()?s.onerror=l=>{const o=l;i(this.emitError(o.error))}:s.on("error",l=>{i(this.emitError(l))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?rn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Ai(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Oa(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Fa&&this.events.setMaxListeners(Fa)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var qn={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,l=9007199254740991,o="[object Arguments]",d="[object Array]",_="[object AsyncFunction]",E="[object Boolean]",S="[object Date]",N="[object Error]",I="[object Function]",O="[object GeneratorFunction]",$="[object Map]",F="[object Number]",H="[object Null]",f="[object Object]",w="[object Promise]",p="[object Proxy]",y="[object RegExp]",b="[object Set]",a="[object String]",m="[object Symbol]",M="[object Undefined]",z="[object WeakMap]",W="[object ArrayBuffer]",ee="[object DataView]",re="[object Float32Array]",D="[object Float64Array]",A="[object Int8Array]",k="[object Int16Array]",V="[object Int32Array]",K="[object Uint8Array]",q="[object Uint8ClampedArray]",J="[object Uint16Array]",G="[object Uint32Array]",se=/[\\^$.*+?()[\]{}|]/g,X=/^\[object .+?Constructor\]$/,ce=/^(?:0|[1-9]\d*)$/,ie={};ie[re]=ie[D]=ie[A]=ie[k]=ie[V]=ie[K]=ie[q]=ie[J]=ie[G]=!0,ie[o]=ie[d]=ie[W]=ie[E]=ie[ee]=ie[S]=ie[N]=ie[I]=ie[$]=ie[F]=ie[f]=ie[y]=ie[b]=ie[a]=ie[z]=!1;var ge=typeof ht=="object"&&ht&&ht.Object===Object&&ht,B=typeof self=="object"&&self&&self.Object===Object&&self,L=ge||B||Function("return this")(),U=e&&!e.nodeType&&e,h=U&&!0&&t&&!t.nodeType&&t,C=h&&h.exports===U,Z=C&&ge.process,Q=function(){try{return Z&&Z.binding&&Z.binding("util")}catch{}}(),fe=Q&&Q.isTypedArray;function xe(x,R){for(var Y=-1,ne=x==null?0:x.length,Ue=0,we=[];++Y<ne;){var $e=x[Y];R($e,Y,x)&&(we[Ue++]=$e)}return we}function _e(x,R){for(var Y=-1,ne=R.length,Ue=x.length;++Y<ne;)x[Ue+Y]=R[Y];return x}function Se(x,R){for(var Y=-1,ne=x==null?0:x.length;++Y<ne;)if(R(x[Y],Y,x))return!0;return!1}function Fe(x,R){for(var Y=-1,ne=Array(x);++Y<x;)ne[Y]=R(Y);return ne}function Re(x){return function(R){return x(R)}}function Ee(x,R){return x.has(R)}function me(x,R){return x?.[R]}function he(x){var R=-1,Y=Array(x.size);return x.forEach(function(ne,Ue){Y[++R]=[Ue,ne]}),Y}function ye(x,R){return function(Y){return x(R(Y))}}function be(x){var R=-1,Y=Array(x.size);return x.forEach(function(ne){Y[++R]=ne}),Y}var ue=Array.prototype,de=Function.prototype,g=Object.prototype,c=L["__core-js_shared__"],u=de.toString,v=g.hasOwnProperty,T=function(){var x=/[^.]+$/.exec(c&&c.keys&&c.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}(),P=g.toString,j=RegExp("^"+u.call(v).replace(se,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=C?L.Buffer:void 0,oe=L.Symbol,ve=L.Uint8Array,Ie=g.propertyIsEnumerable,De=ue.splice,pt=oe?oe.toStringTag:void 0,Yt=Object.getOwnPropertySymbols,Dr=te?te.isBuffer:void 0,ri=ye(Object.keys,Object),je=cr(L,"DataView"),Me=cr(L,"Map"),He=cr(L,"Promise"),ze=cr(L,"Set"),qe=cr(L,"WeakMap"),Be=cr(Object,"create"),ke=Xt(je),We=Xt(Me),Ge=Xt(He),Ye=Xt(ze),Je=Xt(qe),Ve=oe?oe.prototype:void 0,Ke=Ve?Ve.valueOf:void 0;function Pe(x){var R=-1,Y=x==null?0:x.length;for(this.clear();++R<Y;){var ne=x[R];this.set(ne[0],ne[1])}}function Xe(){this.__data__=Be?Be(null):{},this.size=0}function Ze(x){var R=this.has(x)&&delete this.__data__[x];return this.size-=R?1:0,R}function kc(x){var R=this.__data__;if(Be){var Y=R[x];return Y===i?void 0:Y}return v.call(R,x)?R[x]:void 0}function Wc(x){var R=this.__data__;return Be?R[x]!==void 0:v.call(R,x)}function Gc(x,R){var Y=this.__data__;return this.size+=this.has(x)?0:1,Y[x]=Be&&R===void 0?i:R,this}Pe.prototype.clear=Xe,Pe.prototype.delete=Ze,Pe.prototype.get=kc,Pe.prototype.has=Wc,Pe.prototype.set=Gc;function Lt(x){var R=-1,Y=x==null?0:x.length;for(this.clear();++R<Y;){var ne=x[R];this.set(ne[0],ne[1])}}function Yc(){this.__data__=[],this.size=0}function Jc(x){var R=this.__data__,Y=ni(R,x);if(Y<0)return!1;var ne=R.length-1;return Y==ne?R.pop():De.call(R,Y,1),--this.size,!0}function Xc(x){var R=this.__data__,Y=ni(R,x);return Y<0?void 0:R[Y][1]}function Zc(x){return ni(this.__data__,x)>-1}function Qc(x,R){var Y=this.__data__,ne=ni(Y,x);return ne<0?(++this.size,Y.push([x,R])):Y[ne][1]=R,this}Lt.prototype.clear=Yc,Lt.prototype.delete=Jc,Lt.prototype.get=Xc,Lt.prototype.has=Zc,Lt.prototype.set=Qc;function Jt(x){var R=-1,Y=x==null?0:x.length;for(this.clear();++R<Y;){var ne=x[R];this.set(ne[0],ne[1])}}function eu(){this.size=0,this.__data__={hash:new Pe,map:new(Me||Lt),string:new Pe}}function tu(x){var R=si(this,x).delete(x);return this.size-=R?1:0,R}function ru(x){return si(this,x).get(x)}function iu(x){return si(this,x).has(x)}function nu(x,R){var Y=si(this,x),ne=Y.size;return Y.set(x,R),this.size+=Y.size==ne?0:1,this}Jt.prototype.clear=eu,Jt.prototype.delete=tu,Jt.prototype.get=ru,Jt.prototype.has=iu,Jt.prototype.set=nu;function ii(x){var R=-1,Y=x==null?0:x.length;for(this.__data__=new Jt;++R<Y;)this.add(x[R])}function su(x){return this.__data__.set(x,i),this}function ou(x){return this.__data__.has(x)}ii.prototype.add=ii.prototype.push=su,ii.prototype.has=ou;function zt(x){var R=this.__data__=new Lt(x);this.size=R.size}function au(){this.__data__=new Lt,this.size=0}function cu(x){var R=this.__data__,Y=R.delete(x);return this.size=R.size,Y}function uu(x){return this.__data__.get(x)}function hu(x){return this.__data__.has(x)}function lu(x,R){var Y=this.__data__;if(Y instanceof Lt){var ne=Y.__data__;if(!Me||ne.length<r-1)return ne.push([x,R]),this.size=++Y.size,this;Y=this.__data__=new Jt(ne)}return Y.set(x,R),this.size=Y.size,this}zt.prototype.clear=au,zt.prototype.delete=cu,zt.prototype.get=uu,zt.prototype.has=hu,zt.prototype.set=lu;function fu(x,R){var Y=oi(x),ne=!Y&&Ou(x),Ue=!Y&&!ne&&Hi(x),we=!Y&&!ne&&!Ue&&bs(x),$e=Y||ne||Ue||we,Qe=$e?Fe(x.length,String):[],rt=Qe.length;for(var Le in x)(R||v.call(x,Le))&&!($e&&(Le=="length"||Ue&&(Le=="offset"||Le=="parent")||we&&(Le=="buffer"||Le=="byteLength"||Le=="byteOffset")||vu(Le,rt)))&&Qe.push(Le);return Qe}function ni(x,R){for(var Y=x.length;Y--;)if(gs(x[Y][0],R))return Y;return-1}function du(x,R,Y){var ne=R(x);return oi(x)?ne:_e(ne,Y(x))}function xr(x){return x==null?x===void 0?M:H:pt&&pt in Object(x)?_u(x):Iu(x)}function ls(x){return Sr(x)&&xr(x)==o}function fs(x,R,Y,ne,Ue){return x===R?!0:x==null||R==null||!Sr(x)&&!Sr(R)?x!==x&&R!==R:pu(x,R,Y,ne,fs,Ue)}function pu(x,R,Y,ne,Ue,we){var $e=oi(x),Qe=oi(R),rt=$e?d:qt(x),Le=Qe?d:qt(R);rt=rt==o?f:rt,Le=Le==o?f:Le;var gt=rt==f,xt=Le==f,st=rt==Le;if(st&&Hi(x)){if(!Hi(R))return!1;$e=!0,gt=!1}if(st&&!gt)return we||(we=new zt),$e||bs(x)?ds(x,R,Y,ne,Ue,we):mu(x,R,rt,Y,ne,Ue,we);if(!(Y&n)){var bt=gt&&v.call(x,"__wrapped__"),_t=xt&&v.call(R,"__wrapped__");if(bt||_t){var Kt=bt?x.value():x,Mt=_t?R.value():R;return we||(we=new zt),Ue(Kt,Mt,Y,ne,we)}}return st?(we||(we=new zt),bu(x,R,Y,ne,Ue,we)):!1}function gu(x){if(!ms(x)||xu(x))return!1;var R=ys(x)?j:X;return R.test(Xt(x))}function yu(x){return Sr(x)&&ws(x.length)&&!!ie[xr(x)]}function wu(x){if(!Su(x))return ri(x);var R=[];for(var Y in Object(x))v.call(x,Y)&&Y!="constructor"&&R.push(Y);return R}function ds(x,R,Y,ne,Ue,we){var $e=Y&n,Qe=x.length,rt=R.length;if(Qe!=rt&&!($e&&rt>Qe))return!1;var Le=we.get(x);if(Le&&we.get(R))return Le==R;var gt=-1,xt=!0,st=Y&s?new ii:void 0;for(we.set(x,R),we.set(R,x);++gt<Qe;){var bt=x[gt],_t=R[gt];if(ne)var Kt=$e?ne(_t,bt,gt,R,x,we):ne(bt,_t,gt,x,R,we);if(Kt!==void 0){if(Kt)continue;xt=!1;break}if(st){if(!Se(R,function(Mt,Zt){if(!Ee(st,Zt)&&(bt===Mt||Ue(bt,Mt,Y,ne,we)))return st.push(Zt)})){xt=!1;break}}else if(!(bt===_t||Ue(bt,_t,Y,ne,we))){xt=!1;break}}return we.delete(x),we.delete(R),xt}function mu(x,R,Y,ne,Ue,we,$e){switch(Y){case ee:if(x.byteLength!=R.byteLength||x.byteOffset!=R.byteOffset)return!1;x=x.buffer,R=R.buffer;case W:return!(x.byteLength!=R.byteLength||!we(new ve(x),new ve(R)));case E:case S:case F:return gs(+x,+R);case N:return x.name==R.name&&x.message==R.message;case y:case a:return x==R+"";case $:var Qe=he;case b:var rt=ne&n;if(Qe||(Qe=be),x.size!=R.size&&!rt)return!1;var Le=$e.get(x);if(Le)return Le==R;ne|=s,$e.set(x,R);var gt=ds(Qe(x),Qe(R),ne,Ue,we,$e);return $e.delete(x),gt;case m:if(Ke)return Ke.call(x)==Ke.call(R)}return!1}function bu(x,R,Y,ne,Ue,we){var $e=Y&n,Qe=ps(x),rt=Qe.length,Le=ps(R),gt=Le.length;if(rt!=gt&&!$e)return!1;for(var xt=rt;xt--;){var st=Qe[xt];if(!($e?st in R:v.call(R,st)))return!1}var bt=we.get(x);if(bt&&we.get(R))return bt==R;var _t=!0;we.set(x,R),we.set(R,x);for(var Kt=$e;++xt<rt;){st=Qe[xt];var Mt=x[st],Zt=R[st];if(ne)var _s=$e?ne(Zt,Mt,st,R,x,we):ne(Mt,Zt,st,x,R,we);if(!(_s===void 0?Mt===Zt||Ue(Mt,Zt,Y,ne,we):_s)){_t=!1;break}Kt||(Kt=st=="constructor")}if(_t&&!Kt){var ai=x.constructor,ci=R.constructor;ai!=ci&&"constructor"in x&&"constructor"in R&&!(typeof ai=="function"&&ai instanceof ai&&typeof ci=="function"&&ci instanceof ci)&&(_t=!1)}return we.delete(x),we.delete(R),_t}function ps(x){return du(x,Tu,Eu)}function si(x,R){var Y=x.__data__;return Du(R)?Y[typeof R=="string"?"string":"hash"]:Y.map}function cr(x,R){var Y=me(x,R);return gu(Y)?Y:void 0}function _u(x){var R=v.call(x,pt),Y=x[pt];try{x[pt]=void 0;var ne=!0}catch{}var Ue=P.call(x);return ne&&(R?x[pt]=Y:delete x[pt]),Ue}var Eu=Yt?function(x){return x==null?[]:(x=Object(x),xe(Yt(x),function(R){return Ie.call(x,R)}))}:Nu,qt=xr;(je&&qt(new je(new ArrayBuffer(1)))!=ee||Me&&qt(new Me)!=$||He&&qt(He.resolve())!=w||ze&&qt(new ze)!=b||qe&&qt(new qe)!=z)&&(qt=function(x){var R=xr(x),Y=R==f?x.constructor:void 0,ne=Y?Xt(Y):"";if(ne)switch(ne){case ke:return ee;case We:return $;case Ge:return w;case Ye:return b;case Je:return z}return R});function vu(x,R){return R=R??l,!!R&&(typeof x=="number"||ce.test(x))&&x>-1&&x%1==0&&x<R}function Du(x){var R=typeof x;return R=="string"||R=="number"||R=="symbol"||R=="boolean"?x!=="__proto__":x===null}function xu(x){return!!T&&T in x}function Su(x){var R=x&&x.constructor,Y=typeof R=="function"&&R.prototype||g;return x===Y}function Iu(x){return P.call(x)}function Xt(x){if(x!=null){try{return u.call(x)}catch{}try{return x+""}catch{}}return""}function gs(x,R){return x===R||x!==x&&R!==R}var Ou=ls(function(){return arguments}())?ls:function(x){return Sr(x)&&v.call(x,"callee")&&!Ie.call(x,"callee")},oi=Array.isArray;function Au(x){return x!=null&&ws(x.length)&&!ys(x)}var Hi=Dr||Uu;function Cu(x,R){return fs(x,R)}function ys(x){if(!ms(x))return!1;var R=xr(x);return R==I||R==O||R==_||R==p}function ws(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=l}function ms(x){var R=typeof x;return x!=null&&(R=="object"||R=="function")}function Sr(x){return x!=null&&typeof x=="object"}var bs=fe?Re(fe):yu;function Tu(x){return Au(x)?fu(x):wu(x)}function Nu(){return[]}function Uu(){return!1}t.exports=Cu})(qn,qn.exports);var lg=qn.exports;function fg(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),l=s.charCodeAt(0);if(r[l]!==255)throw new TypeError(s+" is ambiguous");r[l]=n}var o=t.length,d=t.charAt(0),_=Math.log(o)/Math.log(256),E=Math.log(256)/Math.log(o);function S(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var $=0,F=0,H=0,f=O.length;H!==f&&O[H]===0;)H++,$++;for(var w=(f-H)*E+1>>>0,p=new Uint8Array(w);H!==f;){for(var y=O[H],b=0,a=w-1;(y!==0||b<F)&&a!==-1;a--,b++)y+=256*p[a]>>>0,p[a]=y%o>>>0,y=y/o>>>0;if(y!==0)throw new Error("Non-zero carry");F=b,H++}for(var m=w-F;m!==w&&p[m]===0;)m++;for(var M=d.repeat($);m<w;++m)M+=t.charAt(p[m]);return M}function N(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var $=0;if(O[$]!==" "){for(var F=0,H=0;O[$]===d;)F++,$++;for(var f=(O.length-$)*_+1>>>0,w=new Uint8Array(f);O[$];){var p=r[O.charCodeAt($)];if(p===255)return;for(var y=0,b=f-1;(p!==0||y<H)&&b!==-1;b--,y++)p+=o*w[b]>>>0,w[b]=p%256>>>0,p=p/256>>>0;if(p!==0)throw new Error("Non-zero carry");H=y,$++}if(O[$]!==" "){for(var a=f-H;a!==f&&w[a]===0;)a++;for(var m=new Uint8Array(F+(f-a)),M=F;a!==f;)m[M++]=w[a++];return m}}}function I(O){var $=N(O);if($)return $;throw new Error(`Non-${e} character`)}return{encode:S,decodeUnsafe:N,decode:I}}var dg=fg,pg=dg;const La=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},gg=t=>new TextEncoder().encode(t),yg=t=>new TextDecoder().decode(t);class wg{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class mg{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ma(this,e)}}class bg{constructor(e){this.decoders=e}or(e){return Ma(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ma=(t,e)=>new bg({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class _g{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new wg(e,r,i),this.decoder=new mg(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ci=({name:t,prefix:e,encode:r,decode:i})=>new _g(t,e,r,i),Wr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=pg(r,e);return Ci({prefix:t,name:e,encode:i,decode:s=>La(n(s))})},Eg=(t,e,r,i)=>{const n={};for(let E=0;E<e.length;++E)n[e[E]]=E;let s=t.length;for(;t[s-1]==="=";)--s;const l=new Uint8Array(s*r/8|0);let o=0,d=0,_=0;for(let E=0;E<s;++E){const S=n[t[E]];if(S===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<r|S,o+=r,o>=8&&(o-=8,l[_++]=255&d>>o)}if(o>=r||255&d<<8-o)throw new SyntaxError("Unexpected end of data");return l},vg=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",l=0,o=0;for(let d=0;d<t.length;++d)for(o=o<<8|t[d],l+=8;l>r;)l-=r,s+=e[n&o>>l];if(l&&(s+=e[n&o<<r-l]),i)for(;s.length*r&7;)s+="=";return s},nt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Ci({prefix:e,name:t,encode(n){return vg(n,i,r)},decode(n){return Eg(n,i,r,t)}}),Dg=Ci({prefix:"\0",name:"identity",encode:t=>yg(t),decode:t=>gg(t)});var xg=Object.freeze({__proto__:null,identity:Dg});const Sg=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ig=Object.freeze({__proto__:null,base2:Sg});const Og=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ag=Object.freeze({__proto__:null,base8:Og});const Cg=Wr({prefix:"9",name:"base10",alphabet:"0123456789"});var Tg=Object.freeze({__proto__:null,base10:Cg});const Ng=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ug=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Rg=Object.freeze({__proto__:null,base16:Ng,base16upper:Ug});const Pg=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Fg=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Lg=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Mg=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Bg=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$g=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),jg=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Hg=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zg=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var qg=Object.freeze({__proto__:null,base32:Pg,base32upper:Fg,base32pad:Lg,base32padupper:Mg,base32hex:Bg,base32hexupper:$g,base32hexpad:jg,base32hexpadupper:Hg,base32z:zg});const Kg=Wr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Vg=Wr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var kg=Object.freeze({__proto__:null,base36:Kg,base36upper:Vg});const Wg=Wr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Gg=Wr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Yg=Object.freeze({__proto__:null,base58btc:Wg,base58flickr:Gg});const Jg=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Xg=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Zg=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Qg=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var e0=Object.freeze({__proto__:null,base64:Jg,base64pad:Xg,base64url:Zg,base64urlpad:Qg});const Ba=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),t0=Ba.reduce((t,e,r)=>(t[r]=e,t),[]),r0=Ba.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function i0(t){return t.reduce((e,r)=>(e+=t0[r],e),"")}function n0(t){const e=[];for(const r of t){const i=r0[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const s0=Ci({prefix:"\u{1F680}",name:"base256emoji",encode:i0,decode:n0});var o0=Object.freeze({__proto__:null,base256emoji:s0}),a0=ja,$a=128,c0=127,u0=~c0,h0=Math.pow(2,31);function ja(t,e,r){e=e||[],r=r||0;for(var i=r;t>=h0;)e[r++]=t&255|$a,t/=128;for(;t&u0;)e[r++]=t&255|$a,t>>>=7;return e[r]=t|0,ja.bytes=r-i+1,e}var l0=Kn,f0=128,Ha=127;function Kn(t,i){var r=0,i=i||0,n=0,s=i,l,o=t.length;do{if(s>=o)throw Kn.bytes=0,new RangeError("Could not decode varint");l=t[s++],r+=n<28?(l&Ha)<<n:(l&Ha)*Math.pow(2,n),n+=7}while(l>=f0);return Kn.bytes=s-i,r}var d0=Math.pow(2,7),p0=Math.pow(2,14),g0=Math.pow(2,21),y0=Math.pow(2,28),w0=Math.pow(2,35),m0=Math.pow(2,42),b0=Math.pow(2,49),_0=Math.pow(2,56),E0=Math.pow(2,63),v0=function(t){return t<d0?1:t<p0?2:t<g0?3:t<y0?4:t<w0?5:t<m0?6:t<b0?7:t<_0?8:t<E0?9:10},D0={encode:a0,decode:l0,encodingLength:v0},za=D0;const qa=(t,e,r=0)=>(za.encode(t,e,r),e),Ka=t=>za.encodingLength(t),Vn=(t,e)=>{const r=e.byteLength,i=Ka(t),n=i+Ka(r),s=new Uint8Array(n+r);return qa(t,s,0),qa(r,s,i),s.set(e,n),new x0(t,r,e,s)};class x0{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Va=({name:t,code:e,encode:r})=>new S0(t,e,r);class S0{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Vn(this.code,r):r.then(i=>Vn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const ka=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),I0=Va({name:"sha2-256",code:18,encode:ka("SHA-256")}),O0=Va({name:"sha2-512",code:19,encode:ka("SHA-512")});var A0=Object.freeze({__proto__:null,sha256:I0,sha512:O0});const Wa=0,C0="identity",Ga=La,T0=t=>Vn(Wa,Ga(t)),N0={code:Wa,name:C0,encode:Ga,digest:T0};var U0=Object.freeze({__proto__:null,identity:N0});new TextEncoder,new TextDecoder;const Ya={...xg,...Ig,...Ag,...Tg,...Rg,...qg,...kg,...Yg,...e0,...o0};({...A0,...U0});function R0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Ja(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Xa=Ja("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),kn=Ja("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=R0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),P0={utf8:Xa,"utf-8":Xa,hex:Ya.base16,latin1:kn,ascii:kn,binary:kn,...Ya};function F0(t,e="utf8"){const r=P0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const Za="wc",L0=2,Wn="core",kt=`${Za}@${2}:${Wn}:`,M0={name:Wn,logger:"error"},B0={database:":memory:"},$0="crypto",Qa="client_ed25519_seed",j0=ae.ONE_DAY,H0="keychain",z0="0.3",q0="messages",K0="0.3",V0=ae.SIX_HOURS,k0="publisher",ec="irn",W0="error",G0="wss://relay.walletconnect.com",Y0="relayer",ft={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed"},J0="_subscription",Ti={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},tc=ae.ONE_SECOND,X0="2.2.0",Z0="0.3",Nt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Q0="subscription",ey="0.3",ty=ae.FIVE_SECONDS*1e3,ry="pairing",iy="0.3",Gr={wc_pairingDelete:{req:{ttl:ae.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ae.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ae.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ae.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ae.ONE_DAY,prompt:!1,tag:0},res:{ttl:ae.ONE_DAY,prompt:!1,tag:0}}},Ut={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ny="history",sy="0.3",oy="expirer",vt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},ay="0.3";class cy{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=H0,this.version=z0,this.initialized=!1,this.storagePrefix=kt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=Ne("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ya(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?wa(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Ne("NOT_INITIALIZED",this.name);throw new Error(e)}}}class uy{constructor(e,r,i){this.core=e,this.logger=r,this.name=$0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=Bo(n);return Mo(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=np();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),l=Bo(s),o=Tn();return await gd(o,n,j0,l)},this.generateSharedKey=(n,s,l)=>{this.isInitialized();const o=this.getPrivateKey(n),d=sp(o,s);return this.setSymKey(d,l)},this.setSymKey=async(n,s)=>{this.isInitialized();const l=s||op(n);return await this.keychain.set(l,n),l},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,l)=>{this.isInitialized();const o=ha(l),d=$r(s);if(la(o)){const N=o.senderPublicKey,I=o.receiverPublicKey;n=await this.generateSharedKey(N,I)}const _=this.getSymKey(n),{type:E,senderPublicKey:S}=o;return cp({type:E,symKey:_,message:d,senderPublicKey:S})},this.decode=async(n,s,l)=>{this.isInitialized();const o=lp(s,l);if(la(o)){const E=o.receiverPublicKey,S=o.senderPublicKey;n=await this.generateSharedKey(E,S)}const d=this.getSymKey(n),_=up({symKey:d,encoded:s});return rn(_)},this.core=e,this.logger=Oe.generateChildLogger(r,this.name),this.keychain=i||new cy(this.core,this.logger)}get context(){return Oe.getLoggerContext(this.logger)}getPayloadType(e){const r=Un(e);return qr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Qa)}catch{e=Tn(),await this.keychain.set(Qa,e)}return F0(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Ne("NOT_INITIALIZED",this.name);throw new Error(e)}}}class hy extends Jh{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=q0,this.version=K0,this.initialized=!1,this.storagePrefix=kt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=Nn(n);let l=this.messages.get(i);return typeof l>"u"&&(l={}),typeof l[s]<"u"||(l[s]=n,this.messages.set(i,l),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),l=Nn(n);return typeof s[l]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Oe.generateChildLogger(e,this.name),this.core=r}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ya(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?wa(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Ne("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ly extends Xh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ot.exports.EventEmitter,this.name=k0,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const l=s?.ttl||V0,o=Fn(s),d=s?.prompt||!1,_=s?.tag||0,E={topic:i,message:n,opts:{ttl:l,relay:o,prompt:d,tag:_}},S=Nn(n);this.queue.set(S,E);try{await await ba(this.rpcPublish(i,n,l,o,d,_),this.publishTimeout)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(ft.connection_stalled);return}this.onPublish(S,E),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(l){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(l),l}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Oe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Oe.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,l){var o,d,_,E;const S={method:Ln(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:l}};return Ii((o=S.params)==null?void 0:o.prompt)&&((d=S.params)==null||delete d.prompt),Ii((_=S.params)==null?void 0:_.tag)&&((E=S.params)==null||delete E.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:S}),this.relayer.provider.request(S)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Pr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class fy{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var dy=Object.defineProperty,py=Object.defineProperties,gy=Object.getOwnPropertyDescriptors,rc=Object.getOwnPropertySymbols,yy=Object.prototype.hasOwnProperty,wy=Object.prototype.propertyIsEnumerable,ic=(t,e,r)=>e in t?dy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ni=(t,e)=>{for(var r in e||(e={}))yy.call(e,r)&&ic(t,r,e[r]);if(rc)for(var r of rc(e))wy.call(e,r)&&ic(t,r,e[r]);return t},Gn=(t,e)=>py(t,gy(e));class my extends el{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new fy,this.events=new ot.exports.EventEmitter,this.name=Q0,this.version=ey,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=kt,this.subscribeTimeout=1e4,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=Fn(n),l={topic:i,relay:s};this.pending.set(i,l);const o=await this.rpcSubscribe(i,s);return this.onSubscribe(o,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),o}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const l=new ae.Watch;l.start(this.pendingSubscriptionWatchLabel);const o=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(o),l.stop(this.pendingSubscriptionWatchLabel),n(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=ty&&(clearInterval(o),l.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pendingSubInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=e,this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=Fn(i);await this.rpcUnsubscribe(e,r,n);const s=Vr("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:Ln(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let n;try{n=await await ba(this.relayer.provider.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ft.connection_stalled)}return n}rpcUnsubscribe(e,r,i){const n={method:Ln(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(e,r){this.setSubscription(e,Gn(Ni({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,Gn(Ni({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Ni({},r)),this.topicMap.set(r.topic,e),this.events.emit(Nt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=Ne("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Nt.deleted,Gn(Ni({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Nt.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(Nt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=Ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:i}=e,n={topic:r,relay:i};this.pending.set(n.topic,n);const s=await this.rpcSubscribe(n.topic,n.relay);this.onResubscribe(s,n)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Pr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(ft.connect,async()=>{await this.onConnect()}),this.relayer.on(ft.disconnect,()=>{this.onDisconnect()}),this.events.on(Nt.created,async e=>{const r=Nt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Nt.deleted,async e=>{const r=Nt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Ne("NOT_INITIALIZED",this.name);throw new Error(e)}}}var by=Object.defineProperty,nc=Object.getOwnPropertySymbols,_y=Object.prototype.hasOwnProperty,Ey=Object.prototype.propertyIsEnumerable,sc=(t,e,r)=>e in t?by(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vy=(t,e)=>{for(var r in e||(e={}))_y.call(e,r)&&sc(t,r,e[r]);if(nc)for(var r of nc(e))Ey.call(e,r)&&sc(t,r,e[r]);return t};class Dy extends Zh{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ot.exports.EventEmitter,this.name=Y0,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Oe.generateChildLogger(e.logger,this.name):Ir(Oe.getDefaultLoggerOptions({level:e.logger||W0})),this.messages=new hy(this.logger,e.core),this.subscriber=new my(this,this.logger),this.publisher=new ly(this,this.logger),this.relayUrl=e?.relayUrl||G0,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Oe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(Nt.created,s=>{s.topic===e&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(e,r),n()})]),i}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&await this.provider.disconnect(),this.events.emit(ft.transport_closed)}async transportOpen(e){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Nt.resubscribed,()=>{r()})}),await Promise.race([this.provider.connect(),new Promise((r,i)=>this.once(ft.transport_closed,()=>{i()}))])])}catch(r){const i=r;if(!/socket hang up/i.test(i.message))throw new Error(i.message);this.logger.error(i),this.events.emit(ft.transport_closed)}}async restartTransport(e){await this.transportClose(),await new Promise(r=>setTimeout(r,tc)),await this.transportOpen(e)}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new zn(new hg(xp({sdkVersion:X0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),jn(e)){if(!e.method.endsWith(J0))return;const r=e.params,{topic:i,message:n}=r.data,s={topic:i,message:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(vy({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(e),await this.onMessageEvent(s)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(ft.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=$n(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(Ti.payload,e=>this.onProviderPayload(e)),this.provider.on(Ti.connect,()=>{this.events.emit(ft.connect)}),this.provider.on(Ti.disconnect,()=>{this.events.emit(ft.disconnect),this.attemptToReconnect()}),this.provider.on(Ti.error,e=>this.events.emit(ft.error,e)),this.events.on(ft.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},ae.toMiliseconds(tc))}isInitialized(){if(!this.initialized){const{message:e}=Ne("NOT_INITIALIZED",this.name);throw new Error(e)}}}var xy=Object.defineProperty,oc=Object.getOwnPropertySymbols,Sy=Object.prototype.hasOwnProperty,Iy=Object.prototype.propertyIsEnumerable,ac=(t,e,r)=>e in t?xy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,cc=(t,e)=>{for(var r in e||(e={}))Sy.call(e,r)&&ac(t,r,e[r]);if(oc)for(var r of oc(e))Iy.call(e,r)&&ac(t,r,e[r]);return t};class Ui extends Qh{constructor(e,r,i,n=kt,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=Z0,this.cached=[],this.initialized=!1,this.storagePrefix=kt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{Hp(l)?this.map.set(l.id,l):zp(l)?this.map.set(l.topic,l):this.getKey&&l!==null&&!Ii(l)&&this.map.set(this.getKey(l),l)}),this.cached=[],this.initialized=!0)},this.set=async(l,o)=>{this.isInitialized(),this.map.has(l)?await this.update(l,o):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:o}),this.map.set(l,o),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(o=>Object.keys(l).every(d=>lg(o[d],l[d]))):this.values),this.update=async(l,o)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:o});const d=cc(cc({},this.getData(l)),o);this.map.set(l,d),await this.persist()},this.delete=async(l,o)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:o}),this.map.delete(l),await this.persist())},this.logger=Oe.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=Ne("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=Ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Ne("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Oy{constructor(e,r){this.core=e,this.logger=r,this.name=ry,this.version=iy,this.events=new ot.exports,this.initialized=!1,this.storagePrefix=kt,this.ignoredPayloadTypes=[yr],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=Tn(),n=await this.core.crypto.setSymKey(i),s=Rn(ae.FIVE_MINUTES),l={protocol:ec},o={topic:n,expiry:s,relay:l,active:!1},d=Mp({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:l});return await this.pairings.set(n,o),await this.core.relayer.subscribe(n),this.core.expirer.set(n,s),{topic:n,uri:d}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:s,relay:l}=Fp(i.uri),o=Rn(ae.FIVE_MINUTES),d={topic:n,relay:l,expiry:o,active:!1};return await this.pairings.set(n,d),await this.core.crypto.setSymKey(s,n),await this.core.relayer.subscribe(n,{relay:l}),this.core.expirer.set(n,o),i.activatePairing&&await this.activate({topic:n}),d},this.activate=async({topic:i})=>{this.isInitialized();const n=Rn(ae.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:l,resolve:o,reject:d}=Sp();this.events.once(Pn("pairing_ping",s),({error:_})=>{_?d(_):o()}),await l()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Vr("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,s)=>{const l=Oi(n,s),o=await this.core.crypto.encode(i,l),d=Gr[n].req;return this.core.history.set(i,l),await this.core.relayer.publish(i,o,d),l.id},this.sendResult=async(i,n,s)=>{const l=$n(i,s),o=await this.core.crypto.encode(n,l),d=await this.core.history.get(n,i),_=Gr[d.request.method].res;await this.core.relayer.publish(n,o,_),await this.core.history.resolve(l)},this.sendError=async(i,n,s)=>{const l=Ai(i,s),o=await this.core.crypto.encode(n,l),d=await this.core.history.get(n,i),_=Gr[d.request.method]?Gr[d.request.method].res:Gr.unregistered_method.res;await this.core.relayer.publish(n,o,_),await this.core.history.resolve(l)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Vr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>ma(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,l=(await this.core.history.get(n,s.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit("pairing_ping",{id:s,topic:i})}catch(l){await this.sendError(s,i,l),this.logger.error(l)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{jt(n)?this.events.emit(Pn("pairing_ping",s),{}):Ot(n)&&this.events.emit(Pn("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.sendResult(s,i,!0),await this.deletePairing(i),this.events.emit("pairing_delete",{id:s,topic:i})}catch(l){await this.sendError(s,i,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:l}=n;try{if(this.registeredMethods.includes(l))return;const o=Vr("WC_METHOD_UNSUPPORTED",l);await this.sendError(s,i,o),this.logger.error(o)}catch(o){await this.sendError(s,i,o),this.logger.error(o)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Vr("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!Mn(i)){const{message:n}=Ne("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!jp(i.uri)){const{message:n}=Ne("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!Mn(i)){const{message:s}=Ne("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!Mn(i)){const{message:s}=Ne("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Da(i,!1)){const{message:n}=Ne("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=Ne("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(ma(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=Ne("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=Oe.generateChildLogger(r,this.name),this.pairings=new Ui(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Oe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Ne("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(ft.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);jn(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Hn(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(vt.expired,async e=>{const{topic:r}=Ap(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Ay extends Yh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ot.exports.EventEmitter,this.name=ny,this.version=sy,this.cached=[],this.initialized=!1,this.storagePrefix=kt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const l={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s};this.records.set(l.id,l),this.events.emit(Ut.created,l)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Ot(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(Ut.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(Ut.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:Oi(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=Ne("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ut.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=Ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ut.created,e=>{const r=Ut.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ut.updated,e=>{const r=Ut.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ut.deleted,e=>{const r=Ut.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Ne("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Cy extends tl{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ot.exports.EventEmitter,this.name=oy,this.version=ay,this.cached=[],this.initialized=!1,this.storagePrefix=kt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),l={target:s,expiry:n};this.expirations.set(s,l),this.checkExpiry(s,l),this.events.emit(vt.created,{target:s,expiration:l})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{this.isInitialized();const n=this.formatTarget(i);if(this.has(n)){const s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(vt.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Ip(e);if(typeof e=="number")return Op(e);const{message:r}=Ne("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(vt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=Ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=Ne("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;ae.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(vt.expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Pr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(vt.created,e=>{const r=vt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(vt.expired,e=>{const r=vt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(vt.deleted,e=>{const r=vt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Ne("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Ty=Object.defineProperty,uc=Object.getOwnPropertySymbols,Ny=Object.prototype.hasOwnProperty,Uy=Object.prototype.propertyIsEnumerable,hc=(t,e,r)=>e in t?Ty(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lc=(t,e)=>{for(var r in e||(e={}))Ny.call(e,r)&&hc(t,r,e[r]);if(uc)for(var r of uc(e))Uy.call(e,r)&&hc(t,r,e[r]);return t};class cs extends Gh{constructor(e){super(e),this.protocol=Za,this.version=L0,this.name=Wn,this.events=new ot.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Ir(Oe.getDefaultLoggerOptions({level:e?.logger||M0.logger}));this.logger=Oe.generateChildLogger(r,this.name),this.heartbeat=new Pr.HeartBeat,this.crypto=new uy(this,this.logger,e?.keychain),this.history=new Ay(this,this.logger),this.expirer=new Cy(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Rh(lc(lc({},B0),e?.storageOptions)),this.relayer=new Dy({core:this,logger:this.logger,relayUrl:e?.relayUrl,projectId:this.projectId}),this.pairing=new Oy(this,this.logger)}static async init(e){const r=new cs(e);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initilization Success")}catch(e){throw this.logger.warn(`Core Initilization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Ry=cs;class Py{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Fy{constructor(e){this.client=e}}var Yn={};Object.defineProperty(Yn,"__esModule",{value:!0});var fc=Yn.getWindowMetadata=void 0;const dc=Ce;function Ly(){let t,e;try{t=dc.getDocumentOrThrow(),e=dc.getLocationOrThrow()}catch{return null}function r(){const S=t.getElementsByTagName("link"),N=[];for(let I=0;I<S.length;I++){const O=S[I],$=O.getAttribute("rel");if($&&$.toLowerCase().indexOf("icon")>-1){const F=O.getAttribute("href");if(F)if(F.toLowerCase().indexOf("https:")===-1&&F.toLowerCase().indexOf("http:")===-1&&F.indexOf("//")!==0){let H=e.protocol+"//"+e.host;if(F.indexOf("/")===0)H+=F;else{const f=e.pathname.split("/");f.pop();const w=f.join("/");H+=w+"/"+F}N.push(H)}else if(F.indexOf("//")===0){const H=e.protocol+F;N.push(H)}else N.push(F)}}return N}function i(...S){const N=t.getElementsByTagName("meta");for(let I=0;I<N.length;I++){const O=N[I],$=["itemprop","property","name"].map(F=>O.getAttribute(F)).filter(F=>F?S.includes(F):!1);if($.length&&$){const F=O.getAttribute("content");if(F)return F}}return""}function n(){let S=i("name","og:site_name","og:title","twitter:title");return S||(S=t.title),S}function s(){return i("description","og:description","twitter:description","keywords")}const l=n(),o=s(),d=e.origin,_=r();return{description:o,url:d,icons:_,name:l}}fc=Yn.getWindowMetadata=Ly;var My={},By=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var l=i[s],o=t[l];(n?e.indexOf(l)!==-1:e(l,o,t))&&(r[l]=o)}return r};(function(t){const e=vn,r=xn,i=Sn,n=By,s=f=>f==null,l=Symbol("encodeFragmentIdentifier");function o(f){switch(f.arrayFormat){case"index":return w=>(p,y)=>{const b=p.length;return y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,[E(w,f),"[",b,"]"].join("")]:[...p,[E(w,f),"[",E(b,f),"]=",E(y,f)].join("")]};case"bracket":return w=>(p,y)=>y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,[E(w,f),"[]"].join("")]:[...p,[E(w,f),"[]=",E(y,f)].join("")];case"colon-list-separator":return w=>(p,y)=>y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,[E(w,f),":list="].join("")]:[...p,[E(w,f),":list=",E(y,f)].join("")];case"comma":case"separator":case"bracket-separator":{const w=f.arrayFormat==="bracket-separator"?"[]=":"=";return p=>(y,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?y:(b=b===null?"":b,y.length===0?[[E(p,f),w,E(b,f)].join("")]:[[y,E(b,f)].join(f.arrayFormatSeparator)])}default:return w=>(p,y)=>y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,E(w,f)]:[...p,[E(w,f),"=",E(y,f)].join("")]}}function d(f){let w;switch(f.arrayFormat){case"index":return(p,y,b)=>{if(w=/\[(\d*)\]$/.exec(p),p=p.replace(/\[\d*\]$/,""),!w){b[p]=y;return}b[p]===void 0&&(b[p]={}),b[p][w[1]]=y};case"bracket":return(p,y,b)=>{if(w=/(\[\])$/.exec(p),p=p.replace(/\[\]$/,""),!w){b[p]=y;return}if(b[p]===void 0){b[p]=[y];return}b[p]=[].concat(b[p],y)};case"colon-list-separator":return(p,y,b)=>{if(w=/(:list)$/.exec(p),p=p.replace(/:list$/,""),!w){b[p]=y;return}if(b[p]===void 0){b[p]=[y];return}b[p]=[].concat(b[p],y)};case"comma":case"separator":return(p,y,b)=>{const a=typeof y=="string"&&y.includes(f.arrayFormatSeparator),m=typeof y=="string"&&!a&&S(y,f).includes(f.arrayFormatSeparator);y=m?S(y,f):y;const M=a||m?y.split(f.arrayFormatSeparator).map(z=>S(z,f)):y===null?y:S(y,f);b[p]=M};case"bracket-separator":return(p,y,b)=>{const a=/(\[\])$/.test(p);if(p=p.replace(/\[\]$/,""),!a){b[p]=y&&S(y,f);return}const m=y===null?[]:y.split(f.arrayFormatSeparator).map(M=>S(M,f));if(b[p]===void 0){b[p]=m;return}b[p]=[].concat(b[p],m)};default:return(p,y,b)=>{if(b[p]===void 0){b[p]=y;return}b[p]=[].concat(b[p],y)}}}function _(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(f,w){return w.encode?w.strict?e(f):encodeURIComponent(f):f}function S(f,w){return w.decode?r(f):f}function N(f){return Array.isArray(f)?f.sort():typeof f=="object"?N(Object.keys(f)).sort((w,p)=>Number(w)-Number(p)).map(w=>f[w]):f}function I(f){const w=f.indexOf("#");return w!==-1&&(f=f.slice(0,w)),f}function O(f){let w="";const p=f.indexOf("#");return p!==-1&&(w=f.slice(p)),w}function $(f){f=I(f);const w=f.indexOf("?");return w===-1?"":f.slice(w+1)}function F(f,w){return w.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):w.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function H(f,w){w=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},w),_(w.arrayFormatSeparator);const p=d(w),y=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return y;for(const b of f.split("&")){if(b==="")continue;let[a,m]=i(w.decode?b.replace(/\+/g," "):b,"=");m=m===void 0?null:["comma","separator","bracket-separator"].includes(w.arrayFormat)?m:S(m,w),p(S(a,w),m,y)}for(const b of Object.keys(y)){const a=y[b];if(typeof a=="object"&&a!==null)for(const m of Object.keys(a))a[m]=F(a[m],w);else y[b]=F(a,w)}return w.sort===!1?y:(w.sort===!0?Object.keys(y).sort():Object.keys(y).sort(w.sort)).reduce((b,a)=>{const m=y[a];return Boolean(m)&&typeof m=="object"&&!Array.isArray(m)?b[a]=N(m):b[a]=m,b},Object.create(null))}t.extract=$,t.parse=H,t.stringify=(f,w)=>{if(!f)return"";w=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},w),_(w.arrayFormatSeparator);const p=m=>w.skipNull&&s(f[m])||w.skipEmptyString&&f[m]==="",y=o(w),b={};for(const m of Object.keys(f))p(m)||(b[m]=f[m]);const a=Object.keys(b);return w.sort!==!1&&a.sort(w.sort),a.map(m=>{const M=f[m];return M===void 0?"":M===null?E(m,w):Array.isArray(M)?M.length===0&&w.arrayFormat==="bracket-separator"?E(m,w)+"[]":M.reduce(y(m),[]).join("&"):E(m,w)+"="+E(M,w)}).filter(m=>m.length>0).join("&")},t.parseUrl=(f,w)=>{w=Object.assign({decode:!0},w);const[p,y]=i(f,"#");return Object.assign({url:p.split("?")[0]||"",query:H($(f),w)},w&&w.parseFragmentIdentifier&&y?{fragmentIdentifier:S(y,w)}:{})},t.stringifyUrl=(f,w)=>{w=Object.assign({encode:!0,strict:!0,[l]:!0},w);const p=I(f.url).split("?")[0]||"",y=t.extract(f.url),b=t.parse(y,{sort:!1}),a=Object.assign(b,f.query);let m=t.stringify(a,w);m&&(m=`?${m}`);let M=O(f.url);return f.fragmentIdentifier&&(M=`#${w[l]?E(f.fragmentIdentifier,w):f.fragmentIdentifier}`),`${p}${m}${M}`},t.pick=(f,w,p)=>{p=Object.assign({parseFragmentIdentifier:!0,[l]:!1},p);const{url:y,query:b,fragmentIdentifier:a}=t.parseUrl(f,p);return t.stringifyUrl({url:y,query:n(b,w),fragmentIdentifier:a},p)},t.exclude=(f,w,p)=>{const y=Array.isArray(w)?b=>!w.includes(b):(b,a)=>!w(b,a);return t.pick(f,y,p)}})(My);const $y=1;function jy(){return fc()||{name:"",description:"",url:"",icons:[""]}}function dt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function wr(t,e){return ae.fromMiliseconds((e||Date.now())+ae.toMiliseconds(t))}function mr(t){return ae.fromMiliseconds(Date.now())>=ae.toMiliseconds(t)}function br(){const t=ae.toMiliseconds(ae.FIVE_MINUTES);let e,r,i;return{resolve:n=>{i&&e&&(clearTimeout(i),e(n))},reject:n=>{i&&r&&(clearTimeout(i),r(n))},done:()=>new Promise((n,s)=>{i=setTimeout(s,t),e=n,r=s})}}function Hy(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function et(t,e){return`${t}${e?`:${e}`:""}`}function Rt(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function zy(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Rt(r.accounts)),r.extension&&r.extension.forEach(i=>{e.push(...Rt(i.accounts))})}),e}function qy(t,e){const r=[];return Object.values(t).forEach(i=>{Rt(i.accounts).includes(e)&&r.push(...i.methods),i.extension&&i.extension.forEach(n=>{Rt(n.accounts).includes(e)&&r.push(...n.methods)})}),r}function Ky(t,e){const r=[];return Object.values(t).forEach(i=>{Rt(i.accounts).includes(e)&&r.push(...i.events),i.extension&&i.extension.forEach(n=>{Rt(n.accounts).includes(e)&&r.push(...n.events)})}),r}function Vy(t,e){const r=Pi(t,e);if(r)throw new Error(r.message);const i={};for(const[n,s]of Object.entries(t))i[n]={methods:s.methods,events:s.events,chains:s.accounts.map(l=>`${l.split(":")[0]}:${l.split(":")[1]}`)};return i}const ky={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Wy={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function le(t,e){const{message:r,code:i}=Wy[t];return{message:e?`${r} ${e}`:r,code:i}}function wt(t,e){const{message:r,code:i}=ky[t];return{message:e?`${r} ${e}`:r,code:i}}function Yr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Ri(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Pt(t){return typeof t>"u"}function ut(t,e){return e&&Pt(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function pc(t,e){return e&&Pt(t)?!0:typeof t=="number"&&!isNaN(t)}function Gy(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return dt(n,i)?(i.forEach(l=>{const{accounts:o,methods:d,events:_,extension:E}=t.namespaces[l],S=Rt(o),N=r[l];(!dt(N.chains,S)||!dt(N.methods,d)||!dt(N.events,_))&&(s=!1),s&&E&&E.forEach(I=>{var O;const{accounts:$,methods:F,events:H}=I,f=Rt($);(O=N.extension)!=null&&O.find(w=>dt(w.chains,f)&&dt(w.methods,F)&&dt(w.events,H))||(s=!1)})}),s):!1}function Jn(t){return ut(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Yy(t){if(ut(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Jn(r)}}return!1}function Jy(t,e){let r=null;return ut(t?.publicKey,!1)||(r=le("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Xn(t,e){let r=null;return Pt(t?.extension)||(!Yr(t.extension)||!t.extension.length)&&(r=le("MISSING_OR_INVALID",`${e} extension should be an array of namespaces, or omitted`)),r}function gc(t){let e=!0;return Yr(t)?t.length&&(e=t.every(r=>ut(r,!1))):e=!1,e}function yc(t,e,r){let i=null;return Yr(e)?e.forEach(n=>{i||(!Jn(n)||!n.includes(t))&&(i=wt("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=wt("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function Xy(t,e){let r=null;return Object.entries(t).forEach(([i,n])=>{if(r)return;const s=yc(i,n?.chains,`${e} requiredNamespace`),l=Xn(n,e);s?r=s:l?r=l:n.extension&&n.extension.forEach(o=>{if(r)return;const d=yc(i,o.chains,`${e} extension`);d&&(r=d)})}),r}function wc(t,e){let r=null;return Yr(t)?t.forEach(i=>{r||Yy(i)||(r=wt("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=wt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Zy(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=wc(i?.accounts,`${e} namespace`),s=Xn(i,e);n?r=n:s?r=s:i.extension&&i.extension.forEach(l=>{if(r)return;const o=wc(l.accounts,`${e} extension`);o&&(r=o)})}),r}function mc(t,e){let r=null;return gc(t?.methods)?gc(t?.events)||(r=wt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=wt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function bc(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=mc(i,`${e}, namespace`),s=Xn(i,e);n?r=n:s?r=s:i.extension&&i.extension.forEach(l=>{if(r)return;const o=mc(l,`${e}, extension`);o&&(r=o)})}),r}function Qy(t,e){let r=null;if(t&&Ri(t)){const i=bc(t,e);i&&(r=i);const n=Xy(t,e);n&&(r=n)}else r=le("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function Pi(t,e){let r=null;if(t&&Ri(t)){const i=bc(t,e);i&&(r=i);const n=Zy(t,e);n&&(r=n)}else r=le("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function _c(t){return ut(t.protocol,!0)}function e1(t,e){let r=!1;return e&&!t?r=!0:t&&Yr(t)&&t.length&&t.forEach(i=>{r=_c(i)}),r}function t1(t){return typeof t=="number"}function At(t){return typeof t<"u"&&typeof t!==null}function r1(t){return!(!t||typeof t!="object"||!t.code||!pc(t.code,!1)||!t.message||!ut(t.message,!1))}function i1(t){return!(Pt(t)||!ut(t.method,!1))}function n1(t){return!(Pt(t)||Pt(t.result)&&Pt(t.error)||!pc(t.id,!1)||!ut(t.jsonrpc,!1))}function s1(t){return!(Pt(t)||!ut(t.name,!1))}function Ec(t,e){return!(!Jn(e)||!zy(t).includes(e))}function o1(t,e,r){return ut(r,!1)?qy(t,e).includes(r):!1}function a1(t,e,r){return ut(r,!1)?Ky(t,e).includes(r):!1}function vc(t,e,r){let i=null;const n=Object.keys(t),s=Object.keys(e);return dt(n,s)?n.forEach(l=>{var o;if(i)return;const d=t[l].chains,_=Rt(e[l].accounts);dt(d,_)?dt(t[l].methods,e[l].methods)?dt(t[l].events,e[l].events)?t[l].extension&&!e[l].extension?i=le("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${l}`):t[l].extension&&e[l].extension&&((o=t[l].extension)==null||o.forEach(({methods:E,events:S,chains:N})=>{var I;i||(I=e[l].extension)!=null&&I.find(O=>{const $=Rt(O.accounts);return dt(N,$)&&dt(S,O.events)&&dt(E,O.methods)})||(i=le("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${l}`))})):i=le("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${l}`):i=le("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${l}`):i=le("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${l}`)}):i=le("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),i}const Dc="wc",xc=2,Sc="client",Zn=`${Dc}@${xc}:${Sc}:`,Qn={name:Sc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},c1="proposal",u1="session",Fi=ae.SEVEN_DAYS,h1="engine",Jr={wc_sessionPropose:{req:{ttl:ae.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ae.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ae.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ae.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ae.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ae.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ae.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ae.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ae.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ae.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ae.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ae.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ae.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ae.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ae.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ae.THIRTY_SECONDS,prompt:!1,tag:1115}}},l1="request";var f1=Object.defineProperty,d1=Object.defineProperties,p1=Object.getOwnPropertyDescriptors,Ic=Object.getOwnPropertySymbols,g1=Object.prototype.hasOwnProperty,y1=Object.prototype.propertyIsEnumerable,Oc=(t,e,r)=>e in t?f1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ht=(t,e)=>{for(var r in e||(e={}))g1.call(e,r)&&Oc(t,r,e[r]);if(Ic)for(var r of Ic(e))y1.call(e,r)&&Oc(t,r,e[r]);return t},es=(t,e)=>d1(t,p1(e));class w1 extends Fy{constructor(e){super(e),this.name=h1,this.events=new ot.exports,this.initialized=!1,this.ignoredPayloadTypes=[$y],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Jr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized(),await this.isValidConnect(r);const{pairingTopic:i,requiredNamespaces:n,relays:s}=r;let l=i,o,d=!1;if(l&&(d=this.client.core.pairing.pairings.get(l).active),!l||!d){const{topic:F,uri:H}=await this.client.core.pairing.create();l=F,o=H}const _=await this.client.core.crypto.generateKeyPair(),E={requiredNamespaces:n,relays:s??[{protocol:ec}],proposer:{publicKey:_,metadata:this.client.metadata}},{reject:S,resolve:N,done:I}=br();if(this.events.once(et("session_connect"),async({error:F,session:H})=>{if(F)S(F);else if(H){H.self.publicKey=_;const f=es(Ht({},H),{requiredNamespaces:H.requiredNamespaces});await this.client.session.set(H.topic,f),await this.setExpiry(H.topic,H.expiry),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:H.peer.metadata}),N(f)}}),!l){const{message:F}=le("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(F)}const O=await this.sendRequest(l,"wc_sessionPropose",E),$=wr(ae.FIVE_MINUTES);return await this.setProposal(O,Ht({id:O,expiry:$},E)),{uri:o,approval:I}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s}=r,l=this.client.proposal.get(i);let{pairingTopic:o,proposer:d,requiredNamespaces:_}=l;Ri(_)||(_=Vy(s,"approve()"),this.client.proposal.set(i,es(Ht({},l),{requiredNamespaces:_})));const E=await this.client.core.crypto.generateKeyPair(),S=d.publicKey,N=await this.client.core.crypto.generateSharedKey(E,S),I={relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:_,controller:{publicKey:E,metadata:this.client.metadata},expiry:wr(Fi)};await this.client.core.relayer.subscribe(N);const O=await this.sendRequest(N,"wc_sessionSettle",I),{done:$,resolve:F,reject:H}=br();this.events.once(et("session_approve",O),({error:w})=>{w?H(w):F(this.client.session.get(N))});const f=es(Ht({},I),{topic:N,acknowledged:!1,self:I.controller,peer:{publicKey:d.publicKey,metadata:d.metadata},controller:E});return await this.client.session.set(N,f),await this.setExpiry(N,wr(Fi)),o&&await this.client.core.pairing.updateMetadata({topic:o,metadata:f.peer.metadata}),o&&i&&(await this.sendResult(i,o,{relay:{protocol:n??"irn"},responderPublicKey:E}),await this.client.proposal.delete(i,wt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:o})),{topic:N,acknowledged:$}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,wt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:l,resolve:o,reject:d}=br();return this.events.once(et("session_update",s),({error:_})=>{_?d(_):o()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:l}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:s,resolve:l,reject:o}=br();return this.events.once(et("session_extend",n),({error:d})=>{d?o(d):l()}),await this.setExpiry(i,wr(Fi)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s}=r,l=await this.sendRequest(s,"wc_sessionRequest",{request:n,chainId:i}),{done:o,resolve:d,reject:_}=br();return this.events.once(et("session_request",l),({error:E,result:S})=>{E?_(E):d(S)}),await o()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;jt(n)?await this.sendResult(s,i,n.result):Ot(n)&&await this.sendError(s,i,n.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:s,resolve:l,reject:o}=br();this.events.once(et("session_ping",n),({error:d})=>{d?o(d):l()}),await s()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",wt("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>Gy(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,wt("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(r),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,wt("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=Jr.wc_sessionRequest.req.ttl,{id:n,topic:s,params:l}=r;await this.client.pendingRequest.set(n,{id:n,topic:s,params:l}),i&&this.client.core.expirer.set(n,i)},this.sendRequest=async(r,i,n)=>{const s=Oi(i,n),l=await this.client.core.crypto.encode(r,s),o=Jr[i].req;return this.client.core.history.set(r,s),this.client.core.relayer.publish(r,l,o),s.id},this.sendResult=async(r,i,n)=>{const s=$n(r,n),l=await this.client.core.crypto.encode(i,s),o=await this.client.core.history.get(i,r),d=Jr[o.request.method].res;this.client.core.relayer.publish(i,l,d),await this.client.core.history.resolve(s)},this.sendError=async(r,i,n)=>{const s=Ai(r,n),l=await this.client.core.crypto.encode(i,s),o=await this.client.core.history.get(i,r),d=Jr[o.request.method].res;this.client.core.relayer.publish(i,l,d),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{mr(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{mr(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.core.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(Ht({},i.params));const l=wr(ae.FIVE_MINUTES),o=Ht({id:s,pairingTopic:r,expiry:l},n);await this.setProposal(s,o),this.client.events.emit("session_proposal",{id:s,params:o})}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(jt(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const l=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const o=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});const d=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:d});const _=await this.client.core.crypto.generateSharedKey(o,d);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:_});const E=await this.client.core.relayer.subscribe(_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:r})}else Ot(i)&&(await this.client.proposal.delete(n,wt("USER_DISCONNECTED")),this.events.emit(et("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:l,controller:o,expiry:d,namespaces:_,requiredNamespaces:E}=i.params,S={topic:r,relay:l,expiry:d,namespaces:_,acknowledged:!0,requiredNamespaces:E,controller:o.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:o.publicKey,metadata:o.metadata}};await this.sendResult(i.id,r,!0),this.events.emit(et("session_connect"),{session:S})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;jt(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(et("session_approve",n),{})):Ot(i)&&(await this.client.session.delete(r,wt("USER_DISCONNECTED")),this.events.emit(et("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidUpdate(Ht({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;jt(i)?this.events.emit(et("session_update",n),{}):Ot(i)&&this.events.emit(et("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,wr(Fi)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;jt(i)?this.events.emit(et("session_extend",n),{}):Ot(i)&&this.events.emit(et("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{jt(i)?this.events.emit(et("session_ping",n),{}):Ot(i)&&this.events.emit(et("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await this.sendResult(n,r,!0),await this.deleteSession(r),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(Ht({topic:r},s)),await this.setPendingSessionRequest({id:n,topic:r,params:s}),this.client.events.emit("session_request",{id:n,topic:r,params:s})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;jt(i)?this.events.emit(et("session_request",n),{result:i.result}):Ot(i)&&this.events.emit(et("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidEmit(Ht({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.isValidConnect=async r=>{if(!At(r)){const{message:o}=le("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(o)}const{pairingTopic:i,requiredNamespaces:n,relays:s}=r;if(Pt(i)||await this.isValidPairingTopic(i),!Pt(n)&&Ri(n)===0)return;const l=Qy(n,"connect()");if(l)throw new Error(l.message);if(!e1(s,!0)){const{message:o}=le("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(o)}},this.isValidApprove=async r=>{if(!At(r))throw new Error(le("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s}=r;await this.isValidProposalId(i);const l=this.client.proposal.get(i),o=Pi(n,"approve()");if(o)throw new Error(o.message);const d=vc(l.requiredNamespaces,n,"update()");if(d)throw new Error(d.message);if(!ut(s,!0)){const{message:_}=le("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(_)}},this.isValidReject=async r=>{if(!At(r)){const{message:s}=le("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!r1(n)){const{message:s}=le("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!At(r)){const{message:_}=le("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(_)}const{relay:i,controller:n,namespaces:s,expiry:l}=r;if(!_c(i)){const{message:_}=le("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(_)}const o=Jy(n,"onSessionSettleRequest()");if(o)throw new Error(o.message);const d=Pi(s,"onSessionSettleRequest()");if(d)throw new Error(d.message);if(mr(l)){const{message:_}=le("EXPIRED","onSessionSettleRequest()");throw new Error(_)}},this.isValidUpdate=async r=>{if(!At(r)){const{message:d}=le("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(d)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),l=Pi(n,"update()");if(l)throw new Error(l.message);const o=vc(s.requiredNamespaces,n,"update()");if(o)throw new Error(o.message)},this.isValidExtend=async r=>{if(!At(r)){const{message:n}=le("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!At(r)){const{message:o}=le("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(o)}const{topic:i,request:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:l}=this.client.session.get(i);if(!Ec(l,s)){const{message:o}=le("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(o)}if(!i1(n)){const{message:o}=le("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(o)}if(!o1(l,s,n.method)){const{message:o}=le("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(o)}},this.isValidRespond=async r=>{if(!At(r)){const{message:s}=le("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!n1(n)){const{message:s}=le("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!At(r)){const{message:n}=le("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!At(r)){const{message:o}=le("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(o)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:l}=this.client.session.get(i);if(!Ec(l,s)){const{message:o}=le("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(o)}if(!s1(n)){const{message:o}=le("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(o)}if(!a1(l,s,n.name)){const{message:o}=le("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(o)}},this.isValidDisconnect=async r=>{if(!At(r)){const{message:n}=le("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(ft.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);jn(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Hn(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(vt.expired,async e=>{const{topic:r,id:i}=Hy(e.target);if(i&&this.getPendingSessionRequests()[i])return await this.deletePendingSessionRequest(i,le("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&await this.deleteProposal(i,!0)})}isValidPairingTopic(e){if(!ut(e,!1)){const{message:r}=le("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=le("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(mr(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=le("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!ut(e,!1)){const{message:r}=le("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=le("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(mr(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=le("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(ut(e,!1)){const{message:r}=le("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=le("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!t1(e)){const{message:r}=le("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=le("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(mr(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=le("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class m1 extends Ui{constructor(e,r){super(e,r,c1,Zn),this.core=e,this.logger=r}}class b1 extends Ui{constructor(e,r){super(e,r,u1,Zn),this.core=e,this.logger=r}}class _1 extends Ui{constructor(e,r){super(e,r,l1,Zn),this.core=e,this.logger=r}}class us extends Py{constructor(e){super(e),this.protocol=Dc,this.version=xc,this.name=Qn.name,this.events=new ot.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||Qn.name,this.metadata=e?.metadata||jy();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Ir(Oe.getDefaultLoggerOptions({level:e?.logger||Qn.logger}));this.core=e?.core||new Ry(e),this.logger=Oe.generateChildLogger(r,this.name),this.session=new b1(this.core,this.logger),this.proposal=new m1(this.core,this.logger),this.pendingRequest=new _1(this.core,this.logger),this.engine=new w1(this)}static async init(e){const r=new us(e);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initilization Success")}catch(e){throw this.logger.info("SignClient Initilization Failure"),this.logger.error(e.message),e}}}var ts={};Object.defineProperty(ts,"__esModule",{value:!0}),ts.getWindowMetadata=void 0;const Ac=Ce;function E1(){let t,e;try{t=Ac.getDocumentOrThrow(),e=Ac.getLocationOrThrow()}catch{return null}function r(){const S=t.getElementsByTagName("link"),N=[];for(let I=0;I<S.length;I++){const O=S[I],$=O.getAttribute("rel");if($&&$.toLowerCase().indexOf("icon")>-1){const F=O.getAttribute("href");if(F)if(F.toLowerCase().indexOf("https:")===-1&&F.toLowerCase().indexOf("http:")===-1&&F.indexOf("//")!==0){let H=e.protocol+"//"+e.host;if(F.indexOf("/")===0)H+=F;else{const f=e.pathname.split("/");f.pop();const w=f.join("/");H+=w+"/"+F}N.push(H)}else if(F.indexOf("//")===0){const H=e.protocol+F;N.push(H)}else N.push(F)}}return N}function i(...S){const N=t.getElementsByTagName("meta");for(let I=0;I<N.length;I++){const O=N[I],$=["itemprop","property","name"].map(F=>O.getAttribute(F)).filter(F=>F?S.includes(F):!1);if($.length&&$){const F=O.getAttribute("content");if(F)return F}}return""}function n(){let S=i("name","og:site_name","og:title","twitter:title");return S||(S=t.title),S}function s(){return i("description","og:description","twitter:description","keywords")}const l=n(),o=s(),d=e.origin,_=r();return{description:o,url:d,icons:_,name:l}}ts.getWindowMetadata=E1;var v1={},D1=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var l=i[s],o=t[l];(n?e.indexOf(l)!==-1:e(l,o,t))&&(r[l]=o)}return r};(function(t){const e=vn,r=xn,i=Sn,n=D1,s=f=>f==null,l=Symbol("encodeFragmentIdentifier");function o(f){switch(f.arrayFormat){case"index":return w=>(p,y)=>{const b=p.length;return y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,[E(w,f),"[",b,"]"].join("")]:[...p,[E(w,f),"[",E(b,f),"]=",E(y,f)].join("")]};case"bracket":return w=>(p,y)=>y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,[E(w,f),"[]"].join("")]:[...p,[E(w,f),"[]=",E(y,f)].join("")];case"colon-list-separator":return w=>(p,y)=>y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,[E(w,f),":list="].join("")]:[...p,[E(w,f),":list=",E(y,f)].join("")];case"comma":case"separator":case"bracket-separator":{const w=f.arrayFormat==="bracket-separator"?"[]=":"=";return p=>(y,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?y:(b=b===null?"":b,y.length===0?[[E(p,f),w,E(b,f)].join("")]:[[y,E(b,f)].join(f.arrayFormatSeparator)])}default:return w=>(p,y)=>y===void 0||f.skipNull&&y===null||f.skipEmptyString&&y===""?p:y===null?[...p,E(w,f)]:[...p,[E(w,f),"=",E(y,f)].join("")]}}function d(f){let w;switch(f.arrayFormat){case"index":return(p,y,b)=>{if(w=/\[(\d*)\]$/.exec(p),p=p.replace(/\[\d*\]$/,""),!w){b[p]=y;return}b[p]===void 0&&(b[p]={}),b[p][w[1]]=y};case"bracket":return(p,y,b)=>{if(w=/(\[\])$/.exec(p),p=p.replace(/\[\]$/,""),!w){b[p]=y;return}if(b[p]===void 0){b[p]=[y];return}b[p]=[].concat(b[p],y)};case"colon-list-separator":return(p,y,b)=>{if(w=/(:list)$/.exec(p),p=p.replace(/:list$/,""),!w){b[p]=y;return}if(b[p]===void 0){b[p]=[y];return}b[p]=[].concat(b[p],y)};case"comma":case"separator":return(p,y,b)=>{const a=typeof y=="string"&&y.includes(f.arrayFormatSeparator),m=typeof y=="string"&&!a&&S(y,f).includes(f.arrayFormatSeparator);y=m?S(y,f):y;const M=a||m?y.split(f.arrayFormatSeparator).map(z=>S(z,f)):y===null?y:S(y,f);b[p]=M};case"bracket-separator":return(p,y,b)=>{const a=/(\[\])$/.test(p);if(p=p.replace(/\[\]$/,""),!a){b[p]=y&&S(y,f);return}const m=y===null?[]:y.split(f.arrayFormatSeparator).map(M=>S(M,f));if(b[p]===void 0){b[p]=m;return}b[p]=[].concat(b[p],m)};default:return(p,y,b)=>{if(b[p]===void 0){b[p]=y;return}b[p]=[].concat(b[p],y)}}}function _(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(f,w){return w.encode?w.strict?e(f):encodeURIComponent(f):f}function S(f,w){return w.decode?r(f):f}function N(f){return Array.isArray(f)?f.sort():typeof f=="object"?N(Object.keys(f)).sort((w,p)=>Number(w)-Number(p)).map(w=>f[w]):f}function I(f){const w=f.indexOf("#");return w!==-1&&(f=f.slice(0,w)),f}function O(f){let w="";const p=f.indexOf("#");return p!==-1&&(w=f.slice(p)),w}function $(f){f=I(f);const w=f.indexOf("?");return w===-1?"":f.slice(w+1)}function F(f,w){return w.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):w.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function H(f,w){w=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},w),_(w.arrayFormatSeparator);const p=d(w),y=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return y;for(const b of f.split("&")){if(b==="")continue;let[a,m]=i(w.decode?b.replace(/\+/g," "):b,"=");m=m===void 0?null:["comma","separator","bracket-separator"].includes(w.arrayFormat)?m:S(m,w),p(S(a,w),m,y)}for(const b of Object.keys(y)){const a=y[b];if(typeof a=="object"&&a!==null)for(const m of Object.keys(a))a[m]=F(a[m],w);else y[b]=F(a,w)}return w.sort===!1?y:(w.sort===!0?Object.keys(y).sort():Object.keys(y).sort(w.sort)).reduce((b,a)=>{const m=y[a];return Boolean(m)&&typeof m=="object"&&!Array.isArray(m)?b[a]=N(m):b[a]=m,b},Object.create(null))}t.extract=$,t.parse=H,t.stringify=(f,w)=>{if(!f)return"";w=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},w),_(w.arrayFormatSeparator);const p=m=>w.skipNull&&s(f[m])||w.skipEmptyString&&f[m]==="",y=o(w),b={};for(const m of Object.keys(f))p(m)||(b[m]=f[m]);const a=Object.keys(b);return w.sort!==!1&&a.sort(w.sort),a.map(m=>{const M=f[m];return M===void 0?"":M===null?E(m,w):Array.isArray(M)?M.length===0&&w.arrayFormat==="bracket-separator"?E(m,w)+"[]":M.reduce(y(m),[]).join("&"):E(m,w)+"="+E(M,w)}).filter(m=>m.length>0).join("&")},t.parseUrl=(f,w)=>{w=Object.assign({decode:!0},w);const[p,y]=i(f,"#");return Object.assign({url:p.split("?")[0]||"",query:H($(f),w)},w&&w.parseFragmentIdentifier&&y?{fragmentIdentifier:S(y,w)}:{})},t.stringifyUrl=(f,w)=>{w=Object.assign({encode:!0,strict:!0,[l]:!0},w);const p=I(f.url).split("?")[0]||"",y=t.extract(f.url),b=t.parse(y,{sort:!1}),a=Object.assign(b,f.query);let m=t.stringify(a,w);m&&(m=`?${m}`);let M=O(f.url);return f.fragmentIdentifier&&(M=`#${w[l]?E(f.fragmentIdentifier,w):f.fragmentIdentifier}`),`${p}${m}${M}`},t.pick=(f,w,p)=>{p=Object.assign({parseFragmentIdentifier:!0,[l]:!1},p);const{url:y,query:b,fragmentIdentifier:a}=t.parseUrl(f,p);return t.stringifyUrl({url:y,query:n(b,w),fragmentIdentifier:a},p)},t.exclude=(f,w,p)=>{const y=Array.isArray(w)?b=>!w.includes(b):(b,a)=>!w(b,a);return t.pick(f,y,p)}})(v1);const x1={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Cc(t,e){const{message:r,code:i}=x1[t];return{message:e?`${r} ${e}`:r,code:i}}function S1(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}var rs={exports:{}};(function(t,e){var r=typeof self<"u"?self:ht,i=function(){function s(){this.fetch=!1,this.DOMException=r.DOMException}return s.prototype=r,new s}();(function(s){(function(l){var o={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function d(D){return D&&DataView.prototype.isPrototypeOf(D)}if(o.arrayBuffer)var _=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(D){return D&&_.indexOf(Object.prototype.toString.call(D))>-1};function S(D){if(typeof D!="string"&&(D=String(D)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(D))throw new TypeError("Invalid character in header field name");return D.toLowerCase()}function N(D){return typeof D!="string"&&(D=String(D)),D}function I(D){var A={next:function(){var k=D.shift();return{done:k===void 0,value:k}}};return o.iterable&&(A[Symbol.iterator]=function(){return A}),A}function O(D){this.map={},D instanceof O?D.forEach(function(A,k){this.append(k,A)},this):Array.isArray(D)?D.forEach(function(A){this.append(A[0],A[1])},this):D&&Object.getOwnPropertyNames(D).forEach(function(A){this.append(A,D[A])},this)}O.prototype.append=function(D,A){D=S(D),A=N(A);var k=this.map[D];this.map[D]=k?k+", "+A:A},O.prototype.delete=function(D){delete this.map[S(D)]},O.prototype.get=function(D){return D=S(D),this.has(D)?this.map[D]:null},O.prototype.has=function(D){return this.map.hasOwnProperty(S(D))},O.prototype.set=function(D,A){this.map[S(D)]=N(A)},O.prototype.forEach=function(D,A){for(var k in this.map)this.map.hasOwnProperty(k)&&D.call(A,this.map[k],k,this)},O.prototype.keys=function(){var D=[];return this.forEach(function(A,k){D.push(k)}),I(D)},O.prototype.values=function(){var D=[];return this.forEach(function(A){D.push(A)}),I(D)},O.prototype.entries=function(){var D=[];return this.forEach(function(A,k){D.push([k,A])}),I(D)},o.iterable&&(O.prototype[Symbol.iterator]=O.prototype.entries);function $(D){if(D.bodyUsed)return Promise.reject(new TypeError("Already read"));D.bodyUsed=!0}function F(D){return new Promise(function(A,k){D.onload=function(){A(D.result)},D.onerror=function(){k(D.error)}})}function H(D){var A=new FileReader,k=F(A);return A.readAsArrayBuffer(D),k}function f(D){var A=new FileReader,k=F(A);return A.readAsText(D),k}function w(D){for(var A=new Uint8Array(D),k=new Array(A.length),V=0;V<A.length;V++)k[V]=String.fromCharCode(A[V]);return k.join("")}function p(D){if(D.slice)return D.slice(0);var A=new Uint8Array(D.byteLength);return A.set(new Uint8Array(D)),A.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(D){this._bodyInit=D,D?typeof D=="string"?this._bodyText=D:o.blob&&Blob.prototype.isPrototypeOf(D)?this._bodyBlob=D:o.formData&&FormData.prototype.isPrototypeOf(D)?this._bodyFormData=D:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(D)?this._bodyText=D.toString():o.arrayBuffer&&o.blob&&d(D)?(this._bodyArrayBuffer=p(D.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(D)||E(D))?this._bodyArrayBuffer=p(D):this._bodyText=D=Object.prototype.toString.call(D):this._bodyText="",this.headers.get("content-type")||(typeof D=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(D)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var D=$(this);if(D)return D;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?$(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(H)}),this.text=function(){var D=$(this);if(D)return D;if(this._bodyBlob)return f(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(w(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function a(D){var A=D.toUpperCase();return b.indexOf(A)>-1?A:D}function m(D,A){A=A||{};var k=A.body;if(D instanceof m){if(D.bodyUsed)throw new TypeError("Already read");this.url=D.url,this.credentials=D.credentials,A.headers||(this.headers=new O(D.headers)),this.method=D.method,this.mode=D.mode,this.signal=D.signal,!k&&D._bodyInit!=null&&(k=D._bodyInit,D.bodyUsed=!0)}else this.url=String(D);if(this.credentials=A.credentials||this.credentials||"same-origin",(A.headers||!this.headers)&&(this.headers=new O(A.headers)),this.method=a(A.method||this.method||"GET"),this.mode=A.mode||this.mode||null,this.signal=A.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&k)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(k)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};function M(D){var A=new FormData;return D.trim().split("&").forEach(function(k){if(k){var V=k.split("="),K=V.shift().replace(/\+/g," "),q=V.join("=").replace(/\+/g," ");A.append(decodeURIComponent(K),decodeURIComponent(q))}}),A}function z(D){var A=new O,k=D.replace(/\r?\n[\t ]+/g," ");return k.split(/\r?\n/).forEach(function(V){var K=V.split(":"),q=K.shift().trim();if(q){var J=K.join(":").trim();A.append(q,J)}}),A}y.call(m.prototype);function W(D,A){A||(A={}),this.type="default",this.status=A.status===void 0?200:A.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in A?A.statusText:"OK",this.headers=new O(A.headers),this.url=A.url||"",this._initBody(D)}y.call(W.prototype),W.prototype.clone=function(){return new W(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new O(this.headers),url:this.url})},W.error=function(){var D=new W(null,{status:0,statusText:""});return D.type="error",D};var ee=[301,302,303,307,308];W.redirect=function(D,A){if(ee.indexOf(A)===-1)throw new RangeError("Invalid status code");return new W(null,{status:A,headers:{location:D}})},l.DOMException=s.DOMException;try{new l.DOMException}catch{l.DOMException=function(A,k){this.message=A,this.name=k;var V=Error(A);this.stack=V.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function re(D,A){return new Promise(function(k,V){var K=new m(D,A);if(K.signal&&K.signal.aborted)return V(new l.DOMException("Aborted","AbortError"));var q=new XMLHttpRequest;function J(){q.abort()}q.onload=function(){var G={status:q.status,statusText:q.statusText,headers:z(q.getAllResponseHeaders()||"")};G.url="responseURL"in q?q.responseURL:G.headers.get("X-Request-URL");var se="response"in q?q.response:q.responseText;k(new W(se,G))},q.onerror=function(){V(new TypeError("Network request failed"))},q.ontimeout=function(){V(new TypeError("Network request failed"))},q.onabort=function(){V(new l.DOMException("Aborted","AbortError"))},q.open(K.method,K.url,!0),K.credentials==="include"?q.withCredentials=!0:K.credentials==="omit"&&(q.withCredentials=!1),"responseType"in q&&o.blob&&(q.responseType="blob"),K.headers.forEach(function(G,se){q.setRequestHeader(se,G)}),K.signal&&(K.signal.addEventListener("abort",J),q.onreadystatechange=function(){q.readyState===4&&K.signal.removeEventListener("abort",J)}),q.send(typeof K._bodyInit>"u"?null:K._bodyInit)})}return re.polyfill=!0,s.fetch||(s.fetch=re,s.Headers=O,s.Request=m,s.Response=W),l.Headers=O,l.Request=m,l.Response=W,l.fetch=re,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var n=i;e=n.fetch,e.default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,t.exports=e})(rs,rs.exports);var Tc=$u(rs.exports);const I1={Accept:"application/json","Content-Type":"application/json"},O1="POST",Nc={headers:I1,method:O1},Uc=10;class Rc{constructor(e){if(this.url=e,this.events=new ot.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Ua(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const i=$r(e),s=await(await Tc(this.url,Object.assign(Object.assign({},Nc),{body:i}))).json();this.onPayload({data:s})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!Ua(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{const r=$r({id:1,jsonrpc:"2.0",method:"test",params:[]});await Tc(e,Object.assign(Object.assign({},Nc),{body:r})),this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?rn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Ai(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Oa(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Uc&&this.events.setMaxListeners(Uc)}}function A1(t){var e;const r=(e=t[Object.keys(t)[0]])==null?void 0:e.chains[0];return[r.split(":")[0],r.split(":")[1]]}function Li(t,e){let r;return e.rpcMap&&(r=e.rpcMap[C1([t])]),r}function C1(t){return Number(t[0].split(":")[1])}class T1{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=this.getDefaultChainId()}async request(e){var r;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":{const i=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";return this.setDefaultChain(parseInt(i,16).toString()),null}case"eth_chainId":return this.getDefaultChainId()}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){if(this.chainId=parseInt(e),!this.httpProviders[e]){const i=r||Li(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}createHttpProvider(e,r){const i=r||Li(e,this.namespace);return typeof i>"u"?void 0:new zn(new Rc(i))}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return parseInt(e.split(":")[1])}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}}class N1{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||Li(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Li(e,this.namespace);return typeof i>"u"?void 0:new zn(new Rc(i))}}const Pc="error",U1="wss://relay.walletconnect.com",R1="wc",P1="universal_provider",Fc=`${R1}@${2}:${P1}:`;var F1=Object.defineProperty,L1=Object.defineProperties,M1=Object.getOwnPropertyDescriptors,Lc=Object.getOwnPropertySymbols,B1=Object.prototype.hasOwnProperty,$1=Object.prototype.propertyIsEnumerable,Mc=(t,e,r)=>e in t?F1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Bc=(t,e)=>{for(var r in e||(e={}))B1.call(e,r)&&Mc(t,r,e[r]);if(Lc)for(var r of Lc(e))$1.call(e,r)&&Mc(t,r,e[r]);return t},j1=(t,e)=>L1(t,M1(e));class hs{constructor(e){this.events=new ot.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Ir(Oe.getDefaultLoggerOptions({level:e?.logger||Pc}))}static async init(e){const r=new hs(e);return await r.initialize(),r}async request(e,r){var i;const[n,s]=this.validateChain(r);return await this.getProvider(n).request({request:Bc({},e),chainId:`${n}:${s}`,topic:(i=this.session)==null?void 0:i.topic})}sendAsync(e,r,i){this.request(e,i).then(n=>r(null,n)).catch(n=>r(n,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return await this.request({method:"eth_requestAccounts",params:[]})}async disconnect(){if(!this.client)throw new Error("Sign Client not initialized");await this.client.disconnect({topic:this.session.topic,reason:Cc("USER_DISCONNECTED")})}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");return this.setNamespaces(e.namespaces),this.createProviders(),this.cleanupPendingPairings(),e.skipPairing===!0?void 0:await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces});return r&&(this.uri=r,this.events.emit("display_uri",r)),this.session=await i(),this.onSessionUpdate(),this.session}setDefaultChain(e,r){try{const[i,n]=this.validateChain(e);this.getProvider(i).setDefaultChain(n,r)}catch(i){if(!/Please call connect/.test(i.message))throw i}}cleanupPendingPairings(){this.logger.info("Cleaning up inactive pairings...");const e=this.client.pairing.getAll({active:!1});!S1(e)||(e.forEach(r=>{this.client.pairing.delete(r.topic,Cc("USER_DISCONNECTED"))}),this.logger.info(`Inactive pairings cleared: ${e.length}`))}async checkStorage(){if(this.namespaces=await this.client.core.storage.getItem(`${Fc}/namespaces`)||{},this.namespaces&&this.createProviders(),this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.onSessionUpdate()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await us.init({logger:this.providerOpts.logger||Pc,relayUrl:this.providerOpts.relayUrl||U1,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{switch(e){case"eip155":this.rpcProviders[e]=new T1({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"solana":this.rpcProviders[e]=new N1({client:this.client,namespace:this.namespaces[e],events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var i;const{namespaces:n}=r,s=(i=this.client)==null?void 0:i.session.get(e);this.session=j1(Bc({},s),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",()=>{this.events.emit("session_delete")})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>this.getProvider(e).updateNamespace(this.session.namespaces[e]))}setNamespaces(e){if(!e||!Object.keys(e).length)throw new Error("Namespaces must be not empty");this.client.core.storage.setItem(`${Fc}/namespaces`,e),this.namespaces=e}validateChain(e){const[r,i]=e?.split(":")||["",""];if(r&&!Object.keys(this.namespaces).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);return!r||!i?A1(this.namespaces):[r,i]}}const H1=Symbol(),$c=Object.getPrototypeOf,is=new WeakMap,z1=t=>t&&(is.has(t)?is.get(t):$c(t)===Object.prototype||$c(t)===Array.prototype),q1=t=>z1(t)&&t[H1]||null,jc=(t,e=!0)=>{is.set(t,e)},ns=t=>typeof t=="object"&&t!==null,sr=new WeakMap,ss=new WeakSet,K1=(t=Object.is,e=(_,E)=>new Proxy(_,E),r=_=>ns(_)&&!ss.has(_)&&(Array.isArray(_)||!(Symbol.iterator in _))&&!(_ instanceof WeakMap)&&!(_ instanceof WeakSet)&&!(_ instanceof Error)&&!(_ instanceof Number)&&!(_ instanceof Date)&&!(_ instanceof String)&&!(_ instanceof RegExp)&&!(_ instanceof ArrayBuffer),i=_=>{switch(_.status){case"fulfilled":return _.value;case"rejected":throw _.reason;default:throw _}},n=new WeakMap,s=(_,E,S=i)=>{const N=n.get(_);if(N?.[0]===E)return N[1];const I=Array.isArray(_)?[]:Object.create(Object.getPrototypeOf(_));return jc(I,!0),n.set(_,[E,I]),Reflect.ownKeys(_).forEach(O=>{const $=Reflect.get(_,O);ss.has($)?(jc($,!1),I[O]=$):$ instanceof Promise?Object.defineProperty(I,O,{get(){return S($)}}):sr.has($)?I[O]=k1($,S):I[O]=$}),Object.freeze(I)},l=new WeakMap,o=[1,1],d=_=>{if(!ns(_))throw new Error("object required");const E=l.get(_);if(E)return E;let S=o[0];const N=new Set,I=(M,z=++o[0])=>{S!==z&&(S=z,N.forEach(W=>W(M,z)))};let O=o[1];const $=(M=++o[1])=>(O!==M&&!N.size&&(O=M,H.forEach(([z])=>{const W=z[1](M);W>S&&(S=W)})),S),F=M=>(z,W)=>{const ee=[...z];ee[1]=[M,...ee[1]],I(ee,W)},H=new Map,f=(M,z)=>{if(void 0!=="production"&&H.has(M))throw new Error("prop listener already exists");if(N.size){const W=z[3](F(M));H.set(M,[z,W])}else H.set(M,[z])},w=M=>{var z;const W=H.get(M);W&&(H.delete(M),(z=W[1])==null||z.call(W))},p=M=>(N.add(M),N.size===1&&H.forEach(([W,ee],re)=>{if(void 0!=="production"&&ee)throw new Error("remove already exists");const D=W[3](F(re));H.set(re,[W,D])}),()=>{N.delete(M),N.size===0&&H.forEach(([W,ee],re)=>{ee&&(ee(),H.set(re,[W]))})}),y=Array.isArray(_)?[]:Object.create(Object.getPrototypeOf(_)),a=e(y,{deleteProperty(M,z){const W=Reflect.get(M,z);w(z);const ee=Reflect.deleteProperty(M,z);return ee&&I(["delete",[z],W]),ee},set(M,z,W,ee){var re;const D=Reflect.has(M,z),A=Reflect.get(M,z,ee);if(D&&t(A,W))return!0;w(z),ns(W)&&(W=q1(W)||W);let k=W;if(!((re=Object.getOwnPropertyDescriptor(M,z))!=null&&re.set))if(W instanceof Promise)W.then(V=>{W.status="fulfilled",W.value=V,I(["resolve",[z],V])}).catch(V=>{W.status="rejected",W.reason=V,I(["reject",[z],V])});else{!sr.has(W)&&r(W)&&(k=Wt(W));const V=sr.get(k);V&&f(z,V)}return Reflect.set(M,z,k,ee),I(["set",[z],W,A]),!0}});l.set(_,a);const m=[y,$,s,p];return sr.set(a,m),Reflect.ownKeys(_).forEach(M=>{const z=Object.getOwnPropertyDescriptor(_,M);z.get||z.set?Object.defineProperty(y,M,z):a[M]=_[M]}),a})=>[d,sr,ss,t,e,r,i,n,s,l,o],[V1]=K1();function Wt(t={}){return V1(t)}function Xr(t,e,r){const i=sr.get(t);void 0!=="production"&&!i&&console.warn("Please use proxy object");let n;const s=[],l=i[3];let o=!1;const _=l(E=>{if(s.push(E),r){e(s.splice(0));return}n||(n=Promise.resolve().then(()=>{n=void 0,o&&e(s.splice(0))}))});return o=!0,()=>{o=!1,_()}}function k1(t,e){const r=sr.get(t);void 0!=="production"&&!r&&console.warn("Please use proxy object");const[i,n,s]=r;return s(i,n(),e)}var Hc={},Mi={};Mi.byteLength=Y1,Mi.toByteArray=X1,Mi.fromByteArray=ew;for(var Ft=[],Dt=[],W1=typeof Uint8Array<"u"?Uint8Array:Array,os="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_r=0,G1=os.length;_r<G1;++_r)Ft[_r]=os[_r],Dt[os.charCodeAt(_r)]=_r;Dt["-".charCodeAt(0)]=62,Dt["_".charCodeAt(0)]=63;function zc(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var i=r===e?0:4-r%4;return[r,i]}function Y1(t){var e=zc(t),r=e[0],i=e[1];return(r+i)*3/4-i}function J1(t,e,r){return(e+r)*3/4-r}function X1(t){var e,r=zc(t),i=r[0],n=r[1],s=new W1(J1(t,i,n)),l=0,o=n>0?i-4:i,d;for(d=0;d<o;d+=4)e=Dt[t.charCodeAt(d)]<<18|Dt[t.charCodeAt(d+1)]<<12|Dt[t.charCodeAt(d+2)]<<6|Dt[t.charCodeAt(d+3)],s[l++]=e>>16&255,s[l++]=e>>8&255,s[l++]=e&255;return n===2&&(e=Dt[t.charCodeAt(d)]<<2|Dt[t.charCodeAt(d+1)]>>4,s[l++]=e&255),n===1&&(e=Dt[t.charCodeAt(d)]<<10|Dt[t.charCodeAt(d+1)]<<4|Dt[t.charCodeAt(d+2)]>>2,s[l++]=e>>8&255,s[l++]=e&255),s}function Z1(t){return Ft[t>>18&63]+Ft[t>>12&63]+Ft[t>>6&63]+Ft[t&63]}function Q1(t,e,r){for(var i,n=[],s=e;s<r;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),n.push(Z1(i));return n.join("")}function ew(t){for(var e,r=t.length,i=r%3,n=[],s=16383,l=0,o=r-i;l<o;l+=s)n.push(Q1(t,l,l+s>o?o:l+s));return i===1?(e=t[r-1],n.push(Ft[e>>2]+Ft[e<<4&63]+"==")):i===2&&(e=(t[r-2]<<8)+t[r-1],n.push(Ft[e>>10]+Ft[e>>4&63]+Ft[e<<2&63]+"=")),n.join("")}var as={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */as.read=function(t,e,r,i,n){var s,l,o=n*8-i-1,d=(1<<o)-1,_=d>>1,E=-7,S=r?n-1:0,N=r?-1:1,I=t[e+S];for(S+=N,s=I&(1<<-E)-1,I>>=-E,E+=o;E>0;s=s*256+t[e+S],S+=N,E-=8);for(l=s&(1<<-E)-1,s>>=-E,E+=i;E>0;l=l*256+t[e+S],S+=N,E-=8);if(s===0)s=1-_;else{if(s===d)return l?NaN:(I?-1:1)*(1/0);l=l+Math.pow(2,i),s=s-_}return(I?-1:1)*l*Math.pow(2,s-i)},as.write=function(t,e,r,i,n,s){var l,o,d,_=s*8-n-1,E=(1<<_)-1,S=E>>1,N=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=i?0:s-1,O=i?1:-1,$=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,l=E):(l=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-l))<1&&(l--,d*=2),l+S>=1?e+=N/d:e+=N*Math.pow(2,1-S),e*d>=2&&(l++,d/=2),l+S>=E?(o=0,l=E):l+S>=1?(o=(e*d-1)*Math.pow(2,n),l=l+S):(o=e*Math.pow(2,S-1)*Math.pow(2,n),l=0));n>=8;t[r+I]=o&255,I+=O,o/=256,n-=8);for(l=l<<n|o,_+=n;_>0;t[r+I]=l&255,I+=O,l/=256,_-=8);t[r+I-O]|=$*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=Mi,r=as,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=f,t.INSPECT_MAX_BYTES=50;const n=2147483647;t.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=s(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const g=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(g,c),g.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.byteOffset}});function l(g){if(g>n)throw new RangeError('The value "'+g+'" is invalid for option "size"');const c=new Uint8Array(g);return Object.setPrototypeOf(c,o.prototype),c}function o(g,c,u){if(typeof g=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return S(g)}return d(g,c,u)}o.poolSize=8192;function d(g,c,u){if(typeof g=="string")return N(g,c);if(ArrayBuffer.isView(g))return O(g);if(g==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);if(he(g,ArrayBuffer)||g&&he(g.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(he(g,SharedArrayBuffer)||g&&he(g.buffer,SharedArrayBuffer)))return $(g,c,u);if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const v=g.valueOf&&g.valueOf();if(v!=null&&v!==g)return o.from(v,c,u);const T=F(g);if(T)return T;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof g[Symbol.toPrimitive]=="function")return o.from(g[Symbol.toPrimitive]("string"),c,u);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g)}o.from=function(g,c,u){return d(g,c,u)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function _(g){if(typeof g!="number")throw new TypeError('"size" argument must be of type number');if(g<0)throw new RangeError('The value "'+g+'" is invalid for option "size"')}function E(g,c,u){return _(g),g<=0?l(g):c!==void 0?typeof u=="string"?l(g).fill(c,u):l(g).fill(c):l(g)}o.alloc=function(g,c,u){return E(g,c,u)};function S(g){return _(g),l(g<0?0:H(g)|0)}o.allocUnsafe=function(g){return S(g)},o.allocUnsafeSlow=function(g){return S(g)};function N(g,c){if((typeof c!="string"||c==="")&&(c="utf8"),!o.isEncoding(c))throw new TypeError("Unknown encoding: "+c);const u=w(g,c)|0;let v=l(u);const T=v.write(g,c);return T!==u&&(v=v.slice(0,T)),v}function I(g){const c=g.length<0?0:H(g.length)|0,u=l(c);for(let v=0;v<c;v+=1)u[v]=g[v]&255;return u}function O(g){if(he(g,Uint8Array)){const c=new Uint8Array(g);return $(c.buffer,c.byteOffset,c.byteLength)}return I(g)}function $(g,c,u){if(c<0||g.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(g.byteLength<c+(u||0))throw new RangeError('"length" is outside of buffer bounds');let v;return c===void 0&&u===void 0?v=new Uint8Array(g):u===void 0?v=new Uint8Array(g,c):v=new Uint8Array(g,c,u),Object.setPrototypeOf(v,o.prototype),v}function F(g){if(o.isBuffer(g)){const c=H(g.length)|0,u=l(c);return u.length===0||g.copy(u,0,0,c),u}if(g.length!==void 0)return typeof g.length!="number"||ye(g.length)?l(0):I(g);if(g.type==="Buffer"&&Array.isArray(g.data))return I(g.data)}function H(g){if(g>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return g|0}function f(g){return+g!=g&&(g=0),o.alloc(+g)}o.isBuffer=function(c){return c!=null&&c._isBuffer===!0&&c!==o.prototype},o.compare=function(c,u){if(he(c,Uint8Array)&&(c=o.from(c,c.offset,c.byteLength)),he(u,Uint8Array)&&(u=o.from(u,u.offset,u.byteLength)),!o.isBuffer(c)||!o.isBuffer(u))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(c===u)return 0;let v=c.length,T=u.length;for(let P=0,j=Math.min(v,T);P<j;++P)if(c[P]!==u[P]){v=c[P],T=u[P];break}return v<T?-1:T<v?1:0},o.isEncoding=function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(c,u){if(!Array.isArray(c))throw new TypeError('"list" argument must be an Array of Buffers');if(c.length===0)return o.alloc(0);let v;if(u===void 0)for(u=0,v=0;v<c.length;++v)u+=c[v].length;const T=o.allocUnsafe(u);let P=0;for(v=0;v<c.length;++v){let j=c[v];if(he(j,Uint8Array))P+j.length>T.length?(o.isBuffer(j)||(j=o.from(j)),j.copy(T,P)):Uint8Array.prototype.set.call(T,j,P);else if(o.isBuffer(j))j.copy(T,P);else throw new TypeError('"list" argument must be an Array of Buffers');P+=j.length}return T};function w(g,c){if(o.isBuffer(g))return g.length;if(ArrayBuffer.isView(g)||he(g,ArrayBuffer))return g.byteLength;if(typeof g!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof g);const u=g.length,v=arguments.length>2&&arguments[2]===!0;if(!v&&u===0)return 0;let T=!1;for(;;)switch(c){case"ascii":case"latin1":case"binary":return u;case"utf8":case"utf-8":return Se(g).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u*2;case"hex":return u>>>1;case"base64":return Ee(g).length;default:if(T)return v?-1:Se(g).length;c=(""+c).toLowerCase(),T=!0}}o.byteLength=w;function p(g,c,u){let v=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((u===void 0||u>this.length)&&(u=this.length),u<=0)||(u>>>=0,c>>>=0,u<=c))return"";for(g||(g="utf8");;)switch(g){case"hex":return q(this,c,u);case"utf8":case"utf-8":return D(this,c,u);case"ascii":return V(this,c,u);case"latin1":case"binary":return K(this,c,u);case"base64":return re(this,c,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,c,u);default:if(v)throw new TypeError("Unknown encoding: "+g);g=(g+"").toLowerCase(),v=!0}}o.prototype._isBuffer=!0;function y(g,c,u){const v=g[c];g[c]=g[u],g[u]=v}o.prototype.swap16=function(){const c=this.length;if(c%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let u=0;u<c;u+=2)y(this,u,u+1);return this},o.prototype.swap32=function(){const c=this.length;if(c%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let u=0;u<c;u+=4)y(this,u,u+3),y(this,u+1,u+2);return this},o.prototype.swap64=function(){const c=this.length;if(c%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let u=0;u<c;u+=8)y(this,u,u+7),y(this,u+1,u+6),y(this,u+2,u+5),y(this,u+3,u+4);return this},o.prototype.toString=function(){const c=this.length;return c===0?"":arguments.length===0?D(this,0,c):p.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(c){if(!o.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:o.compare(this,c)===0},o.prototype.inspect=function(){let c="";const u=t.INSPECT_MAX_BYTES;return c=this.toString("hex",0,u).replace(/(.{2})/g,"$1 ").trim(),this.length>u&&(c+=" ... "),"<Buffer "+c+">"},i&&(o.prototype[i]=o.prototype.inspect),o.prototype.compare=function(c,u,v,T,P){if(he(c,Uint8Array)&&(c=o.from(c,c.offset,c.byteLength)),!o.isBuffer(c))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof c);if(u===void 0&&(u=0),v===void 0&&(v=c?c.length:0),T===void 0&&(T=0),P===void 0&&(P=this.length),u<0||v>c.length||T<0||P>this.length)throw new RangeError("out of range index");if(T>=P&&u>=v)return 0;if(T>=P)return-1;if(u>=v)return 1;if(u>>>=0,v>>>=0,T>>>=0,P>>>=0,this===c)return 0;let j=P-T,te=v-u;const oe=Math.min(j,te),ve=this.slice(T,P),Ie=c.slice(u,v);for(let De=0;De<oe;++De)if(ve[De]!==Ie[De]){j=ve[De],te=Ie[De];break}return j<te?-1:te<j?1:0};function b(g,c,u,v,T){if(g.length===0)return-1;if(typeof u=="string"?(v=u,u=0):u>2147483647?u=2147483647:u<-2147483648&&(u=-2147483648),u=+u,ye(u)&&(u=T?0:g.length-1),u<0&&(u=g.length+u),u>=g.length){if(T)return-1;u=g.length-1}else if(u<0)if(T)u=0;else return-1;if(typeof c=="string"&&(c=o.from(c,v)),o.isBuffer(c))return c.length===0?-1:a(g,c,u,v,T);if(typeof c=="number")return c=c&255,typeof Uint8Array.prototype.indexOf=="function"?T?Uint8Array.prototype.indexOf.call(g,c,u):Uint8Array.prototype.lastIndexOf.call(g,c,u):a(g,[c],u,v,T);throw new TypeError("val must be string, number or Buffer")}function a(g,c,u,v,T){let P=1,j=g.length,te=c.length;if(v!==void 0&&(v=String(v).toLowerCase(),v==="ucs2"||v==="ucs-2"||v==="utf16le"||v==="utf-16le")){if(g.length<2||c.length<2)return-1;P=2,j/=2,te/=2,u/=2}function oe(Ie,De){return P===1?Ie[De]:Ie.readUInt16BE(De*P)}let ve;if(T){let Ie=-1;for(ve=u;ve<j;ve++)if(oe(g,ve)===oe(c,Ie===-1?0:ve-Ie)){if(Ie===-1&&(Ie=ve),ve-Ie+1===te)return Ie*P}else Ie!==-1&&(ve-=ve-Ie),Ie=-1}else for(u+te>j&&(u=j-te),ve=u;ve>=0;ve--){let Ie=!0;for(let De=0;De<te;De++)if(oe(g,ve+De)!==oe(c,De)){Ie=!1;break}if(Ie)return ve}return-1}o.prototype.includes=function(c,u,v){return this.indexOf(c,u,v)!==-1},o.prototype.indexOf=function(c,u,v){return b(this,c,u,v,!0)},o.prototype.lastIndexOf=function(c,u,v){return b(this,c,u,v,!1)};function m(g,c,u,v){u=Number(u)||0;const T=g.length-u;v?(v=Number(v),v>T&&(v=T)):v=T;const P=c.length;v>P/2&&(v=P/2);let j;for(j=0;j<v;++j){const te=parseInt(c.substr(j*2,2),16);if(ye(te))return j;g[u+j]=te}return j}function M(g,c,u,v){return me(Se(c,g.length-u),g,u,v)}function z(g,c,u,v){return me(Fe(c),g,u,v)}function W(g,c,u,v){return me(Ee(c),g,u,v)}function ee(g,c,u,v){return me(Re(c,g.length-u),g,u,v)}o.prototype.write=function(c,u,v,T){if(u===void 0)T="utf8",v=this.length,u=0;else if(v===void 0&&typeof u=="string")T=u,v=this.length,u=0;else if(isFinite(u))u=u>>>0,isFinite(v)?(v=v>>>0,T===void 0&&(T="utf8")):(T=v,v=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const P=this.length-u;if((v===void 0||v>P)&&(v=P),c.length>0&&(v<0||u<0)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");T||(T="utf8");let j=!1;for(;;)switch(T){case"hex":return m(this,c,u,v);case"utf8":case"utf-8":return M(this,c,u,v);case"ascii":case"latin1":case"binary":return z(this,c,u,v);case"base64":return W(this,c,u,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ee(this,c,u,v);default:if(j)throw new TypeError("Unknown encoding: "+T);T=(""+T).toLowerCase(),j=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function re(g,c,u){return c===0&&u===g.length?e.fromByteArray(g):e.fromByteArray(g.slice(c,u))}function D(g,c,u){u=Math.min(g.length,u);const v=[];let T=c;for(;T<u;){const P=g[T];let j=null,te=P>239?4:P>223?3:P>191?2:1;if(T+te<=u){let oe,ve,Ie,De;switch(te){case 1:P<128&&(j=P);break;case 2:oe=g[T+1],(oe&192)===128&&(De=(P&31)<<6|oe&63,De>127&&(j=De));break;case 3:oe=g[T+1],ve=g[T+2],(oe&192)===128&&(ve&192)===128&&(De=(P&15)<<12|(oe&63)<<6|ve&63,De>2047&&(De<55296||De>57343)&&(j=De));break;case 4:oe=g[T+1],ve=g[T+2],Ie=g[T+3],(oe&192)===128&&(ve&192)===128&&(Ie&192)===128&&(De=(P&15)<<18|(oe&63)<<12|(ve&63)<<6|Ie&63,De>65535&&De<1114112&&(j=De))}}j===null?(j=65533,te=1):j>65535&&(j-=65536,v.push(j>>>10&1023|55296),j=56320|j&1023),v.push(j),T+=te}return k(v)}const A=4096;function k(g){const c=g.length;if(c<=A)return String.fromCharCode.apply(String,g);let u="",v=0;for(;v<c;)u+=String.fromCharCode.apply(String,g.slice(v,v+=A));return u}function V(g,c,u){let v="";u=Math.min(g.length,u);for(let T=c;T<u;++T)v+=String.fromCharCode(g[T]&127);return v}function K(g,c,u){let v="";u=Math.min(g.length,u);for(let T=c;T<u;++T)v+=String.fromCharCode(g[T]);return v}function q(g,c,u){const v=g.length;(!c||c<0)&&(c=0),(!u||u<0||u>v)&&(u=v);let T="";for(let P=c;P<u;++P)T+=be[g[P]];return T}function J(g,c,u){const v=g.slice(c,u);let T="";for(let P=0;P<v.length-1;P+=2)T+=String.fromCharCode(v[P]+v[P+1]*256);return T}o.prototype.slice=function(c,u){const v=this.length;c=~~c,u=u===void 0?v:~~u,c<0?(c+=v,c<0&&(c=0)):c>v&&(c=v),u<0?(u+=v,u<0&&(u=0)):u>v&&(u=v),u<c&&(u=c);const T=this.subarray(c,u);return Object.setPrototypeOf(T,o.prototype),T};function G(g,c,u){if(g%1!==0||g<0)throw new RangeError("offset is not uint");if(g+c>u)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(c,u,v){c=c>>>0,u=u>>>0,v||G(c,u,this.length);let T=this[c],P=1,j=0;for(;++j<u&&(P*=256);)T+=this[c+j]*P;return T},o.prototype.readUintBE=o.prototype.readUIntBE=function(c,u,v){c=c>>>0,u=u>>>0,v||G(c,u,this.length);let T=this[c+--u],P=1;for(;u>0&&(P*=256);)T+=this[c+--u]*P;return T},o.prototype.readUint8=o.prototype.readUInt8=function(c,u){return c=c>>>0,u||G(c,1,this.length),this[c]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(c,u){return c=c>>>0,u||G(c,2,this.length),this[c]|this[c+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(c,u){return c=c>>>0,u||G(c,2,this.length),this[c]<<8|this[c+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(c,u){return c=c>>>0,u||G(c,4,this.length),(this[c]|this[c+1]<<8|this[c+2]<<16)+this[c+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(c,u){return c=c>>>0,u||G(c,4,this.length),this[c]*16777216+(this[c+1]<<16|this[c+2]<<8|this[c+3])},o.prototype.readBigUInt64LE=ue(function(c){c=c>>>0,Q(c,"offset");const u=this[c],v=this[c+7];(u===void 0||v===void 0)&&fe(c,this.length-8);const T=u+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24,P=this[++c]+this[++c]*2**8+this[++c]*2**16+v*2**24;return BigInt(T)+(BigInt(P)<<BigInt(32))}),o.prototype.readBigUInt64BE=ue(function(c){c=c>>>0,Q(c,"offset");const u=this[c],v=this[c+7];(u===void 0||v===void 0)&&fe(c,this.length-8);const T=u*2**24+this[++c]*2**16+this[++c]*2**8+this[++c],P=this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+v;return(BigInt(T)<<BigInt(32))+BigInt(P)}),o.prototype.readIntLE=function(c,u,v){c=c>>>0,u=u>>>0,v||G(c,u,this.length);let T=this[c],P=1,j=0;for(;++j<u&&(P*=256);)T+=this[c+j]*P;return P*=128,T>=P&&(T-=Math.pow(2,8*u)),T},o.prototype.readIntBE=function(c,u,v){c=c>>>0,u=u>>>0,v||G(c,u,this.length);let T=u,P=1,j=this[c+--T];for(;T>0&&(P*=256);)j+=this[c+--T]*P;return P*=128,j>=P&&(j-=Math.pow(2,8*u)),j},o.prototype.readInt8=function(c,u){return c=c>>>0,u||G(c,1,this.length),this[c]&128?(255-this[c]+1)*-1:this[c]},o.prototype.readInt16LE=function(c,u){c=c>>>0,u||G(c,2,this.length);const v=this[c]|this[c+1]<<8;return v&32768?v|4294901760:v},o.prototype.readInt16BE=function(c,u){c=c>>>0,u||G(c,2,this.length);const v=this[c+1]|this[c]<<8;return v&32768?v|4294901760:v},o.prototype.readInt32LE=function(c,u){return c=c>>>0,u||G(c,4,this.length),this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24},o.prototype.readInt32BE=function(c,u){return c=c>>>0,u||G(c,4,this.length),this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]},o.prototype.readBigInt64LE=ue(function(c){c=c>>>0,Q(c,"offset");const u=this[c],v=this[c+7];(u===void 0||v===void 0)&&fe(c,this.length-8);const T=this[c+4]+this[c+5]*2**8+this[c+6]*2**16+(v<<24);return(BigInt(T)<<BigInt(32))+BigInt(u+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24)}),o.prototype.readBigInt64BE=ue(function(c){c=c>>>0,Q(c,"offset");const u=this[c],v=this[c+7];(u===void 0||v===void 0)&&fe(c,this.length-8);const T=(u<<24)+this[++c]*2**16+this[++c]*2**8+this[++c];return(BigInt(T)<<BigInt(32))+BigInt(this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+v)}),o.prototype.readFloatLE=function(c,u){return c=c>>>0,u||G(c,4,this.length),r.read(this,c,!0,23,4)},o.prototype.readFloatBE=function(c,u){return c=c>>>0,u||G(c,4,this.length),r.read(this,c,!1,23,4)},o.prototype.readDoubleLE=function(c,u){return c=c>>>0,u||G(c,8,this.length),r.read(this,c,!0,52,8)},o.prototype.readDoubleBE=function(c,u){return c=c>>>0,u||G(c,8,this.length),r.read(this,c,!1,52,8)};function se(g,c,u,v,T,P){if(!o.isBuffer(g))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>T||c<P)throw new RangeError('"value" argument is out of bounds');if(u+v>g.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(c,u,v,T){if(c=+c,u=u>>>0,v=v>>>0,!T){const te=Math.pow(2,8*v)-1;se(this,c,u,v,te,0)}let P=1,j=0;for(this[u]=c&255;++j<v&&(P*=256);)this[u+j]=c/P&255;return u+v},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(c,u,v,T){if(c=+c,u=u>>>0,v=v>>>0,!T){const te=Math.pow(2,8*v)-1;se(this,c,u,v,te,0)}let P=v-1,j=1;for(this[u+P]=c&255;--P>=0&&(j*=256);)this[u+P]=c/j&255;return u+v},o.prototype.writeUint8=o.prototype.writeUInt8=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,1,255,0),this[u]=c&255,u+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,2,65535,0),this[u]=c&255,this[u+1]=c>>>8,u+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,2,65535,0),this[u]=c>>>8,this[u+1]=c&255,u+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,4,4294967295,0),this[u+3]=c>>>24,this[u+2]=c>>>16,this[u+1]=c>>>8,this[u]=c&255,u+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,4,4294967295,0),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4};function X(g,c,u,v,T){Z(c,v,T,g,u,7);let P=Number(c&BigInt(4294967295));g[u++]=P,P=P>>8,g[u++]=P,P=P>>8,g[u++]=P,P=P>>8,g[u++]=P;let j=Number(c>>BigInt(32)&BigInt(4294967295));return g[u++]=j,j=j>>8,g[u++]=j,j=j>>8,g[u++]=j,j=j>>8,g[u++]=j,u}function ce(g,c,u,v,T){Z(c,v,T,g,u,7);let P=Number(c&BigInt(4294967295));g[u+7]=P,P=P>>8,g[u+6]=P,P=P>>8,g[u+5]=P,P=P>>8,g[u+4]=P;let j=Number(c>>BigInt(32)&BigInt(4294967295));return g[u+3]=j,j=j>>8,g[u+2]=j,j=j>>8,g[u+1]=j,j=j>>8,g[u]=j,u+8}o.prototype.writeBigUInt64LE=ue(function(c,u=0){return X(this,c,u,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=ue(function(c,u=0){return ce(this,c,u,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(c,u,v,T){if(c=+c,u=u>>>0,!T){const oe=Math.pow(2,8*v-1);se(this,c,u,v,oe-1,-oe)}let P=0,j=1,te=0;for(this[u]=c&255;++P<v&&(j*=256);)c<0&&te===0&&this[u+P-1]!==0&&(te=1),this[u+P]=(c/j>>0)-te&255;return u+v},o.prototype.writeIntBE=function(c,u,v,T){if(c=+c,u=u>>>0,!T){const oe=Math.pow(2,8*v-1);se(this,c,u,v,oe-1,-oe)}let P=v-1,j=1,te=0;for(this[u+P]=c&255;--P>=0&&(j*=256);)c<0&&te===0&&this[u+P+1]!==0&&(te=1),this[u+P]=(c/j>>0)-te&255;return u+v},o.prototype.writeInt8=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,1,127,-128),c<0&&(c=255+c+1),this[u]=c&255,u+1},o.prototype.writeInt16LE=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,2,32767,-32768),this[u]=c&255,this[u+1]=c>>>8,u+2},o.prototype.writeInt16BE=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,2,32767,-32768),this[u]=c>>>8,this[u+1]=c&255,u+2},o.prototype.writeInt32LE=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,4,2147483647,-2147483648),this[u]=c&255,this[u+1]=c>>>8,this[u+2]=c>>>16,this[u+3]=c>>>24,u+4},o.prototype.writeInt32BE=function(c,u,v){return c=+c,u=u>>>0,v||se(this,c,u,4,2147483647,-2147483648),c<0&&(c=4294967295+c+1),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4},o.prototype.writeBigInt64LE=ue(function(c,u=0){return X(this,c,u,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=ue(function(c,u=0){return ce(this,c,u,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ie(g,c,u,v,T,P){if(u+v>g.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("Index out of range")}function ge(g,c,u,v,T){return c=+c,u=u>>>0,T||ie(g,c,u,4),r.write(g,c,u,v,23,4),u+4}o.prototype.writeFloatLE=function(c,u,v){return ge(this,c,u,!0,v)},o.prototype.writeFloatBE=function(c,u,v){return ge(this,c,u,!1,v)};function B(g,c,u,v,T){return c=+c,u=u>>>0,T||ie(g,c,u,8),r.write(g,c,u,v,52,8),u+8}o.prototype.writeDoubleLE=function(c,u,v){return B(this,c,u,!0,v)},o.prototype.writeDoubleBE=function(c,u,v){return B(this,c,u,!1,v)},o.prototype.copy=function(c,u,v,T){if(!o.isBuffer(c))throw new TypeError("argument should be a Buffer");if(v||(v=0),!T&&T!==0&&(T=this.length),u>=c.length&&(u=c.length),u||(u=0),T>0&&T<v&&(T=v),T===v||c.length===0||this.length===0)return 0;if(u<0)throw new RangeError("targetStart out of bounds");if(v<0||v>=this.length)throw new RangeError("Index out of range");if(T<0)throw new RangeError("sourceEnd out of bounds");T>this.length&&(T=this.length),c.length-u<T-v&&(T=c.length-u+v);const P=T-v;return this===c&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(u,v,T):Uint8Array.prototype.set.call(c,this.subarray(v,T),u),P},o.prototype.fill=function(c,u,v,T){if(typeof c=="string"){if(typeof u=="string"?(T=u,u=0,v=this.length):typeof v=="string"&&(T=v,v=this.length),T!==void 0&&typeof T!="string")throw new TypeError("encoding must be a string");if(typeof T=="string"&&!o.isEncoding(T))throw new TypeError("Unknown encoding: "+T);if(c.length===1){const j=c.charCodeAt(0);(T==="utf8"&&j<128||T==="latin1")&&(c=j)}}else typeof c=="number"?c=c&255:typeof c=="boolean"&&(c=Number(c));if(u<0||this.length<u||this.length<v)throw new RangeError("Out of range index");if(v<=u)return this;u=u>>>0,v=v===void 0?this.length:v>>>0,c||(c=0);let P;if(typeof c=="number")for(P=u;P<v;++P)this[P]=c;else{const j=o.isBuffer(c)?c:o.from(c,T),te=j.length;if(te===0)throw new TypeError('The value "'+c+'" is invalid for argument "value"');for(P=0;P<v-u;++P)this[P+u]=j[P%te]}return this};const L={};function U(g,c,u){L[g]=class extends u{constructor(){super(),Object.defineProperty(this,"message",{value:c.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${g}]`,this.stack,delete this.name}get code(){return g}set code(T){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:T,writable:!0})}toString(){return`${this.name} [${g}]: ${this.message}`}}}U("ERR_BUFFER_OUT_OF_BOUNDS",function(g){return g?`${g} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),U("ERR_INVALID_ARG_TYPE",function(g,c){return`The "${g}" argument must be of type number. Received type ${typeof c}`},TypeError),U("ERR_OUT_OF_RANGE",function(g,c,u){let v=`The value of "${g}" is out of range.`,T=u;return Number.isInteger(u)&&Math.abs(u)>2**32?T=h(String(u)):typeof u=="bigint"&&(T=String(u),(u>BigInt(2)**BigInt(32)||u<-(BigInt(2)**BigInt(32)))&&(T=h(T)),T+="n"),v+=` It must be ${c}. Received ${T}`,v},RangeError);function h(g){let c="",u=g.length;const v=g[0]==="-"?1:0;for(;u>=v+4;u-=3)c=`_${g.slice(u-3,u)}${c}`;return`${g.slice(0,u)}${c}`}function C(g,c,u){Q(c,"offset"),(g[c]===void 0||g[c+u]===void 0)&&fe(c,g.length-(u+1))}function Z(g,c,u,v,T,P){if(g>u||g<c){const j=typeof c=="bigint"?"n":"";let te;throw P>3?c===0||c===BigInt(0)?te=`>= 0${j} and < 2${j} ** ${(P+1)*8}${j}`:te=`>= -(2${j} ** ${(P+1)*8-1}${j}) and < 2 ** ${(P+1)*8-1}${j}`:te=`>= ${c}${j} and <= ${u}${j}`,new L.ERR_OUT_OF_RANGE("value",te,g)}C(v,T,P)}function Q(g,c){if(typeof g!="number")throw new L.ERR_INVALID_ARG_TYPE(c,"number",g)}function fe(g,c,u){throw Math.floor(g)!==g?(Q(g,u),new L.ERR_OUT_OF_RANGE(u||"offset","an integer",g)):c<0?new L.ERR_BUFFER_OUT_OF_BOUNDS:new L.ERR_OUT_OF_RANGE(u||"offset",`>= ${u?1:0} and <= ${c}`,g)}const xe=/[^+/0-9A-Za-z-_]/g;function _e(g){if(g=g.split("=")[0],g=g.trim().replace(xe,""),g.length<2)return"";for(;g.length%4!==0;)g=g+"=";return g}function Se(g,c){c=c||1/0;let u;const v=g.length;let T=null;const P=[];for(let j=0;j<v;++j){if(u=g.charCodeAt(j),u>55295&&u<57344){if(!T){if(u>56319){(c-=3)>-1&&P.push(239,191,189);continue}else if(j+1===v){(c-=3)>-1&&P.push(239,191,189);continue}T=u;continue}if(u<56320){(c-=3)>-1&&P.push(239,191,189),T=u;continue}u=(T-55296<<10|u-56320)+65536}else T&&(c-=3)>-1&&P.push(239,191,189);if(T=null,u<128){if((c-=1)<0)break;P.push(u)}else if(u<2048){if((c-=2)<0)break;P.push(u>>6|192,u&63|128)}else if(u<65536){if((c-=3)<0)break;P.push(u>>12|224,u>>6&63|128,u&63|128)}else if(u<1114112){if((c-=4)<0)break;P.push(u>>18|240,u>>12&63|128,u>>6&63|128,u&63|128)}else throw new Error("Invalid code point")}return P}function Fe(g){const c=[];for(let u=0;u<g.length;++u)c.push(g.charCodeAt(u)&255);return c}function Re(g,c){let u,v,T;const P=[];for(let j=0;j<g.length&&!((c-=2)<0);++j)u=g.charCodeAt(j),v=u>>8,T=u%256,P.push(T),P.push(v);return P}function Ee(g){return e.toByteArray(_e(g))}function me(g,c,u,v){let T;for(T=0;T<v&&!(T+u>=c.length||T>=g.length);++T)c[T+u]=g[T];return T}function he(g,c){return g instanceof c||g!=null&&g.constructor!=null&&g.constructor.name!=null&&g.constructor.name===c.name}function ye(g){return g!==g}const be=function(){const g="0123456789abcdef",c=new Array(256);for(let u=0;u<16;++u){const v=u*16;for(let T=0;T<16;++T)c[v+T]=g[u]+g[T]}return c}();function ue(g){return typeof BigInt>"u"?de:g}function de(){throw new Error("BigInt not supported")}})(Hc);const Te=Wt({selectedChain:void 0,chains:void 0,standaloneChains:void 0,standaloneUri:void 0,address:void 0,profileName:void 0,profileAvatar:void 0,profileLoading:!1,balanceLoading:!1,balance:void 0,isConnected:!1,isStandalone:!1,isCustomDesktop:!1,isCustomMobile:!1,isExplorer:!1,isDataLoaded:!1,isUiLoaded:!1}),tt={state:Te,subscribe(t){return Xr(Te,()=>t(Te))},setChains(t){Te.chains=t},setStandaloneChains(t){Te.standaloneChains=t},setStandaloneUri(t){Te.standaloneUri=t},getSelectedChain(){const t=Qr.client().getNetwork().chain;return t&&(Te.selectedChain=t),Te.selectedChain},setSelectedChain(t){Te.selectedChain=t},setIsStandalone(t){Te.isStandalone=t},setIsCustomDesktop(t){Te.isCustomDesktop=t},setIsCustomMobile(t){Te.isCustomMobile=t},setIsExplorer(t){Te.isExplorer=t},getAccount(){const t=Qr.client().getAccount();Te.address=t.address,Te.isConnected=t.isConnected},setAddress(t){Te.address=t},setIsConnected(t){Te.isConnected=t},setProfileName(t){Te.profileName=t},setProfileAvatar(t){Te.profileAvatar=t},setProfileLoading(t){Te.profileLoading=t},setBalanceLoading(t){Te.balanceLoading=t},setBalance(t){Te.balance=t},setIsDataLoaded(t){Te.isDataLoaded=t},setIsUiLoaded(t){Te.isUiLoaded=t},resetProfile(){Te.profileName=void 0,Te.profileAvatar=void 0,Te.balance=void 0},resetAccount(){Te.address=void 0,tt.resetProfile()}},Zr=Wt({initialized:!1,ethereumClient:void 0}),Qr={setEthereumClient(t){!Zr.initialized&&t&&(Zr.ethereumClient=t,tt.setChains(t.chains),Zr.initialized=!0)},client(){if(Zr.ethereumClient)return Zr.ethereumClient;throw new Error("ClientCtrl has no client set")}},Gt={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",isMobile(){return typeof window<"u"?Boolean(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},isAndroid(){return Gt.isMobile()&&navigator.userAgent.toLowerCase().includes("android")},isEmptyObject(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.getOwnPropertyNames(t).length===0&&Object.getOwnPropertySymbols(t).length===0},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,r){if(Gt.isHttpUrl(t))return this.formatUniversalUrl(t,e,r);let i=t;i.includes("://")||(i=t.replaceAll("/","").replaceAll(":",""),i=`${i}://`),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(e);return`${i}wc?uri=${n}`},formatUniversalUrl(t,e,r){if(!Gt.isHttpUrl(t))return this.formatNativeUrl(t,e,r);let i=t;t.endsWith("/")&&(i=t.slice(0,-1)),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(e);return`${i}/wc?uri=${n}`},async wait(t){return new Promise(e=>{setTimeout(e,t)})},openHref(t,e="_self"){window.open(t,e,"noreferrer noopener")},setWalletConnectDeepLink(t,e){localStorage.setItem(Gt.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))},setWalletConnectAndroidDeepLink(t){const[e]=t.split("?");localStorage.setItem(Gt.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:"Android"}))},removeWalletConnectDeepLink(){localStorage.removeItem(Gt.WALLETCONNECT_DEEPLINK_CHOICE)},isNull(t){return t===null},getWalletConnectVersion(){const{isStandalone:t}=tt.state;let e=1;return t||(e=Qr.client().walletConnectVersion),e}};function tw(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}const ei=Wt({projectId:void 0,themeMode:tw()?"dark":"light",themeColor:"default",themeBackground:Gt.isMobile()?"themeColor":"gradient",themeZIndex:89,mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chainImages:void 0,tokenImages:void 0,standaloneChains:void 0,enableStandaloneMode:!1,enableNetworkView:!1,defaultChain:void 0,explorerAllowList:void 0,explorerDenyList:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),ti={state:ei,subscribe(t){return Xr(ei,()=>t(ei))},setConfig(t){var e,r,i,n;if(tt.setStandaloneChains(t.standaloneChains),tt.setIsStandalone(Boolean((e=t.standaloneChains)==null?void 0:e.length)||Boolean(t.enableStandaloneMode)),tt.setIsCustomMobile(Boolean((r=t.mobileWallets)==null?void 0:r.length)),tt.setIsCustomDesktop(Boolean((i=t.desktopWallets)==null?void 0:i.length)),tt.setIsExplorer(Boolean((n=t.projectId)==null?void 0:n.length)),t.defaultChain)tt.setSelectedChain(t.defaultChain);else if(!tt.state.isStandalone){const s=Qr.client().getDefaultChain();tt.setSelectedChain(s)}Object.assign(ei,t)},setThemeConfig(t){Object.assign(ei,t)}},qc="https://explorer-api.walletconnect.com";function rw(t){const e=Object.fromEntries(Object.entries(t).filter(([r,i])=>typeof i<"u"&&i!==null&&i!=="").map(([r,i])=>[r,i.toString()]));return new URLSearchParams(e).toString()}const Bi={async fetchWallets(t,e){const r=rw(e),i=`${qc}/v3/wallets?projectId=${t}&${r}`;return(await fetch(i)).json()},formatImageUrl(t,e){return`${qc}/v3/logo/lg/${e}?projectId=${t}`}},or=Wt({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},previewWallets:[],recomendedWallets:[]});function $i(){const{projectId:t}=ti.state;if(!t)throw new Error("projectId is required to work with explorer api");return t}const iw={state:or,async getPreviewWallets(t){const{listings:e}=await Bi.fetchWallets($i(),t);return or.previewWallets=Object.values(e),or.previewWallets},async getRecomendedWallets(){const{listings:t}=await Bi.fetchWallets($i(),{page:1,entries:6});or.recomendedWallets=Object.values(t)},async getPaginatedWallets(t){const{page:e,search:r}=t,{listings:i,total:n}=await Bi.fetchWallets($i(),t),s=Object.values(i),l=r?"search":"wallets";return or[l]={listings:[...or[l].listings,...s],total:n,page:e??1},{listings:s,total:n}},getImageUrl(t){return Bi.formatImageUrl($i(),t)},resetSearch(){or.search={listings:[],total:0,page:1}}},mt=Wt({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),Er={state:mt,subscribe(t){return Xr(mt,()=>t(mt))},push(t,e){t!==mt.view&&(mt.view=t,e&&(mt.data=e),mt.history.push(t))},replace(t){mt.view=t,mt.history=[t]},goBack(){if(mt.history.length>1){mt.history.pop();const[t]=mt.history.slice(-1);mt.view=t}}},vr=Wt({open:!1}),ji={state:vr,subscribe(t){return Xr(vr,()=>t(vr))},async open(t){return new Promise(e=>{const{isConnected:r,isStandalone:i,isUiLoaded:n,isDataLoaded:s}=tt.state,{enableNetworkView:l}=ti.state;if(i?(tt.setStandaloneUri(t?.uri),tt.setStandaloneChains(t?.standaloneChains),Er.replace("ConnectWallet")):t!=null&&t.route?Er.replace(t.route):r?Er.replace("Account"):l?Er.replace("SelectNetwork"):Er.replace("ConnectWallet"),n&&s)vr.open=!0,e();else{const o=setInterval(()=>{tt.state.isUiLoaded&&tt.state.isDataLoaded&&(clearInterval(o),vr.open=!0,e())},200)}})},close(){vr.open=!1}},ar=Wt({open:!1,message:"",variant:"success"}),nw={state:ar,subscribe(t){return Xr(ar,()=>t(ar))},openToast(t,e){ar.open=!0,ar.message=t,ar.variant=e},closeToast(){ar.open=!1}};typeof window<"u"&&(window.Buffer||(window.Buffer=Hc.Buffer),window.global||(window.global=window),window.process||(window.process={env:{}}));var sw=Object.defineProperty,Kc=Object.getOwnPropertySymbols,ow=Object.prototype.hasOwnProperty,aw=Object.prototype.propertyIsEnumerable,Vc=(t,e,r)=>e in t?sw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,cw=(t,e)=>{for(var r in e||(e={}))ow.call(e,r)&&Vc(t,r,e[r]);if(Kc)for(var r of Kc(e))aw.call(e,r)&&Vc(t,r,e[r]);return t};class uw{constructor(e){this.openModal=ji.open,this.closeModal=ji.close,this.subscribeModal=ji.subscribe,this.setTheme=ti.setThemeConfig,ti.setConfig(cw({enableStandaloneMode:!0},e)),this.initUi()}async initUi(){if(typeof window<"u"){await Promise.resolve().then(function(){return require("./index-bd2dffef.js")});const e=document.createElement("w3m-modal");document.body.insertAdjacentElement("beforeend",e),tt.setIsUiLoaded(!0)}}}class hw extends Es{constructor({logger:e,chains:r,projectId:i,modalZIndex:n}){super(e,ui.WalletConnect,r),this.waitModalClose=()=>{let s;return new Promise((l,o)=>{s=this._web3Modal.subscribeModal(d=>{this.logger.debug(`modal.open: ${d.open.toString()}`),d.open===!1&&l()})}).then(s)},this.getRawProvider=()=>this.universalProvider,this._rpc={},r.forEach(s=>{s.rpcUrl&&(this._rpc[`${s.chainId}`]=s.rpcUrl)}),this._projectId=i,this._web3Modal=new uw({themeZIndex:n,projectId:this._projectId,themeMode:"light"}),this._waitInit=this.init()}async disconnect(){await this._waitInit,await super.disconnect(),await this._universalProvider.disconnect()}get canSwitchChain(){return!0}async switchChain(e){return await this.disconnect(),await this.connect(e)}get isConnected(){return this._waitInit.then(()=>!!this._session)}get isInstalled(){return!0}get installUrl(){return""}async connect(e){const r=await this.universalProvider,i=this.waitModalClose(),n=r.connect({namespaces:{eip155:{methods:["eth_sendTransaction","eth_signTransaction","eth_sign","personal_sign","eth_signTypedData"],chains:[`eip155:${e}`],events:["chainChanged","accountsChanged"],rpcMap:this._rpc}}}),s=await Promise.race([i,n]);return s&&s.expiry?(this._session=s,this._web3Modal.closeModal(),!0):!1}async init(){this._universalProvider=await hs.init({projectId:this._projectId,logger:"debug",relayUrl:"wss://relay.walletconnect.com"}),this.initListeners(this._universalProvider),this.subscribeToProviderEvents(this._universalProvider),this._session=this._universalProvider.session}get universalProvider(){return this._waitInit.then(()=>this._universalProvider)}async subscribeToProviderEvents(e){e.on("display_uri",async r=>{console.log("EVENT","QR Code Modal open"),this._web3Modal.openModal({uri:r})}),e.on("session_ping",({id:r,topic:i})=>{console.log("EVENT","session_ping"),console.log(r,i)}),e.on("session_event",({event:r,chainId:i})=>{console.log("EVENT","session_event"),console.log(r,i)}),e.on("session_update",({session:r})=>{console.log("EVENT","session_updated"),this._session=r}),e.on("session_delete",({id:r,topic:i})=>{console.log("EVENT","session_deleted"),console.log(r,i),this._session=void 0})}}exports.A=iw,exports.ConnectorNames=ui,exports.ConnectorProvider=Mu,exports.E=ti,exports.I=Qr,exports.InjectedConnector=Bu,exports.P=nw,exports.WalletConnectConnector=hw,exports.a=tt,exports.c=Gt,exports.k=ji,exports.m=Er;
//# sourceMappingURL=index-55b01a16.js.map
