import{providers as wu}from"ethers";const Ui="cur_connector",bu=()=>{const t=localStorage.getItem(Ui);return t?JSON.parse(t):void 0},mu=t=>localStorage.setItem(Ui,JSON.stringify(t)),_u=()=>localStorage.removeItem(Ui);class Eu{constructor(e,r){this.connectorsByName={},this._logger=e,this.WaitInitialisationAsync=this.InitAsync(r,bu())}async InitAsync(e,r){let i;for(let n=0;n<e.length;n++){const a=e[n];this.connectorsByName[a.name]=a,a.name===r?.name&&await a.isConnected&&(i=a)}i&&await i.connect(r.chainId)&&(this._curConnector=i,this._logger.debug(`Current connector is ${this._curConnector.name}`))}get CurConnector(){return this._curConnector}async connect(e,r){await this.WaitInitialisationAsync;const i=this.connectorsByName[r];await i.connect(e)&&(mu({chainId:e,name:r}),this._curConnector=i)}async disconnect(){var e;await((e=this._curConnector)==null?void 0:e.disconnect()),_u(),this._curConnector=void 0}}class os{constructor(e,r,i){this._chains={},this._externalAccountChangedHandlers=[],this._externalChainChangedHandlers=[],this._externalDisconnectHandlers=[],this._checkConnectionDelayMs=500,this.name=r,this.logger=e,i.forEach(n=>this._chains[n.chainId]=n)}async CheckConnection(){await this.isConnected||(this._timerId&&(clearInterval(this._timerId),this.logger.debug(`${this.name}Connector. CheckConnection stopped`)),this._externalDisconnectHandlers.forEach(e=>e(void 0)),this._externalDisconnectHandlers=[])}initListeners(e){this.logger.debug("initListeners");const r=this;this.accountsChangedHandler=i=>{this.logger.debug(`${this.name}.accountsChangedHandler`),r._externalAccountChangedHandlers.forEach(n=>n(i))},this.chainChangedHandler=i=>{this.logger.debug(`${this.name}.chainChangedHandler`),r._externalChainChangedHandlers.forEach(n=>n(i))},this.disconnectHandler=i=>{this.logger.debug(`${this.name}.disconnectHandler ${JSON.stringify(i)}`),r._externalDisconnectHandlers.forEach(n=>n(i))},e.on("accountsChanged",this.accountsChangedHandler),e.on("chainChanged",this.chainChangedHandler)}removeListeners(e){e.removeListener("accountsChanged",this.accountsChangedHandler),e.removeListener("chainChanged",this.chainChangedHandler),this._externalAccountChangedHandlers=[],this._externalChainChangedHandlers=[],this._externalDisconnectHandlers=[]}onAccountsChanged(e){this._externalAccountChangedHandlers.push(e)}onChainChanged(e){this._externalChainChangedHandlers.push(e)}onDisconnect(e){if(!this._timerId){const r=this;this._timerId=setInterval(()=>r.CheckConnection(),this._checkConnectionDelayMs)}this._externalDisconnectHandlers.push(e)}async getSigner(){return new wu.Web3Provider(await this.getRawProvider()).getSigner()}async disconnect(){this.removeListeners(await this.getRawProvider())}}var ni=(t=>(t.Undefined="",t.Injected="Injected",t.WalletConnect="WalletConnect",t))(ni||{});class vu extends os{constructor(e,r){super(e,ni.Injected,r),this._ethRequestAccounts=void 0,this.isInstalled&&this.initListeners(window.ethereum)}getRawProvider(){return Promise.resolve(window.ethereum)}get canSwitchChain(){return!!window.ethereum.isMetaMask}async switchChain(e){const r=`0x${e.toString(16)}`;try{if(!this._chains[e])throw new Error(`Chain ${e} not supported`);await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]})}catch(i){if(i.code===4902)try{const n=this._chains[e];await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:r,chainName:n.name,rpcUrls:[n.rpcUrl],nativeCurrency:n.nativeCurrency,blockExplorerUrls:[n.blockExplorer]}]})}catch(n){throw n}}}async prvEnable(){try{await window.ethereum.request({method:"eth_requestAccounts"})}catch(e){return e.code===4001?this.logger.warn("Please connect to MetaMask."):this.logger.error(e),!1}return!0}async connect(e){if(this._ethRequestAccounts)return this.logger.debug("InjectedConnector.enable already called"),await this._ethRequestAccounts;this.logger.debug("InjectedConnector.enable"),this._ethRequestAccounts=this.prvEnable();const r=await this._ethRequestAccounts;return this._ethRequestAccounts=void 0,await(await this.getSigner()).getChainId()!==e&&await this.switchChain(e),r}async isConnectedAsync(){return(await window.ethereum.request({method:"eth_accounts"})).length>0}get isConnected(){return this.isConnectedAsync()}get isInstalled(){return!!window.ethereum}get installUrl(){return"https://metamask.io/download"}}var ut=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Du(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Li(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}function xu(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Su=Iu;function Iu(t,e,r){var i=r&&r.stringify||xu,n=1;if(typeof t=="object"&&t!==null){var a=e.length+n;if(a===1)return t;var l=new Array(a);l[0]=i(t);for(var o=1;o<a;o++)l[o]=i(e[o]);return l.join(" ")}if(typeof t!="string")return t;var f=e.length;if(f===0)return t;for(var p="",m=1-n,C=-1,L=t&&t.length||0,O=0;O<L;){if(t.charCodeAt(O)===37&&O+1<L){switch(C=C>-1?C:0,t.charCodeAt(O+1)){case 100:case 102:if(m>=f||e[m]==null)break;C<O&&(p+=t.slice(C,O)),p+=Number(e[m]),C=O+2,O++;break;case 105:if(m>=f||e[m]==null)break;C<O&&(p+=t.slice(C,O)),p+=Math.floor(Number(e[m])),C=O+2,O++;break;case 79:case 111:case 106:if(m>=f||e[m]===void 0)break;C<O&&(p+=t.slice(C,O));var I=typeof e[m];if(I==="string"){p+="'"+e[m]+"'",C=O+2,O++;break}if(I==="function"){p+=e[m].name||"<anonymous>",C=O+2,O++;break}p+=i(e[m]),C=O+2,O++;break;case 115:if(m>=f)break;C<O&&(p+=t.slice(C,O)),p+=String(e[m]),C=O+2,O++;break;case 37:C<O&&(p+=t.slice(C,O)),p+="%",C=O+2,O++,m--;break}++m}++O}return C===-1?t:(C<L&&(p+=t.slice(C)),p)}const as=Su;var Dr=Tt;const xr=Lu().console||{},Ou={mapHttpRequest:oi,mapHttpResponse:oi,wrapRequestSerializer:Bi,wrapResponseSerializer:Bi,wrapErrorSerializer:Bi,req:oi,res:oi,err:Nu};function Cu(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Tt(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||xr;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=Cu(t.browser.serialize,i);let a=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);const l=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const o=t.level||"info",f=Object.create(r);f.log||(f.log=Sr),Object.defineProperty(f,"levelVal",{get:m}),Object.defineProperty(f,"level",{get:C,set:L});const p={transmit:e,serialize:n,asObject:t.browser.asObject,levels:l,timestamp:Ru(t)};f.levels=Tt.levels,f.level=o,f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=Sr,f.serializers=i,f._serialize=n,f._stdErrSerialize=a,f.child=O,e&&(f._logEvent=Mi());function m(){return this.level==="silent"?1/0:this.levels.values[this.level]}function C(){return this._level}function L(I){if(I!=="silent"&&!this.levels.values[I])throw Error("unknown level "+I);this._level=I,fr(p,f,"error","log"),fr(p,f,"fatal","error"),fr(p,f,"warn","error"),fr(p,f,"info","log"),fr(p,f,"debug","log"),fr(p,f,"trace","log")}function O(I,$){if(!I)throw new Error("missing bindings for child Pino");$=$||{},n&&I.serializers&&($.serializers=I.serializers);const B=$.serializers;if(n&&B){var W=Object.assign({},i,B),A=t.browser.serialize===!0?Object.keys(W):n;delete I.serializers,si([I],A,W,this._stdErrSerialize)}function R(_){this._childLevel=(_._childLevel|0)+1,this.error=dr(_,I,"error"),this.fatal=dr(_,I,"fatal"),this.warn=dr(_,I,"warn"),this.info=dr(_,I,"info"),this.debug=dr(_,I,"debug"),this.trace=dr(_,I,"trace"),W&&(this.serializers=W,this._serialize=A),e&&(this._logEvent=Mi([].concat(_._logEvent.bindings,I)))}return R.prototype=this,new R(this)}return f}Tt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Tt.stdSerializers=Ou,Tt.stdTimeFunctions=Object.assign({},{nullTime:cs,epochTime:us,unixTime:Fu,isoTime:Uu});function fr(t,e,r,i){const n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Sr:n[r]?n[r]:xr[r]||xr[i]||Sr,Au(t,e,r)}function Au(t,e,r){!t.transmit&&e[r]===Sr||(e[r]=function(i){return function(){const a=t.timestamp(),l=new Array(arguments.length),o=Object.getPrototypeOf&&Object.getPrototypeOf(this)===xr?xr:this;for(var f=0;f<l.length;f++)l[f]=arguments[f];if(t.serialize&&!t.asObject&&si(l,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(o,Tu(this,r,l,a)):i.apply(o,l),t.transmit){const p=t.transmit.level||e.level,m=Tt.levels.values[p],C=Tt.levels.values[r];if(C<m)return;Pu(this,{ts:a,methodLevel:r,methodValue:C,transmitLevel:p,transmitValue:Tt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},l)}}}(e[r]))}function Tu(t,e,r,i){t._serialize&&si(r,t._serialize,t.serializers,t._stdErrSerialize);const n=r.slice();let a=n[0];const l={};i&&(l.time=i),l.level=Tt.levels.values[e];let o=(t._childLevel|0)+1;if(o<1&&(o=1),a!==null&&typeof a=="object"){for(;o--&&typeof n[0]=="object";)Object.assign(l,n.shift());a=n.length?as(n.shift(),n):void 0}else typeof a=="string"&&(a=as(n.shift(),n));return a!==void 0&&(l.msg=a),l}function si(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=Tt.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(const a in t[n])e&&e.indexOf(a)>-1&&a in r&&(t[n][a]=r[a](t[n][a]))}function dr(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function Pu(t,e,r){const i=e.send,n=e.ts,a=e.methodLevel,l=e.methodValue,o=e.val,f=t._logEvent.bindings;si(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(p){return f.indexOf(p)===-1}),t._logEvent.level.label=a,t._logEvent.level.value=l,i(a,t._logEvent,o),t._logEvent=Mi(f)}function Mi(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Nu(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Ru(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?cs:us}function oi(){return{}}function Bi(t){return t}function Sr(){}function cs(){return!1}function us(){return Date.now()}function Fu(){return Math.round(Date.now()/1e3)}function Uu(){return new Date(Date.now()).toISOString()}function Lu(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var ot={exports:{}},pr=typeof Reflect=="object"?Reflect:null,hs=pr&&typeof pr.apply=="function"?pr.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},ai;pr&&typeof pr.ownKeys=="function"?ai=pr.ownKeys:Object.getOwnPropertySymbols?ai=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ai=function(e){return Object.getOwnPropertyNames(e)};function Mu(t){console&&console.warn&&console.warn(t)}var ls=Number.isNaN||function(e){return e!==e};function Ce(){Ce.init.call(this)}ot.exports=Ce,ot.exports.once=Hu,Ce.EventEmitter=Ce,Ce.prototype._events=void 0,Ce.prototype._eventsCount=0,Ce.prototype._maxListeners=void 0;var fs=10;function ci(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ce,"defaultMaxListeners",{enumerable:!0,get:function(){return fs},set:function(t){if(typeof t!="number"||t<0||ls(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");fs=t}}),Ce.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ce.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ls(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ds(t){return t._maxListeners===void 0?Ce.defaultMaxListeners:t._maxListeners}Ce.prototype.getMaxListeners=function(){return ds(this)},Ce.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",a=this._events;if(a!==void 0)n=n&&a.error===void 0;else if(!n)return!1;if(n){var l;if(r.length>0&&(l=r[0]),l instanceof Error)throw l;var o=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw o.context=l,o}var f=a[e];if(f===void 0)return!1;if(typeof f=="function")hs(f,this,r);else for(var p=f.length,m=bs(f,p),i=0;i<p;++i)hs(m[i],this,r);return!0};function ps(t,e,r,i){var n,a,l;if(ci(r),a=t._events,a===void 0?(a=t._events=Object.create(null),t._eventsCount=0):(a.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),a=t._events),l=a[e]),l===void 0)l=a[e]=r,++t._eventsCount;else if(typeof l=="function"?l=a[e]=i?[r,l]:[l,r]:i?l.unshift(r):l.push(r),n=ds(t),n>0&&l.length>n&&!l.warned){l.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=l.length,Mu(o)}return t}Ce.prototype.addListener=function(e,r){return ps(this,e,r,!1)},Ce.prototype.on=Ce.prototype.addListener,Ce.prototype.prependListener=function(e,r){return ps(this,e,r,!0)};function Bu(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function gs(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=Bu.bind(i);return n.listener=r,i.wrapFn=n,n}Ce.prototype.once=function(e,r){return ci(r),this.on(e,gs(this,e,r)),this},Ce.prototype.prependOnceListener=function(e,r){return ci(r),this.prependListener(e,gs(this,e,r)),this},Ce.prototype.removeListener=function(e,r){var i,n,a,l,o;if(ci(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(a=-1,l=i.length-1;l>=0;l--)if(i[l]===r||i[l].listener===r){o=i[l].listener,a=l;break}if(a<0)return this;a===0?i.shift():$u(i,a),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,o||r)}return this},Ce.prototype.off=Ce.prototype.removeListener,Ce.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var a=Object.keys(i),l;for(n=0;n<a.length;++n)l=a[n],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function ys(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?ju(n):bs(n,n.length)}Ce.prototype.listeners=function(e){return ys(this,e,!0)},Ce.prototype.rawListeners=function(e){return ys(this,e,!1)},Ce.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):ws.call(t,e)},Ce.prototype.listenerCount=ws;function ws(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ce.prototype.eventNames=function(){return this._eventsCount>0?ai(this._events):[]};function bs(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function $u(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function ju(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Hu(t,e){return new Promise(function(r,i){function n(l){t.removeListener(e,a),i(l)}function a(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}ms(t,e,a,{once:!0}),e!=="error"&&zu(t,n,{once:!0})})}function zu(t,e,r){typeof t.on=="function"&&ms(t,"error",e,r)}function ms(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(a){i.once&&t.removeEventListener(e,n),r(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var ui={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $i=function(t,e){return $i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},$i(t,e)};function qu(t,e){$i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ji=function(){return ji=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ji.apply(this,arguments)};function Ku(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Vu(t,e,r,i){var n=arguments.length,a=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,i);else for(var o=t.length-1;o>=0;o--)(l=t[o])&&(a=(n<3?l(a):n>3?l(e,r,a):l(e,r))||a);return n>3&&a&&Object.defineProperty(e,r,a),a}function ku(t,e){return function(r,i){e(r,i,t)}}function Wu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Gu(t,e,r,i){function n(a){return a instanceof r?a:new r(function(l){l(a)})}return new(r||(r=Promise))(function(a,l){function o(m){try{p(i.next(m))}catch(C){l(C)}}function f(m){try{p(i.throw(m))}catch(C){l(C)}}function p(m){m.done?a(m.value):n(m.value).then(o,f)}p((i=i.apply(t,e||[])).next())})}function Yu(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,n,a,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(p){return function(m){return f([p,m])}}function f(p){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(a=p[0]&2?n.return:p[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,p[1])).done)return a;switch(n=0,a&&(p=[p[0]&2,a.value]),p[0]){case 0:case 1:a=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,n=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){r.label=p[1];break}if(p[0]===6&&r.label<a[1]){r.label=a[1],a=p;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(p);break}a[2]&&r.ops.pop(),r.trys.pop();continue}p=e.call(t,r)}catch(m){p=[6,m],n=0}finally{i=a=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Ju(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Xu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Hi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function _s(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,a=[],l;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(o){l={error:o}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(l)throw l.error}}return a}function Zu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(_s(arguments[e]));return t}function Qu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var a=arguments[e],l=0,o=a.length;l<o;l++,n++)i[n]=a[l];return i}function Ir(t){return this instanceof Ir?(this.v=t,this):new Ir(t)}function eh(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,a=[];return n={},l("next"),l("throw"),l("return"),n[Symbol.asyncIterator]=function(){return this},n;function l(L){i[L]&&(n[L]=function(O){return new Promise(function(I,$){a.push([L,O,I,$])>1||o(L,O)})})}function o(L,O){try{f(i[L](O))}catch(I){C(a[0][3],I)}}function f(L){L.value instanceof Ir?Promise.resolve(L.value.v).then(p,m):C(a[0][2],L)}function p(L){o("next",L)}function m(L){o("throw",L)}function C(L,O){L(O),a.shift(),a.length&&o(a[0][0],a[0][1])}}function th(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,a){e[n]=t[n]?function(l){return(r=!r)?{value:Ir(t[n](l)),done:n==="return"}:a?a(l):l}:a}}function rh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Hi=="function"?Hi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(a){r[a]=t[a]&&function(l){return new Promise(function(o,f){l=t[a](l),n(o,f,l.done,l.value)})}}function n(a,l,o,f){Promise.resolve(f).then(function(p){a({value:p,done:o})},l)}}function ih(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function nh(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function sh(t){return t&&t.__esModule?t:{default:t}}function oh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function ah(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var ch=Object.freeze({__proto__:null,__extends:qu,get __assign(){return ji},__rest:Ku,__decorate:Vu,__param:ku,__metadata:Wu,__awaiter:Gu,__generator:Yu,__createBinding:Ju,__exportStar:Xu,__values:Hi,__read:_s,__spread:Zu,__spreadArrays:Qu,__await:Ir,__asyncGenerator:eh,__asyncDelegator:th,__asyncValues:rh,__makeTemplateObject:ih,__importStar:nh,__importDefault:sh,__classPrivateFieldGet:oh,__classPrivateFieldSet:ah}),Et=Li(ch),Or={};Object.defineProperty(Or,"__esModule",{value:!0});function uh(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}Or.safeJsonParse=uh;function hh(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}Or.safeJsonStringify=hh;var Cr={exports:{}},Es;function lh(){return Es||(Es=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ut<"u"&&ut.localStorage?Cr.exports=ut.localStorage:typeof window<"u"&&window.localStorage?Cr.exports=window.localStorage:Cr.exports=new e}()),Cr.exports}var zi={},Ar={},vs;function fh(){if(vs)return Ar;vs=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.IKeyValueStorage=void 0;class t{}return Ar.IKeyValueStorage=t,Ar}var Tr={},Ds;function dh(){if(Ds)return Tr;Ds=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseEntry=void 0;const t=Or;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return Tr.parseEntry=e,Tr}var xs;function ph(){return xs||(xs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(fh(),t),e.__exportStar(dh(),t)}(zi)),zi}Object.defineProperty(ui,"__esModule",{value:!0}),ui.KeyValueStorage=void 0;const gr=Et,Ss=Or,gh=gr.__importDefault(lh()),yh=ph();class Is{constructor(){this.localStorage=gh.default}getKeys(){return gr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return gr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(yh.parseEntry)})}getItem(e){return gr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return Ss.safeJsonParse(r)})}setItem(e,r){return gr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Ss.safeJsonStringify(r))})}removeItem(e){return gr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}ui.KeyValueStorage=Is;var wh=ui.default=Is,Pr={},Nr={},le={},qi={},Rr={},Os;function bh(){if(Os)return Rr;Os=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Rr.delay=t,Rr}var tr={},Ki={},rr={},Cs;function mh(){return Cs||(Cs=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.ONE_THOUSAND=rr.ONE_HUNDRED=void 0,rr.ONE_HUNDRED=100,rr.ONE_THOUSAND=1e3),rr}var Vi={},As;function _h(){return As||(As=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Vi)),Vi}var Ts;function Ps(){return Ts||(Ts=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(mh(),t),e.__exportStar(_h(),t)}(Ki)),Ki}var Ns;function Eh(){if(Ns)return tr;Ns=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.fromMiliseconds=tr.toMiliseconds=void 0;const t=Ps();function e(i){return i*t.ONE_THOUSAND}tr.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return tr.fromMiliseconds=r,tr}var Rs;function vh(){return Rs||(Rs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(bh(),t),e.__exportStar(Eh(),t)}(qi)),qi}var yr={},Fs;function Dh(){if(Fs)return yr;Fs=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return yr.Watch=t,yr.default=t,yr}var ki={},Fr={},Us;function xh(){if(Us)return Fr;Us=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.IWatch=void 0;class t{}return Fr.IWatch=t,Fr}var Ls;function Sh(){return Ls||(Ls=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Et.__exportStar(xh(),t)}(ki)),ki}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(vh(),t),e.__exportStar(Dh(),t),e.__exportStar(Sh(),t),e.__exportStar(Ps(),t)})(le);var Wi={},Ur={};class ir{}var Ih=Object.freeze({__proto__:null,IEvents:ir}),Oh=Li(Ih),Ms;function Ch(){if(Ms)return Ur;Ms=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.IHeartBeat=void 0;const t=Oh;class e extends t.IEvents{constructor(i){super()}}return Ur.IHeartBeat=e,Ur}var Bs;function $s(){return Bs||(Bs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Et.__exportStar(Ch(),t)}(Wi)),Wi}var Gi={},nr={},js;function Ah(){if(js)return nr;js=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.HEARTBEAT_EVENTS=nr.HEARTBEAT_INTERVAL=void 0;const t=le;return nr.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,nr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},nr}var Hs;function zs(){return Hs||(Hs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Et.__exportStar(Ah(),t)}(Gi)),Gi}var qs;function Th(){if(qs)return Nr;qs=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.HeartBeat=void 0;const t=Et,e=ot.exports,r=le,i=$s(),n=zs();class a extends i.IHeartBeat{constructor(o){super(o),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=o?.interval||n.HEARTBEAT_INTERVAL}static init(o){return t.__awaiter(this,void 0,void 0,function*(){const f=new a(o);return yield f.init(),f})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}on(o,f){this.events.on(o,f)}once(o,f){this.events.once(o,f)}off(o,f){this.events.off(o,f)}removeListener(o,f){this.events.removeListener(o,f)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return Nr.HeartBeat=a,Nr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(Th(),t),e.__exportStar($s(),t),e.__exportStar(zs(),t)})(Pr);var Oe={},sr={},Ks;function Vs(){return Ks||(Ks=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.PINO_CUSTOM_CONTEXT_KEY=sr.PINO_LOGGER_DEFAULTS=void 0,sr.PINO_LOGGER_DEFAULTS={level:"info"},sr.PINO_CUSTOM_CONTEXT_KEY="custom_context"),sr}var ct={},ks;function Ph(){if(ks)return ct;ks=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.generateChildLogger=ct.formatChildLoggerContext=ct.getLoggerContext=ct.setBrowserLoggerContext=ct.getBrowserLoggerContext=ct.getDefaultLoggerOptions=void 0;const t=Vs();function e(o){return Object.assign(Object.assign({},o),{level:o?.level||t.PINO_LOGGER_DEFAULTS.level})}ct.getDefaultLoggerOptions=e;function r(o,f=t.PINO_CUSTOM_CONTEXT_KEY){return o[f]||""}ct.getBrowserLoggerContext=r;function i(o,f,p=t.PINO_CUSTOM_CONTEXT_KEY){return o[p]=f,o}ct.setBrowserLoggerContext=i;function n(o,f=t.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof o.bindings>"u"?p=r(o,f):p=o.bindings().context||"",p}ct.getLoggerContext=n;function a(o,f,p=t.PINO_CUSTOM_CONTEXT_KEY){const m=n(o,p);return m.trim()?`${m}/${f}`:f}ct.formatChildLoggerContext=a;function l(o,f,p=t.PINO_CUSTOM_CONTEXT_KEY){const m=a(o,f,p),C=o.child({context:m});return i(C,m,p)}return ct.generateChildLogger=l,ct}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Et,r=e.__importDefault(Dr);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Vs(),t),e.__exportStar(Ph(),t)})(Oe);class Nh extends ir{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Rh extends ir{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Fh{constructor(e,r){this.logger=e,this.core=r}}class Uh extends ir{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Lh extends ir{constructor(e){super()}}class Mh{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class Bh extends ir{constructor(e,r){super(),this.relayer=e,this.logger=r}}class $h extends ir{constructor(e,r){super(),this.core=e,this.logger=r}}class jh{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Hh{constructor(e){this.client=e}}function Yi(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function Lr(t){return typeof t=="string"?t:JSON.stringify(t)}var Ji={},wr={},hi={},li={};Object.defineProperty(li,"__esModule",{value:!0}),li.BrowserRandomSource=void 0;const Ws=65536;class zh{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=Ws)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,Ws)));return r}}li.BrowserRandomSource=zh;function qh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fi={},yt={};Object.defineProperty(yt,"__esModule",{value:!0});function Kh(t){for(var e=0;e<t.length;e++)t[e]=0;return t}yt.wipe=Kh;var Vh={},kh=Object.freeze({__proto__:null,default:Vh}),Wh=Li(kh);Object.defineProperty(fi,"__esModule",{value:!0}),fi.NodeRandomSource=void 0;const Gh=yt;class Yh{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof qh<"u"){const e=Wh;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,Gh.wipe)(r),i}}fi.NodeRandomSource=Yh,Object.defineProperty(hi,"__esModule",{value:!0}),hi.SystemRandomSource=void 0;const Jh=li,Xh=fi;class Zh{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Jh.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Xh.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}hi.SystemRandomSource=Zh;var pe={},Gs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(o,f){var p=o>>>16&65535,m=o&65535,C=f>>>16&65535,L=f&65535;return m*L+(p*L+m*C<<16>>>0)|0}t.mul=Math.imul||e;function r(o,f){return o+f|0}t.add=r;function i(o,f){return o-f|0}t.sub=i;function n(o,f){return o<<f|o>>>32-f}t.rotl=n;function a(o,f){return o<<32-f|o>>>f}t.rotr=a;function l(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o}t.isInteger=Number.isInteger||l,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(o){return t.isInteger(o)&&o>=-t.MAX_SAFE_INTEGER&&o<=t.MAX_SAFE_INTEGER}})(Gs),Object.defineProperty(pe,"__esModule",{value:!0});var Ys=Gs;function Qh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}pe.readInt16BE=Qh;function el(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}pe.readUint16BE=el;function tl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}pe.readInt16LE=tl;function rl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}pe.readUint16LE=rl;function Js(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}pe.writeUint16BE=Js,pe.writeInt16BE=Js;function Xs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}pe.writeUint16LE=Xs,pe.writeInt16LE=Xs;function Xi(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}pe.readInt32BE=Xi;function Zi(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}pe.readUint32BE=Zi;function Qi(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}pe.readInt32LE=Qi;function en(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}pe.readUint32LE=en;function di(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}pe.writeUint32BE=di,pe.writeInt32BE=di;function pi(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}pe.writeUint32LE=pi,pe.writeInt32LE=pi;function il(t,e){e===void 0&&(e=0);var r=Xi(t,e),i=Xi(t,e+4);return r*4294967296+i-(i>>31)*4294967296}pe.readInt64BE=il;function nl(t,e){e===void 0&&(e=0);var r=Zi(t,e),i=Zi(t,e+4);return r*4294967296+i}pe.readUint64BE=nl;function sl(t,e){e===void 0&&(e=0);var r=Qi(t,e),i=Qi(t,e+4);return i*4294967296+r-(r>>31)*4294967296}pe.readInt64LE=sl;function ol(t,e){e===void 0&&(e=0);var r=en(t,e),i=en(t,e+4);return i*4294967296+r}pe.readUint64LE=ol;function Zs(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),di(t/4294967296>>>0,e,r),di(t>>>0,e,r+4),e}pe.writeUint64BE=Zs,pe.writeInt64BE=Zs;function Qs(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),pi(t>>>0,e,r),pi(t/4294967296>>>0,e,r+4),e}pe.writeUint64LE=Qs,pe.writeInt64LE=Qs;function al(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,a=t/8+r-1;a>=r;a--)i+=e[a]*n,n*=256;return i}pe.readUintBE=al;function cl(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,a=r;a<r+t/8;a++)i+=e[a]*n,n*=256;return i}pe.readUintLE=cl;function ul(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ys.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,a=t/8+i-1;a>=i;a--)r[a]=e/n&255,n*=256;return r}pe.writeUintBE=ul;function hl(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ys.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,a=i;a<i+t/8;a++)r[a]=e/n&255,n*=256;return r}pe.writeUintLE=hl;function ll(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}pe.readFloat32BE=ll;function fl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}pe.readFloat32LE=fl;function dl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}pe.readFloat64BE=dl;function pl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}pe.readFloat64LE=pl;function gl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}pe.writeFloat32BE=gl;function yl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}pe.writeFloat32LE=yl;function wl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}pe.writeFloat64BE=wl;function bl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}pe.writeFloat64LE=bl,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=hi,r=pe,i=yt;t.defaultRandomSource=new e.SystemRandomSource;function n(p,m=t.defaultRandomSource){return m.randomBytes(p)}t.randomBytes=n;function a(p=t.defaultRandomSource){const m=n(4,p),C=(0,r.readUint32LE)(m);return(0,i.wipe)(m),C}t.randomUint32=a;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function o(p,m=l,C=t.defaultRandomSource){if(m.length<2)throw new Error("randomString charset is too short");if(m.length>256)throw new Error("randomString charset is too long");let L="";const O=m.length,I=256-256%O;for(;p>0;){const $=n(Math.ceil(p*256/I),C);for(let B=0;B<$.length&&p>0;B++){const W=$[B];W<I&&(L+=m.charAt(W%O),p--)}(0,i.wipe)($)}return L}t.randomString=o;function f(p,m=l,C=t.defaultRandomSource){const L=Math.ceil(p/(Math.log(m.length)/Math.LN2));return o(L,m,C)}t.randomStringForEntropy=f}(wr);var eo={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=pe,r=yt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function o(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return o.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},o.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},o.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},o.prototype.update=function(f,p){if(p===void 0&&(p=f.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var m=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=f[m++],p--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(m=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,f,m,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=f[m++],p--;return this},o.prototype.finish=function(f){if(!this._finished){var p=this._bytesHashed,m=this._bufferLength,C=p/536870912|0,L=p<<3,O=p%128<112?128:256;this._buffer[m]=128;for(var I=m+1;I<O-8;I++)this._buffer[I]=0;e.writeUint32BE(C,this._buffer,O-8),e.writeUint32BE(L,this._buffer,O-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,O),this._finished=!0}for(var I=0;I<this.digestLength/8;I++)e.writeUint32BE(this._stateHi[I],f,I*8),e.writeUint32BE(this._stateLo[I],f,I*8+4);return this},o.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},o.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},o.prototype.restoreState=function(f){return this._stateHi.set(f.stateHi),this._stateLo.set(f.stateLo),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},o.prototype.cleanSavedState=function(f){r.wipe(f.stateHi),r.wipe(f.stateLo),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},o}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(o,f,p,m,C,L,O){for(var I=p[0],$=p[1],B=p[2],W=p[3],A=p[4],R=p[5],_=p[6],E=p[7],v=m[0],c=m[1],y=m[2],q=m[3],Y=m[4],Z=m[5],se=m[6],ne=m[7],w,D,K,k,H,j,G,z;O>=128;){for(var oe=0;oe<16;oe++){var J=8*oe+L;o[oe]=e.readUint32BE(C,J),f[oe]=e.readUint32BE(C,J+4)}for(var oe=0;oe<80;oe++){var ce=I,re=$,ge=B,U=W,F=A,T=R,h=_,x=E,X=v,Q=c,fe=y,xe=q,_e=Y,Se=Z,Fe=se,Ne=ne;if(w=E,D=ne,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=(A>>>14|Y<<32-14)^(A>>>18|Y<<32-18)^(Y>>>41-32|A<<32-(41-32)),D=(Y>>>14|A<<32-14)^(Y>>>18|A<<32-18)^(A>>>41-32|Y<<32-(41-32)),H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,w=A&R^~A&_,D=Y&Z^~Y&se,H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,w=n[oe*2],D=n[oe*2+1],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,w=o[oe%16],D=f[oe%16],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,K=G&65535|z<<16,k=H&65535|j<<16,w=K,D=k,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=(I>>>28|v<<32-28)^(v>>>34-32|I<<32-(34-32))^(v>>>39-32|I<<32-(39-32)),D=(v>>>28|I<<32-28)^(I>>>34-32|v<<32-(34-32))^(I>>>39-32|v<<32-(39-32)),H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,w=I&$^I&B^$&B,D=v&c^v&y^c&y,H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,x=G&65535|z<<16,Ne=H&65535|j<<16,w=U,D=xe,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=K,D=k,H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,U=G&65535|z<<16,xe=H&65535|j<<16,$=ce,B=re,W=ge,A=U,R=F,_=T,E=h,I=x,c=X,y=Q,q=fe,Y=xe,Z=_e,se=Se,ne=Fe,v=Ne,oe%16===15)for(var J=0;J<16;J++)w=o[J],D=f[J],H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=o[(J+9)%16],D=f[(J+9)%16],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,K=o[(J+1)%16],k=f[(J+1)%16],w=(K>>>1|k<<32-1)^(K>>>8|k<<32-8)^K>>>7,D=(k>>>1|K<<32-1)^(k>>>8|K<<32-8)^(k>>>7|K<<32-7),H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,K=o[(J+14)%16],k=f[(J+14)%16],w=(K>>>19|k<<32-19)^(k>>>61-32|K<<32-(61-32))^K>>>6,D=(k>>>19|K<<32-19)^(K>>>61-32|k<<32-(61-32))^(k>>>6|K<<32-6),H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,o[J]=G&65535|z<<16,f[J]=H&65535|j<<16}w=I,D=v,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=p[0],D=m[0],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,p[0]=I=G&65535|z<<16,m[0]=v=H&65535|j<<16,w=$,D=c,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=p[1],D=m[1],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,p[1]=$=G&65535|z<<16,m[1]=c=H&65535|j<<16,w=B,D=y,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=p[2],D=m[2],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,p[2]=B=G&65535|z<<16,m[2]=y=H&65535|j<<16,w=W,D=q,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=p[3],D=m[3],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,p[3]=W=G&65535|z<<16,m[3]=q=H&65535|j<<16,w=A,D=Y,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=p[4],D=m[4],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,p[4]=A=G&65535|z<<16,m[4]=Y=H&65535|j<<16,w=R,D=Z,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=p[5],D=m[5],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,p[5]=R=G&65535|z<<16,m[5]=Z=H&65535|j<<16,w=_,D=se,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=p[6],D=m[6],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,p[6]=_=G&65535|z<<16,m[6]=se=H&65535|j<<16,w=E,D=ne,H=D&65535,j=D>>>16,G=w&65535,z=w>>>16,w=p[7],D=m[7],H+=D&65535,j+=D>>>16,G+=w&65535,z+=w>>>16,j+=H>>>16,G+=j>>>16,z+=G>>>16,p[7]=E=G&65535|z<<16,m[7]=ne=H&65535|j<<16,L+=128,O-=128}return L}function l(o){var f=new i;f.update(o);var p=f.digest();return f.clean(),p}t.hash=l})(eo),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=wr,r=eo,i=yt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(U){const F=new Float64Array(16);if(U)for(let T=0;T<U.length;T++)F[T]=U[T];return F}const a=new Uint8Array(32);a[0]=9;const l=n(),o=n([1]),f=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),C=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),L=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function O(U,F){for(let T=0;T<16;T++)U[T]=F[T]|0}function I(U){let F=1;for(let T=0;T<16;T++){let h=U[T]+F+65535;F=Math.floor(h/65536),U[T]=h-F*65536}U[0]+=F-1+37*(F-1)}function $(U,F,T){const h=~(T-1);for(let x=0;x<16;x++){const X=h&(U[x]^F[x]);U[x]^=X,F[x]^=X}}function B(U,F){const T=n(),h=n();for(let x=0;x<16;x++)h[x]=F[x];I(h),I(h),I(h);for(let x=0;x<2;x++){T[0]=h[0]-65517;for(let Q=1;Q<15;Q++)T[Q]=h[Q]-65535-(T[Q-1]>>16&1),T[Q-1]&=65535;T[15]=h[15]-32767-(T[14]>>16&1);const X=T[15]>>16&1;T[14]&=65535,$(h,T,1-X)}for(let x=0;x<16;x++)U[2*x]=h[x]&255,U[2*x+1]=h[x]>>8}function W(U,F){let T=0;for(let h=0;h<32;h++)T|=U[h]^F[h];return(1&T-1>>>8)-1}function A(U,F){const T=new Uint8Array(32),h=new Uint8Array(32);return B(T,U),B(h,F),W(T,h)}function R(U){const F=new Uint8Array(32);return B(F,U),F[0]&1}function _(U,F){for(let T=0;T<16;T++)U[T]=F[2*T]+(F[2*T+1]<<8);U[15]&=32767}function E(U,F,T){for(let h=0;h<16;h++)U[h]=F[h]+T[h]}function v(U,F,T){for(let h=0;h<16;h++)U[h]=F[h]-T[h]}function c(U,F,T){let h,x,X=0,Q=0,fe=0,xe=0,_e=0,Se=0,Fe=0,Ne=0,Ee=0,be=0,he=0,ye=0,me=0,ue=0,de=0,d=0,s=0,u=0,g=0,S=0,N=0,M=0,te=0,ae=0,ve=0,Ie=0,De=0,pt=0,Xt=0,_r=0,Xr=0,je=T[0],Le=T[1],He=T[2],ze=T[3],qe=T[4],Me=T[5],We=T[6],Ge=T[7],Ye=T[8],Je=T[9],Xe=T[10],Ve=T[11],Ke=T[12],Re=T[13],Ze=T[14],Qe=T[15];h=F[0],X+=h*je,Q+=h*Le,fe+=h*He,xe+=h*ze,_e+=h*qe,Se+=h*Me,Fe+=h*We,Ne+=h*Ge,Ee+=h*Ye,be+=h*Je,he+=h*Xe,ye+=h*Ve,me+=h*Ke,ue+=h*Re,de+=h*Ze,d+=h*Qe,h=F[1],Q+=h*je,fe+=h*Le,xe+=h*He,_e+=h*ze,Se+=h*qe,Fe+=h*Me,Ne+=h*We,Ee+=h*Ge,be+=h*Ye,he+=h*Je,ye+=h*Xe,me+=h*Ve,ue+=h*Ke,de+=h*Re,d+=h*Ze,s+=h*Qe,h=F[2],fe+=h*je,xe+=h*Le,_e+=h*He,Se+=h*ze,Fe+=h*qe,Ne+=h*Me,Ee+=h*We,be+=h*Ge,he+=h*Ye,ye+=h*Je,me+=h*Xe,ue+=h*Ve,de+=h*Ke,d+=h*Re,s+=h*Ze,u+=h*Qe,h=F[3],xe+=h*je,_e+=h*Le,Se+=h*He,Fe+=h*ze,Ne+=h*qe,Ee+=h*Me,be+=h*We,he+=h*Ge,ye+=h*Ye,me+=h*Je,ue+=h*Xe,de+=h*Ve,d+=h*Ke,s+=h*Re,u+=h*Ze,g+=h*Qe,h=F[4],_e+=h*je,Se+=h*Le,Fe+=h*He,Ne+=h*ze,Ee+=h*qe,be+=h*Me,he+=h*We,ye+=h*Ge,me+=h*Ye,ue+=h*Je,de+=h*Xe,d+=h*Ve,s+=h*Ke,u+=h*Re,g+=h*Ze,S+=h*Qe,h=F[5],Se+=h*je,Fe+=h*Le,Ne+=h*He,Ee+=h*ze,be+=h*qe,he+=h*Me,ye+=h*We,me+=h*Ge,ue+=h*Ye,de+=h*Je,d+=h*Xe,s+=h*Ve,u+=h*Ke,g+=h*Re,S+=h*Ze,N+=h*Qe,h=F[6],Fe+=h*je,Ne+=h*Le,Ee+=h*He,be+=h*ze,he+=h*qe,ye+=h*Me,me+=h*We,ue+=h*Ge,de+=h*Ye,d+=h*Je,s+=h*Xe,u+=h*Ve,g+=h*Ke,S+=h*Re,N+=h*Ze,M+=h*Qe,h=F[7],Ne+=h*je,Ee+=h*Le,be+=h*He,he+=h*ze,ye+=h*qe,me+=h*Me,ue+=h*We,de+=h*Ge,d+=h*Ye,s+=h*Je,u+=h*Xe,g+=h*Ve,S+=h*Ke,N+=h*Re,M+=h*Ze,te+=h*Qe,h=F[8],Ee+=h*je,be+=h*Le,he+=h*He,ye+=h*ze,me+=h*qe,ue+=h*Me,de+=h*We,d+=h*Ge,s+=h*Ye,u+=h*Je,g+=h*Xe,S+=h*Ve,N+=h*Ke,M+=h*Re,te+=h*Ze,ae+=h*Qe,h=F[9],be+=h*je,he+=h*Le,ye+=h*He,me+=h*ze,ue+=h*qe,de+=h*Me,d+=h*We,s+=h*Ge,u+=h*Ye,g+=h*Je,S+=h*Xe,N+=h*Ve,M+=h*Ke,te+=h*Re,ae+=h*Ze,ve+=h*Qe,h=F[10],he+=h*je,ye+=h*Le,me+=h*He,ue+=h*ze,de+=h*qe,d+=h*Me,s+=h*We,u+=h*Ge,g+=h*Ye,S+=h*Je,N+=h*Xe,M+=h*Ve,te+=h*Ke,ae+=h*Re,ve+=h*Ze,Ie+=h*Qe,h=F[11],ye+=h*je,me+=h*Le,ue+=h*He,de+=h*ze,d+=h*qe,s+=h*Me,u+=h*We,g+=h*Ge,S+=h*Ye,N+=h*Je,M+=h*Xe,te+=h*Ve,ae+=h*Ke,ve+=h*Re,Ie+=h*Ze,De+=h*Qe,h=F[12],me+=h*je,ue+=h*Le,de+=h*He,d+=h*ze,s+=h*qe,u+=h*Me,g+=h*We,S+=h*Ge,N+=h*Ye,M+=h*Je,te+=h*Xe,ae+=h*Ve,ve+=h*Ke,Ie+=h*Re,De+=h*Ze,pt+=h*Qe,h=F[13],ue+=h*je,de+=h*Le,d+=h*He,s+=h*ze,u+=h*qe,g+=h*Me,S+=h*We,N+=h*Ge,M+=h*Ye,te+=h*Je,ae+=h*Xe,ve+=h*Ve,Ie+=h*Ke,De+=h*Re,pt+=h*Ze,Xt+=h*Qe,h=F[14],de+=h*je,d+=h*Le,s+=h*He,u+=h*ze,g+=h*qe,S+=h*Me,N+=h*We,M+=h*Ge,te+=h*Ye,ae+=h*Je,ve+=h*Xe,Ie+=h*Ve,De+=h*Ke,pt+=h*Re,Xt+=h*Ze,_r+=h*Qe,h=F[15],d+=h*je,s+=h*Le,u+=h*He,g+=h*ze,S+=h*qe,N+=h*Me,M+=h*We,te+=h*Ge,ae+=h*Ye,ve+=h*Je,Ie+=h*Xe,De+=h*Ve,pt+=h*Ke,Xt+=h*Re,_r+=h*Ze,Xr+=h*Qe,X+=38*s,Q+=38*u,fe+=38*g,xe+=38*S,_e+=38*N,Se+=38*M,Fe+=38*te,Ne+=38*ae,Ee+=38*ve,be+=38*Ie,he+=38*De,ye+=38*pt,me+=38*Xt,ue+=38*_r,de+=38*Xr,x=1,h=X+x+65535,x=Math.floor(h/65536),X=h-x*65536,h=Q+x+65535,x=Math.floor(h/65536),Q=h-x*65536,h=fe+x+65535,x=Math.floor(h/65536),fe=h-x*65536,h=xe+x+65535,x=Math.floor(h/65536),xe=h-x*65536,h=_e+x+65535,x=Math.floor(h/65536),_e=h-x*65536,h=Se+x+65535,x=Math.floor(h/65536),Se=h-x*65536,h=Fe+x+65535,x=Math.floor(h/65536),Fe=h-x*65536,h=Ne+x+65535,x=Math.floor(h/65536),Ne=h-x*65536,h=Ee+x+65535,x=Math.floor(h/65536),Ee=h-x*65536,h=be+x+65535,x=Math.floor(h/65536),be=h-x*65536,h=he+x+65535,x=Math.floor(h/65536),he=h-x*65536,h=ye+x+65535,x=Math.floor(h/65536),ye=h-x*65536,h=me+x+65535,x=Math.floor(h/65536),me=h-x*65536,h=ue+x+65535,x=Math.floor(h/65536),ue=h-x*65536,h=de+x+65535,x=Math.floor(h/65536),de=h-x*65536,h=d+x+65535,x=Math.floor(h/65536),d=h-x*65536,X+=x-1+37*(x-1),x=1,h=X+x+65535,x=Math.floor(h/65536),X=h-x*65536,h=Q+x+65535,x=Math.floor(h/65536),Q=h-x*65536,h=fe+x+65535,x=Math.floor(h/65536),fe=h-x*65536,h=xe+x+65535,x=Math.floor(h/65536),xe=h-x*65536,h=_e+x+65535,x=Math.floor(h/65536),_e=h-x*65536,h=Se+x+65535,x=Math.floor(h/65536),Se=h-x*65536,h=Fe+x+65535,x=Math.floor(h/65536),Fe=h-x*65536,h=Ne+x+65535,x=Math.floor(h/65536),Ne=h-x*65536,h=Ee+x+65535,x=Math.floor(h/65536),Ee=h-x*65536,h=be+x+65535,x=Math.floor(h/65536),be=h-x*65536,h=he+x+65535,x=Math.floor(h/65536),he=h-x*65536,h=ye+x+65535,x=Math.floor(h/65536),ye=h-x*65536,h=me+x+65535,x=Math.floor(h/65536),me=h-x*65536,h=ue+x+65535,x=Math.floor(h/65536),ue=h-x*65536,h=de+x+65535,x=Math.floor(h/65536),de=h-x*65536,h=d+x+65535,x=Math.floor(h/65536),d=h-x*65536,X+=x-1+37*(x-1),U[0]=X,U[1]=Q,U[2]=fe,U[3]=xe,U[4]=_e,U[5]=Se,U[6]=Fe,U[7]=Ne,U[8]=Ee,U[9]=be,U[10]=he,U[11]=ye,U[12]=me,U[13]=ue,U[14]=de,U[15]=d}function y(U,F){c(U,F,F)}function q(U,F){const T=n();let h;for(h=0;h<16;h++)T[h]=F[h];for(h=253;h>=0;h--)y(T,T),h!==2&&h!==4&&c(T,T,F);for(h=0;h<16;h++)U[h]=T[h]}function Y(U,F){const T=n();let h;for(h=0;h<16;h++)T[h]=F[h];for(h=250;h>=0;h--)y(T,T),h!==1&&c(T,T,F);for(h=0;h<16;h++)U[h]=T[h]}function Z(U,F){const T=n(),h=n(),x=n(),X=n(),Q=n(),fe=n(),xe=n(),_e=n(),Se=n();v(T,U[1],U[0]),v(Se,F[1],F[0]),c(T,T,Se),E(h,U[0],U[1]),E(Se,F[0],F[1]),c(h,h,Se),c(x,U[3],F[3]),c(x,x,p),c(X,U[2],F[2]),E(X,X,X),v(Q,h,T),v(fe,X,x),E(xe,X,x),E(_e,h,T),c(U[0],Q,fe),c(U[1],_e,xe),c(U[2],xe,fe),c(U[3],Q,_e)}function se(U,F,T){for(let h=0;h<4;h++)$(U[h],F[h],T)}function ne(U,F){const T=n(),h=n(),x=n();q(x,F[2]),c(T,F[0],x),c(h,F[1],x),B(U,h),U[31]^=R(T)<<7}function w(U,F,T){O(U[0],l),O(U[1],o),O(U[2],o),O(U[3],l);for(let h=255;h>=0;--h){const x=T[h/8|0]>>(h&7)&1;se(U,F,x),Z(F,U),Z(U,U),se(U,F,x)}}function D(U,F){const T=[n(),n(),n(),n()];O(T[0],m),O(T[1],C),O(T[2],o),c(T[3],m,C),w(U,T,F)}function K(U){if(U.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const F=(0,r.hash)(U);F[0]&=248,F[31]&=127,F[31]|=64;const T=new Uint8Array(32),h=[n(),n(),n(),n()];D(h,F),ne(T,h);const x=new Uint8Array(64);return x.set(U),x.set(T,32),{publicKey:T,secretKey:x}}t.generateKeyPairFromSeed=K;function k(U){const F=(0,e.randomBytes)(32,U),T=K(F);return(0,i.wipe)(F),T}t.generateKeyPair=k;function H(U){if(U.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(U.subarray(32))}t.extractPublicKeyFromSecretKey=H;const j=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function G(U,F){let T,h,x,X;for(h=63;h>=32;--h){for(T=0,x=h-32,X=h-12;x<X;++x)F[x]+=T-16*F[h]*j[x-(h-32)],T=Math.floor((F[x]+128)/256),F[x]-=T*256;F[x]+=T,F[h]=0}for(T=0,x=0;x<32;x++)F[x]+=T-(F[31]>>4)*j[x],T=F[x]>>8,F[x]&=255;for(x=0;x<32;x++)F[x]-=T*j[x];for(h=0;h<32;h++)F[h+1]+=F[h]>>8,U[h]=F[h]&255}function z(U){const F=new Float64Array(64);for(let T=0;T<64;T++)F[T]=U[T];for(let T=0;T<64;T++)U[T]=0;G(U,F)}function oe(U,F){const T=new Float64Array(64),h=[n(),n(),n(),n()],x=(0,r.hash)(U.subarray(0,32));x[0]&=248,x[31]&=127,x[31]|=64;const X=new Uint8Array(64);X.set(x.subarray(32),32);const Q=new r.SHA512;Q.update(X.subarray(32)),Q.update(F);const fe=Q.digest();Q.clean(),z(fe),D(h,fe),ne(X,h),Q.reset(),Q.update(X.subarray(0,32)),Q.update(U.subarray(32)),Q.update(F);const xe=Q.digest();z(xe);for(let _e=0;_e<32;_e++)T[_e]=fe[_e];for(let _e=0;_e<32;_e++)for(let Se=0;Se<32;Se++)T[_e+Se]+=xe[_e]*x[Se];return G(X.subarray(32),T),X}t.sign=oe;function J(U,F){const T=n(),h=n(),x=n(),X=n(),Q=n(),fe=n(),xe=n();return O(U[2],o),_(U[1],F),y(x,U[1]),c(X,x,f),v(x,x,U[2]),E(X,U[2],X),y(Q,X),y(fe,Q),c(xe,fe,Q),c(T,xe,x),c(T,T,X),Y(T,T),c(T,T,x),c(T,T,X),c(T,T,X),c(U[0],T,X),y(h,U[0]),c(h,h,X),A(h,x)&&c(U[0],U[0],L),y(h,U[0]),c(h,h,X),A(h,x)?-1:(R(U[0])===F[31]>>7&&v(U[0],l,U[0]),c(U[3],U[0],U[1]),0)}function ce(U,F,T){const h=new Uint8Array(32),x=[n(),n(),n(),n()],X=[n(),n(),n(),n()];if(T.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(J(X,U))return!1;const Q=new r.SHA512;Q.update(T.subarray(0,32)),Q.update(U),Q.update(F);const fe=Q.digest();return z(fe),w(x,X,fe),D(X,T.subarray(32)),Z(x,X),ne(h,x),!W(T,h)}t.verify=ce;function re(U){let F=[n(),n(),n(),n()];if(J(F,U))throw new Error("Ed25519: invalid public key");let T=n(),h=n(),x=F[1];E(T,o,x),v(h,o,x),q(h,h),c(T,T,h);let X=new Uint8Array(32);return B(X,T),X}t.convertPublicKeyToX25519=re;function ge(U){const F=(0,r.hash)(U.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const T=new Uint8Array(F.subarray(0,32));return(0,i.wipe)(F),T}t.convertSecretKeyToX25519=ge}(Ji);const ml="EdDSA",_l="JWT",to=".",ro="base64url",El="utf8",vl="utf8",Dl=":",xl="did",Sl="key",io="base58btc",Il="z",Ol="K36",Cl=32;function tn(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function no(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?tn(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Al(t,e){e||(e=t.reduce((n,a)=>n+a.length,0));const r=no(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return tn(r)}function Tl(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var a=t.charAt(n),l=a.charCodeAt(0);if(r[l]!==255)throw new TypeError(a+" is ambiguous");r[l]=n}var o=t.length,f=t.charAt(0),p=Math.log(o)/Math.log(256),m=Math.log(256)/Math.log(o);function C(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(I.length===0)return"";for(var $=0,B=0,W=0,A=I.length;W!==A&&I[W]===0;)W++,$++;for(var R=(A-W)*m+1>>>0,_=new Uint8Array(R);W!==A;){for(var E=I[W],v=0,c=R-1;(E!==0||v<B)&&c!==-1;c--,v++)E+=256*_[c]>>>0,_[c]=E%o>>>0,E=E/o>>>0;if(E!==0)throw new Error("Non-zero carry");B=v,W++}for(var y=R-B;y!==R&&_[y]===0;)y++;for(var q=f.repeat($);y<R;++y)q+=t.charAt(_[y]);return q}function L(I){if(typeof I!="string")throw new TypeError("Expected String");if(I.length===0)return new Uint8Array;var $=0;if(I[$]!==" "){for(var B=0,W=0;I[$]===f;)B++,$++;for(var A=(I.length-$)*p+1>>>0,R=new Uint8Array(A);I[$];){var _=r[I.charCodeAt($)];if(_===255)return;for(var E=0,v=A-1;(_!==0||E<W)&&v!==-1;v--,E++)_+=o*R[v]>>>0,R[v]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");W=E,$++}if(I[$]!==" "){for(var c=A-W;c!==A&&R[c]===0;)c++;for(var y=new Uint8Array(B+(A-c)),q=B;c!==A;)y[q++]=R[c++];return y}}}function O(I){var $=L(I);if($)return $;throw new Error(`Non-${e} character`)}return{encode:C,decodeUnsafe:L,decode:O}}var Pl=Tl,Nl=Pl;const so=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Rl=t=>new TextEncoder().encode(t),Fl=t=>new TextDecoder().decode(t);class Ul{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ll{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return oo(this,e)}}class Ml{constructor(e){this.decoders=e}or(e){return oo(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const oo=(t,e)=>new Ml({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Bl{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Ul(e,r,i),this.decoder=new Ll(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const gi=({name:t,prefix:e,encode:r,decode:i})=>new Bl(t,e,r,i),Mr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Nl(r,e);return gi({prefix:t,name:e,encode:i,decode:a=>so(n(a))})},$l=(t,e,r,i)=>{const n={};for(let m=0;m<e.length;++m)n[e[m]]=m;let a=t.length;for(;t[a-1]==="=";)--a;const l=new Uint8Array(a*r/8|0);let o=0,f=0,p=0;for(let m=0;m<a;++m){const C=n[t[m]];if(C===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|C,o+=r,o>=8&&(o-=8,l[p++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return l},jl=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let a="",l=0,o=0;for(let f=0;f<t.length;++f)for(o=o<<8|t[f],l+=8;l>r;)l-=r,a+=e[n&o>>l];if(l&&(a+=e[n&o<<r-l]),i)for(;a.length*r&7;)a+="=";return a},rt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>gi({prefix:e,name:t,encode(n){return jl(n,i,r)},decode(n){return $l(n,i,r,t)}}),Hl=gi({prefix:"\0",name:"identity",encode:t=>Fl(t),decode:t=>Rl(t)});var zl=Object.freeze({__proto__:null,identity:Hl});const ql=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Kl=Object.freeze({__proto__:null,base2:ql});const Vl=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var kl=Object.freeze({__proto__:null,base8:Vl});const Wl=Mr({prefix:"9",name:"base10",alphabet:"0123456789"});var Gl=Object.freeze({__proto__:null,base10:Wl});const Yl=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Jl=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Xl=Object.freeze({__proto__:null,base16:Yl,base16upper:Jl});const Zl=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ql=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ef=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),tf=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),rf=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),nf=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),sf=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),of=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),af=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var cf=Object.freeze({__proto__:null,base32:Zl,base32upper:Ql,base32pad:ef,base32padupper:tf,base32hex:rf,base32hexupper:nf,base32hexpad:sf,base32hexpadupper:of,base32z:af});const uf=Mr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),hf=Mr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var lf=Object.freeze({__proto__:null,base36:uf,base36upper:hf});const ff=Mr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),df=Mr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var pf=Object.freeze({__proto__:null,base58btc:ff,base58flickr:df});const gf=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),yf=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),wf=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),bf=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var mf=Object.freeze({__proto__:null,base64:gf,base64pad:yf,base64url:wf,base64urlpad:bf});const ao=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),_f=ao.reduce((t,e,r)=>(t[r]=e,t),[]),Ef=ao.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function vf(t){return t.reduce((e,r)=>(e+=_f[r],e),"")}function Df(t){const e=[];for(const r of t){const i=Ef[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const xf=gi({prefix:"\u{1F680}",name:"base256emoji",encode:vf,decode:Df});var Sf=Object.freeze({__proto__:null,base256emoji:xf}),If=uo,co=128,Of=127,Cf=~Of,Af=Math.pow(2,31);function uo(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Af;)e[r++]=t&255|co,t/=128;for(;t&Cf;)e[r++]=t&255|co,t>>>=7;return e[r]=t|0,uo.bytes=r-i+1,e}var Tf=rn,Pf=128,ho=127;function rn(t,i){var r=0,i=i||0,n=0,a=i,l,o=t.length;do{if(a>=o)throw rn.bytes=0,new RangeError("Could not decode varint");l=t[a++],r+=n<28?(l&ho)<<n:(l&ho)*Math.pow(2,n),n+=7}while(l>=Pf);return rn.bytes=a-i,r}var Nf=Math.pow(2,7),Rf=Math.pow(2,14),Ff=Math.pow(2,21),Uf=Math.pow(2,28),Lf=Math.pow(2,35),Mf=Math.pow(2,42),Bf=Math.pow(2,49),$f=Math.pow(2,56),jf=Math.pow(2,63),Hf=function(t){return t<Nf?1:t<Rf?2:t<Ff?3:t<Uf?4:t<Lf?5:t<Mf?6:t<Bf?7:t<$f?8:t<jf?9:10},zf={encode:If,decode:Tf,encodingLength:Hf},lo=zf;const fo=(t,e,r=0)=>(lo.encode(t,e,r),e),po=t=>lo.encodingLength(t),nn=(t,e)=>{const r=e.byteLength,i=po(t),n=i+po(r),a=new Uint8Array(n+r);return fo(t,a,0),fo(r,a,i),a.set(e,n),new qf(t,r,e,a)};class qf{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const go=({name:t,code:e,encode:r})=>new Kf(t,e,r);class Kf{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?nn(this.code,r):r.then(i=>nn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const yo=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Vf=go({name:"sha2-256",code:18,encode:yo("SHA-256")}),kf=go({name:"sha2-512",code:19,encode:yo("SHA-512")});var Wf=Object.freeze({__proto__:null,sha256:Vf,sha512:kf});const wo=0,Gf="identity",bo=so,Yf=t=>nn(wo,bo(t)),Jf={code:wo,name:Gf,encode:bo,digest:Yf};var Xf=Object.freeze({__proto__:null,identity:Jf});new TextEncoder,new TextDecoder;const yi={...zl,...Kl,...kl,...Gl,...Xl,...cf,...lf,...pf,...mf,...Sf};({...Wf,...Xf});function mo(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const _o=mo("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),sn=mo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=no(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Eo={utf8:_o,"utf-8":_o,hex:yi.base16,latin1:sn,ascii:sn,binary:sn,...yi};function on(t,e="utf8"){const r=Eo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function an(t,e="utf8"){const r=Eo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?tn(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function wi(t){return on(an(Lr(t),El),ro)}function vo(t){const e=an(Ol,io),r=Il+on(Al([e,t]),io);return[xl,Sl,r].join(Dl)}function Zf(t){return on(t,ro)}function Qf(t){return an([wi(t.header),wi(t.payload)].join(to),vl)}function ed(t){return[wi(t.header),wi(t.payload),Zf(t.signature)].join(to)}function Do(t=wr.randomBytes(Cl)){return Ji.generateKeyPairFromSeed(t)}async function td(t,e,r,i,n=le.fromMiliseconds(Date.now())){const a={alg:ml,typ:_l},l=vo(i.publicKey),o=n+r,f={iss:l,sub:t,aud:e,iat:n,exp:o},p=Qf({header:a,payload:f}),m=Ji.sign(i.secretKey,p);return ed({header:a,payload:f,signature:m})}var cn={},bi={};Object.defineProperty(bi,"__esModule",{value:!0});var at=pe,un=yt,rd=20;function id(t,e,r){for(var i=1634760805,n=857760878,a=2036477234,l=1797285236,o=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],p=r[11]<<24|r[10]<<16|r[9]<<8|r[8],m=r[15]<<24|r[14]<<16|r[13]<<8|r[12],C=r[19]<<24|r[18]<<16|r[17]<<8|r[16],L=r[23]<<24|r[22]<<16|r[21]<<8|r[20],O=r[27]<<24|r[26]<<16|r[25]<<8|r[24],I=r[31]<<24|r[30]<<16|r[29]<<8|r[28],$=e[3]<<24|e[2]<<16|e[1]<<8|e[0],B=e[7]<<24|e[6]<<16|e[5]<<8|e[4],W=e[11]<<24|e[10]<<16|e[9]<<8|e[8],A=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=i,_=n,E=a,v=l,c=o,y=f,q=p,Y=m,Z=C,se=L,ne=O,w=I,D=$,K=B,k=W,H=A,j=0;j<rd;j+=2)R=R+c|0,D^=R,D=D>>>32-16|D<<16,Z=Z+D|0,c^=Z,c=c>>>32-12|c<<12,_=_+y|0,K^=_,K=K>>>32-16|K<<16,se=se+K|0,y^=se,y=y>>>32-12|y<<12,E=E+q|0,k^=E,k=k>>>32-16|k<<16,ne=ne+k|0,q^=ne,q=q>>>32-12|q<<12,v=v+Y|0,H^=v,H=H>>>32-16|H<<16,w=w+H|0,Y^=w,Y=Y>>>32-12|Y<<12,E=E+q|0,k^=E,k=k>>>32-8|k<<8,ne=ne+k|0,q^=ne,q=q>>>32-7|q<<7,v=v+Y|0,H^=v,H=H>>>32-8|H<<8,w=w+H|0,Y^=w,Y=Y>>>32-7|Y<<7,_=_+y|0,K^=_,K=K>>>32-8|K<<8,se=se+K|0,y^=se,y=y>>>32-7|y<<7,R=R+c|0,D^=R,D=D>>>32-8|D<<8,Z=Z+D|0,c^=Z,c=c>>>32-7|c<<7,R=R+y|0,H^=R,H=H>>>32-16|H<<16,ne=ne+H|0,y^=ne,y=y>>>32-12|y<<12,_=_+q|0,D^=_,D=D>>>32-16|D<<16,w=w+D|0,q^=w,q=q>>>32-12|q<<12,E=E+Y|0,K^=E,K=K>>>32-16|K<<16,Z=Z+K|0,Y^=Z,Y=Y>>>32-12|Y<<12,v=v+c|0,k^=v,k=k>>>32-16|k<<16,se=se+k|0,c^=se,c=c>>>32-12|c<<12,E=E+Y|0,K^=E,K=K>>>32-8|K<<8,Z=Z+K|0,Y^=Z,Y=Y>>>32-7|Y<<7,v=v+c|0,k^=v,k=k>>>32-8|k<<8,se=se+k|0,c^=se,c=c>>>32-7|c<<7,_=_+q|0,D^=_,D=D>>>32-8|D<<8,w=w+D|0,q^=w,q=q>>>32-7|q<<7,R=R+y|0,H^=R,H=H>>>32-8|H<<8,ne=ne+H|0,y^=ne,y=y>>>32-7|y<<7;at.writeUint32LE(R+i|0,t,0),at.writeUint32LE(_+n|0,t,4),at.writeUint32LE(E+a|0,t,8),at.writeUint32LE(v+l|0,t,12),at.writeUint32LE(c+o|0,t,16),at.writeUint32LE(y+f|0,t,20),at.writeUint32LE(q+p|0,t,24),at.writeUint32LE(Y+m|0,t,28),at.writeUint32LE(Z+C|0,t,32),at.writeUint32LE(se+L|0,t,36),at.writeUint32LE(ne+O|0,t,40),at.writeUint32LE(w+I|0,t,44),at.writeUint32LE(D+$|0,t,48),at.writeUint32LE(K+B|0,t,52),at.writeUint32LE(k+W|0,t,56),at.writeUint32LE(H+A|0,t,60)}function xo(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var a,l;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");a=new Uint8Array(16),l=a.length-e.length,a.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");a=e,l=n}for(var o=new Uint8Array(64),f=0;f<r.length;f+=64){id(o,a,t);for(var p=f;p<f+64&&p<r.length;p++)i[p]=r[p]^o[p-f];sd(a,0,l)}return un.wipe(o),n===0&&un.wipe(a),i}bi.streamXOR=xo;function nd(t,e,r,i){return i===void 0&&(i=0),un.wipe(r),xo(t,e,r,r,i)}bi.stream=nd;function sd(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var So={},Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});function od(t,e,r){return~(t-1)&e|t-1&r}Vt.select=od;function ad(t,e){return(t|0)-(e|0)-1>>>31&1}Vt.lessOrEqual=ad;function Io(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}Vt.compare=Io;function cd(t,e){return t.length===0||e.length===0?!1:Io(t,e)!==0}Vt.equal=cd,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Vt,r=yt;t.DIGEST_LENGTH=16;var i=function(){function l(o){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var f=o[0]|o[1]<<8;this._r[0]=f&8191;var p=o[2]|o[3]<<8;this._r[1]=(f>>>13|p<<3)&8191;var m=o[4]|o[5]<<8;this._r[2]=(p>>>10|m<<6)&7939;var C=o[6]|o[7]<<8;this._r[3]=(m>>>7|C<<9)&8191;var L=o[8]|o[9]<<8;this._r[4]=(C>>>4|L<<12)&255,this._r[5]=L>>>1&8190;var O=o[10]|o[11]<<8;this._r[6]=(L>>>14|O<<2)&8191;var I=o[12]|o[13]<<8;this._r[7]=(O>>>11|I<<5)&8065;var $=o[14]|o[15]<<8;this._r[8]=(I>>>8|$<<8)&8191,this._r[9]=$>>>5&127,this._pad[0]=o[16]|o[17]<<8,this._pad[1]=o[18]|o[19]<<8,this._pad[2]=o[20]|o[21]<<8,this._pad[3]=o[22]|o[23]<<8,this._pad[4]=o[24]|o[25]<<8,this._pad[5]=o[26]|o[27]<<8,this._pad[6]=o[28]|o[29]<<8,this._pad[7]=o[30]|o[31]<<8}return l.prototype._blocks=function(o,f,p){for(var m=this._fin?0:2048,C=this._h[0],L=this._h[1],O=this._h[2],I=this._h[3],$=this._h[4],B=this._h[5],W=this._h[6],A=this._h[7],R=this._h[8],_=this._h[9],E=this._r[0],v=this._r[1],c=this._r[2],y=this._r[3],q=this._r[4],Y=this._r[5],Z=this._r[6],se=this._r[7],ne=this._r[8],w=this._r[9];p>=16;){var D=o[f+0]|o[f+1]<<8;C+=D&8191;var K=o[f+2]|o[f+3]<<8;L+=(D>>>13|K<<3)&8191;var k=o[f+4]|o[f+5]<<8;O+=(K>>>10|k<<6)&8191;var H=o[f+6]|o[f+7]<<8;I+=(k>>>7|H<<9)&8191;var j=o[f+8]|o[f+9]<<8;$+=(H>>>4|j<<12)&8191,B+=j>>>1&8191;var G=o[f+10]|o[f+11]<<8;W+=(j>>>14|G<<2)&8191;var z=o[f+12]|o[f+13]<<8;A+=(G>>>11|z<<5)&8191;var oe=o[f+14]|o[f+15]<<8;R+=(z>>>8|oe<<8)&8191,_+=oe>>>5|m;var J=0,ce=J;ce+=C*E,ce+=L*(5*w),ce+=O*(5*ne),ce+=I*(5*se),ce+=$*(5*Z),J=ce>>>13,ce&=8191,ce+=B*(5*Y),ce+=W*(5*q),ce+=A*(5*y),ce+=R*(5*c),ce+=_*(5*v),J+=ce>>>13,ce&=8191;var re=J;re+=C*v,re+=L*E,re+=O*(5*w),re+=I*(5*ne),re+=$*(5*se),J=re>>>13,re&=8191,re+=B*(5*Z),re+=W*(5*Y),re+=A*(5*q),re+=R*(5*y),re+=_*(5*c),J+=re>>>13,re&=8191;var ge=J;ge+=C*c,ge+=L*v,ge+=O*E,ge+=I*(5*w),ge+=$*(5*ne),J=ge>>>13,ge&=8191,ge+=B*(5*se),ge+=W*(5*Z),ge+=A*(5*Y),ge+=R*(5*q),ge+=_*(5*y),J+=ge>>>13,ge&=8191;var U=J;U+=C*y,U+=L*c,U+=O*v,U+=I*E,U+=$*(5*w),J=U>>>13,U&=8191,U+=B*(5*ne),U+=W*(5*se),U+=A*(5*Z),U+=R*(5*Y),U+=_*(5*q),J+=U>>>13,U&=8191;var F=J;F+=C*q,F+=L*y,F+=O*c,F+=I*v,F+=$*E,J=F>>>13,F&=8191,F+=B*(5*w),F+=W*(5*ne),F+=A*(5*se),F+=R*(5*Z),F+=_*(5*Y),J+=F>>>13,F&=8191;var T=J;T+=C*Y,T+=L*q,T+=O*y,T+=I*c,T+=$*v,J=T>>>13,T&=8191,T+=B*E,T+=W*(5*w),T+=A*(5*ne),T+=R*(5*se),T+=_*(5*Z),J+=T>>>13,T&=8191;var h=J;h+=C*Z,h+=L*Y,h+=O*q,h+=I*y,h+=$*c,J=h>>>13,h&=8191,h+=B*v,h+=W*E,h+=A*(5*w),h+=R*(5*ne),h+=_*(5*se),J+=h>>>13,h&=8191;var x=J;x+=C*se,x+=L*Z,x+=O*Y,x+=I*q,x+=$*y,J=x>>>13,x&=8191,x+=B*c,x+=W*v,x+=A*E,x+=R*(5*w),x+=_*(5*ne),J+=x>>>13,x&=8191;var X=J;X+=C*ne,X+=L*se,X+=O*Z,X+=I*Y,X+=$*q,J=X>>>13,X&=8191,X+=B*y,X+=W*c,X+=A*v,X+=R*E,X+=_*(5*w),J+=X>>>13,X&=8191;var Q=J;Q+=C*w,Q+=L*ne,Q+=O*se,Q+=I*Z,Q+=$*Y,J=Q>>>13,Q&=8191,Q+=B*q,Q+=W*y,Q+=A*c,Q+=R*v,Q+=_*E,J+=Q>>>13,Q&=8191,J=(J<<2)+J|0,J=J+ce|0,ce=J&8191,J=J>>>13,re+=J,C=ce,L=re,O=ge,I=U,$=F,B=T,W=h,A=x,R=X,_=Q,f+=16,p-=16}this._h[0]=C,this._h[1]=L,this._h[2]=O,this._h[3]=I,this._h[4]=$,this._h[5]=B,this._h[6]=W,this._h[7]=A,this._h[8]=R,this._h[9]=_},l.prototype.finish=function(o,f){f===void 0&&(f=0);var p=new Uint16Array(10),m,C,L,O;if(this._leftover){for(O=this._leftover,this._buffer[O++]=1;O<16;O++)this._buffer[O]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(m=this._h[1]>>>13,this._h[1]&=8191,O=2;O<10;O++)this._h[O]+=m,m=this._h[O]>>>13,this._h[O]&=8191;for(this._h[0]+=m*5,m=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=m,m=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=m,p[0]=this._h[0]+5,m=p[0]>>>13,p[0]&=8191,O=1;O<10;O++)p[O]=this._h[O]+m,m=p[O]>>>13,p[O]&=8191;for(p[9]-=1<<13,C=(m^1)-1,O=0;O<10;O++)p[O]&=C;for(C=~C,O=0;O<10;O++)this._h[O]=this._h[O]&C|p[O];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,L=this._h[0]+this._pad[0],this._h[0]=L&65535,O=1;O<8;O++)L=(this._h[O]+this._pad[O]|0)+(L>>>16)|0,this._h[O]=L&65535;return o[f+0]=this._h[0]>>>0,o[f+1]=this._h[0]>>>8,o[f+2]=this._h[1]>>>0,o[f+3]=this._h[1]>>>8,o[f+4]=this._h[2]>>>0,o[f+5]=this._h[2]>>>8,o[f+6]=this._h[3]>>>0,o[f+7]=this._h[3]>>>8,o[f+8]=this._h[4]>>>0,o[f+9]=this._h[4]>>>8,o[f+10]=this._h[5]>>>0,o[f+11]=this._h[5]>>>8,o[f+12]=this._h[6]>>>0,o[f+13]=this._h[6]>>>8,o[f+14]=this._h[7]>>>0,o[f+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(o){var f=0,p=o.length,m;if(this._leftover){m=16-this._leftover,m>p&&(m=p);for(var C=0;C<m;C++)this._buffer[this._leftover+C]=o[f+C];if(p-=m,f+=m,this._leftover+=m,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(m=p-p%16,this._blocks(o,f,m),f+=m,p-=m),p){for(var C=0;C<p;C++)this._buffer[this._leftover+C]=o[f+C];this._leftover+=p}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var o=new Uint8Array(16);return this.finish(o),o},l.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();t.Poly1305=i;function n(l,o){var f=new i(l);f.update(o);var p=f.digest();return f.clean(),p}t.oneTimeAuth=n;function a(l,o){return l.length!==t.DIGEST_LENGTH||o.length!==t.DIGEST_LENGTH?!1:e.equal(l,o)}t.equal=a}(So),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=bi,r=So,i=yt,n=pe,a=Vt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var l=new Uint8Array(16),o=function(){function f(p){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,p.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return f.prototype.seal=function(p,m,C,L){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var O=new Uint8Array(16);O.set(p,O.length-p.length);var I=new Uint8Array(32);e.stream(this._key,O,I,4);var $=m.length+this.tagLength,B;if(L){if(L.length!==$)throw new Error("ChaCha20Poly1305: incorrect destination length");B=L}else B=new Uint8Array($);return e.streamXOR(this._key,O,m,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),I,B.subarray(0,B.length-this.tagLength),C),i.wipe(O),B},f.prototype.open=function(p,m,C,L){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(m.length<this.tagLength)return null;var O=new Uint8Array(16);O.set(p,O.length-p.length);var I=new Uint8Array(32);e.stream(this._key,O,I,4);var $=new Uint8Array(this.tagLength);if(this._authenticate($,I,m.subarray(0,m.length-this.tagLength),C),!a.equal($,m.subarray(m.length-this.tagLength,m.length)))return null;var B=m.length-this.tagLength,W;if(L){if(L.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");W=L}else W=new Uint8Array(B);return e.streamXOR(this._key,O,m.subarray(0,m.length-this.tagLength),W,4),i.wipe(O),W},f.prototype.clean=function(){return i.wipe(this._key),this},f.prototype._authenticate=function(p,m,C,L){var O=new r.Poly1305(m);L&&(O.update(L),L.length%16>0&&O.update(l.subarray(L.length%16))),O.update(C),C.length%16>0&&O.update(l.subarray(C.length%16));var I=new Uint8Array(8);L&&n.writeUint64LE(L.length,I),O.update(I),n.writeUint64LE(C.length,I),O.update(I);for(var $=O.digest(),B=0;B<$.length;B++)p[B]=$[B];O.clean(),i.wipe($),i.wipe(I)},f}();t.ChaCha20Poly1305=o}(cn);var Oo={},Br={},hn={};Object.defineProperty(hn,"__esModule",{value:!0});function ud(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}hn.isSerializableHash=ud,Object.defineProperty(Br,"__esModule",{value:!0});var Pt=hn,hd=Vt,ld=yt,Co=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Pt.isSerializableHash(this._inner)&&Pt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),ld.wipe(i)}return t.prototype.reset=function(){if(!Pt.isSerializableHash(this._inner)||!Pt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Pt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Pt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Pt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Pt.isSerializableHash(this._inner)||!Pt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Pt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Br.HMAC=Co;function fd(t,e,r){var i=new Co(t,e);i.update(r);var n=i.digest();return i.clean(),n}Br.hmac=fd,Br.equal=hd.equal,Object.defineProperty(Oo,"__esModule",{value:!0});var Ao=Br,To=yt,dd=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var a=Ao.hmac(this._hash,i,r);this._hmac=new Ao.HMAC(e,a),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),To.wipe(this._buffer),To.wipe(this._counter),this._bufpos=0},t}(),pd=Oo.HKDF=dd,mi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=pe,r=yt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function o(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return o.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},o.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},o.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},o.prototype.update=function(f,p){if(p===void 0&&(p=f.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var m=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=f[m++],p--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(m=a(this._temp,this._state,f,m,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=f[m++],p--;return this},o.prototype.finish=function(f){if(!this._finished){var p=this._bytesHashed,m=this._bufferLength,C=p/536870912|0,L=p<<3,O=p%64<56?64:128;this._buffer[m]=128;for(var I=m+1;I<O-8;I++)this._buffer[I]=0;e.writeUint32BE(C,this._buffer,O-8),e.writeUint32BE(L,this._buffer,O-4),a(this._temp,this._state,this._buffer,0,O),this._finished=!0}for(var I=0;I<this.digestLength/4;I++)e.writeUint32BE(this._state[I],f,I*4);return this},o.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},o.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},o.prototype.restoreState=function(f){return this._state.set(f.state),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},o.prototype.cleanSavedState=function(f){r.wipe(f.state),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},o}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(o,f,p,m,C){for(;C>=64;){for(var L=f[0],O=f[1],I=f[2],$=f[3],B=f[4],W=f[5],A=f[6],R=f[7],_=0;_<16;_++){var E=m+_*4;o[_]=e.readUint32BE(p,E)}for(var _=16;_<64;_++){var v=o[_-2],c=(v>>>17|v<<32-17)^(v>>>19|v<<32-19)^v>>>10;v=o[_-15];var y=(v>>>7|v<<32-7)^(v>>>18|v<<32-18)^v>>>3;o[_]=(c+o[_-7]|0)+(y+o[_-16]|0)}for(var _=0;_<64;_++){var c=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&W^~B&A)|0)+(R+(n[_]+o[_]|0)|0)|0,y=((L>>>2|L<<32-2)^(L>>>13|L<<32-13)^(L>>>22|L<<32-22))+(L&O^L&I^O&I)|0;R=A,A=W,W=B,B=$+c|0,$=I,I=O,O=L,L=c+y|0}f[0]+=L,f[1]+=O,f[2]+=I,f[3]+=$,f[4]+=B,f[5]+=W,f[6]+=A,f[7]+=R,m+=64,C-=64}return m}function l(o){var f=new i;f.update(o);var p=f.digest();return f.clean(),p}t.hash=l})(mi);var ln={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=wr,r=yt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(_){const E=new Float64Array(16);if(_)for(let v=0;v<_.length;v++)E[v]=_[v];return E}const n=new Uint8Array(32);n[0]=9;const a=i([56129,1]);function l(_){let E=1;for(let v=0;v<16;v++){let c=_[v]+E+65535;E=Math.floor(c/65536),_[v]=c-E*65536}_[0]+=E-1+37*(E-1)}function o(_,E,v){const c=~(v-1);for(let y=0;y<16;y++){const q=c&(_[y]^E[y]);_[y]^=q,E[y]^=q}}function f(_,E){const v=i(),c=i();for(let y=0;y<16;y++)c[y]=E[y];l(c),l(c),l(c);for(let y=0;y<2;y++){v[0]=c[0]-65517;for(let Y=1;Y<15;Y++)v[Y]=c[Y]-65535-(v[Y-1]>>16&1),v[Y-1]&=65535;v[15]=c[15]-32767-(v[14]>>16&1);const q=v[15]>>16&1;v[14]&=65535,o(c,v,1-q)}for(let y=0;y<16;y++)_[2*y]=c[y]&255,_[2*y+1]=c[y]>>8}function p(_,E){for(let v=0;v<16;v++)_[v]=E[2*v]+(E[2*v+1]<<8);_[15]&=32767}function m(_,E,v){for(let c=0;c<16;c++)_[c]=E[c]+v[c]}function C(_,E,v){for(let c=0;c<16;c++)_[c]=E[c]-v[c]}function L(_,E,v){let c,y,q=0,Y=0,Z=0,se=0,ne=0,w=0,D=0,K=0,k=0,H=0,j=0,G=0,z=0,oe=0,J=0,ce=0,re=0,ge=0,U=0,F=0,T=0,h=0,x=0,X=0,Q=0,fe=0,xe=0,_e=0,Se=0,Fe=0,Ne=0,Ee=v[0],be=v[1],he=v[2],ye=v[3],me=v[4],ue=v[5],de=v[6],d=v[7],s=v[8],u=v[9],g=v[10],S=v[11],N=v[12],M=v[13],te=v[14],ae=v[15];c=E[0],q+=c*Ee,Y+=c*be,Z+=c*he,se+=c*ye,ne+=c*me,w+=c*ue,D+=c*de,K+=c*d,k+=c*s,H+=c*u,j+=c*g,G+=c*S,z+=c*N,oe+=c*M,J+=c*te,ce+=c*ae,c=E[1],Y+=c*Ee,Z+=c*be,se+=c*he,ne+=c*ye,w+=c*me,D+=c*ue,K+=c*de,k+=c*d,H+=c*s,j+=c*u,G+=c*g,z+=c*S,oe+=c*N,J+=c*M,ce+=c*te,re+=c*ae,c=E[2],Z+=c*Ee,se+=c*be,ne+=c*he,w+=c*ye,D+=c*me,K+=c*ue,k+=c*de,H+=c*d,j+=c*s,G+=c*u,z+=c*g,oe+=c*S,J+=c*N,ce+=c*M,re+=c*te,ge+=c*ae,c=E[3],se+=c*Ee,ne+=c*be,w+=c*he,D+=c*ye,K+=c*me,k+=c*ue,H+=c*de,j+=c*d,G+=c*s,z+=c*u,oe+=c*g,J+=c*S,ce+=c*N,re+=c*M,ge+=c*te,U+=c*ae,c=E[4],ne+=c*Ee,w+=c*be,D+=c*he,K+=c*ye,k+=c*me,H+=c*ue,j+=c*de,G+=c*d,z+=c*s,oe+=c*u,J+=c*g,ce+=c*S,re+=c*N,ge+=c*M,U+=c*te,F+=c*ae,c=E[5],w+=c*Ee,D+=c*be,K+=c*he,k+=c*ye,H+=c*me,j+=c*ue,G+=c*de,z+=c*d,oe+=c*s,J+=c*u,ce+=c*g,re+=c*S,ge+=c*N,U+=c*M,F+=c*te,T+=c*ae,c=E[6],D+=c*Ee,K+=c*be,k+=c*he,H+=c*ye,j+=c*me,G+=c*ue,z+=c*de,oe+=c*d,J+=c*s,ce+=c*u,re+=c*g,ge+=c*S,U+=c*N,F+=c*M,T+=c*te,h+=c*ae,c=E[7],K+=c*Ee,k+=c*be,H+=c*he,j+=c*ye,G+=c*me,z+=c*ue,oe+=c*de,J+=c*d,ce+=c*s,re+=c*u,ge+=c*g,U+=c*S,F+=c*N,T+=c*M,h+=c*te,x+=c*ae,c=E[8],k+=c*Ee,H+=c*be,j+=c*he,G+=c*ye,z+=c*me,oe+=c*ue,J+=c*de,ce+=c*d,re+=c*s,ge+=c*u,U+=c*g,F+=c*S,T+=c*N,h+=c*M,x+=c*te,X+=c*ae,c=E[9],H+=c*Ee,j+=c*be,G+=c*he,z+=c*ye,oe+=c*me,J+=c*ue,ce+=c*de,re+=c*d,ge+=c*s,U+=c*u,F+=c*g,T+=c*S,h+=c*N,x+=c*M,X+=c*te,Q+=c*ae,c=E[10],j+=c*Ee,G+=c*be,z+=c*he,oe+=c*ye,J+=c*me,ce+=c*ue,re+=c*de,ge+=c*d,U+=c*s,F+=c*u,T+=c*g,h+=c*S,x+=c*N,X+=c*M,Q+=c*te,fe+=c*ae,c=E[11],G+=c*Ee,z+=c*be,oe+=c*he,J+=c*ye,ce+=c*me,re+=c*ue,ge+=c*de,U+=c*d,F+=c*s,T+=c*u,h+=c*g,x+=c*S,X+=c*N,Q+=c*M,fe+=c*te,xe+=c*ae,c=E[12],z+=c*Ee,oe+=c*be,J+=c*he,ce+=c*ye,re+=c*me,ge+=c*ue,U+=c*de,F+=c*d,T+=c*s,h+=c*u,x+=c*g,X+=c*S,Q+=c*N,fe+=c*M,xe+=c*te,_e+=c*ae,c=E[13],oe+=c*Ee,J+=c*be,ce+=c*he,re+=c*ye,ge+=c*me,U+=c*ue,F+=c*de,T+=c*d,h+=c*s,x+=c*u,X+=c*g,Q+=c*S,fe+=c*N,xe+=c*M,_e+=c*te,Se+=c*ae,c=E[14],J+=c*Ee,ce+=c*be,re+=c*he,ge+=c*ye,U+=c*me,F+=c*ue,T+=c*de,h+=c*d,x+=c*s,X+=c*u,Q+=c*g,fe+=c*S,xe+=c*N,_e+=c*M,Se+=c*te,Fe+=c*ae,c=E[15],ce+=c*Ee,re+=c*be,ge+=c*he,U+=c*ye,F+=c*me,T+=c*ue,h+=c*de,x+=c*d,X+=c*s,Q+=c*u,fe+=c*g,xe+=c*S,_e+=c*N,Se+=c*M,Fe+=c*te,Ne+=c*ae,q+=38*re,Y+=38*ge,Z+=38*U,se+=38*F,ne+=38*T,w+=38*h,D+=38*x,K+=38*X,k+=38*Q,H+=38*fe,j+=38*xe,G+=38*_e,z+=38*Se,oe+=38*Fe,J+=38*Ne,y=1,c=q+y+65535,y=Math.floor(c/65536),q=c-y*65536,c=Y+y+65535,y=Math.floor(c/65536),Y=c-y*65536,c=Z+y+65535,y=Math.floor(c/65536),Z=c-y*65536,c=se+y+65535,y=Math.floor(c/65536),se=c-y*65536,c=ne+y+65535,y=Math.floor(c/65536),ne=c-y*65536,c=w+y+65535,y=Math.floor(c/65536),w=c-y*65536,c=D+y+65535,y=Math.floor(c/65536),D=c-y*65536,c=K+y+65535,y=Math.floor(c/65536),K=c-y*65536,c=k+y+65535,y=Math.floor(c/65536),k=c-y*65536,c=H+y+65535,y=Math.floor(c/65536),H=c-y*65536,c=j+y+65535,y=Math.floor(c/65536),j=c-y*65536,c=G+y+65535,y=Math.floor(c/65536),G=c-y*65536,c=z+y+65535,y=Math.floor(c/65536),z=c-y*65536,c=oe+y+65535,y=Math.floor(c/65536),oe=c-y*65536,c=J+y+65535,y=Math.floor(c/65536),J=c-y*65536,c=ce+y+65535,y=Math.floor(c/65536),ce=c-y*65536,q+=y-1+37*(y-1),y=1,c=q+y+65535,y=Math.floor(c/65536),q=c-y*65536,c=Y+y+65535,y=Math.floor(c/65536),Y=c-y*65536,c=Z+y+65535,y=Math.floor(c/65536),Z=c-y*65536,c=se+y+65535,y=Math.floor(c/65536),se=c-y*65536,c=ne+y+65535,y=Math.floor(c/65536),ne=c-y*65536,c=w+y+65535,y=Math.floor(c/65536),w=c-y*65536,c=D+y+65535,y=Math.floor(c/65536),D=c-y*65536,c=K+y+65535,y=Math.floor(c/65536),K=c-y*65536,c=k+y+65535,y=Math.floor(c/65536),k=c-y*65536,c=H+y+65535,y=Math.floor(c/65536),H=c-y*65536,c=j+y+65535,y=Math.floor(c/65536),j=c-y*65536,c=G+y+65535,y=Math.floor(c/65536),G=c-y*65536,c=z+y+65535,y=Math.floor(c/65536),z=c-y*65536,c=oe+y+65535,y=Math.floor(c/65536),oe=c-y*65536,c=J+y+65535,y=Math.floor(c/65536),J=c-y*65536,c=ce+y+65535,y=Math.floor(c/65536),ce=c-y*65536,q+=y-1+37*(y-1),_[0]=q,_[1]=Y,_[2]=Z,_[3]=se,_[4]=ne,_[5]=w,_[6]=D,_[7]=K,_[8]=k,_[9]=H,_[10]=j,_[11]=G,_[12]=z,_[13]=oe,_[14]=J,_[15]=ce}function O(_,E){L(_,E,E)}function I(_,E){const v=i();for(let c=0;c<16;c++)v[c]=E[c];for(let c=253;c>=0;c--)O(v,v),c!==2&&c!==4&&L(v,v,E);for(let c=0;c<16;c++)_[c]=v[c]}function $(_,E){const v=new Uint8Array(32),c=new Float64Array(80),y=i(),q=i(),Y=i(),Z=i(),se=i(),ne=i();for(let k=0;k<31;k++)v[k]=_[k];v[31]=_[31]&127|64,v[0]&=248,p(c,E);for(let k=0;k<16;k++)q[k]=c[k];y[0]=Z[0]=1;for(let k=254;k>=0;--k){const H=v[k>>>3]>>>(k&7)&1;o(y,q,H),o(Y,Z,H),m(se,y,Y),C(y,y,Y),m(Y,q,Z),C(q,q,Z),O(Z,se),O(ne,y),L(y,Y,y),L(Y,q,se),m(se,y,Y),C(y,y,Y),O(q,y),C(Y,Z,ne),L(y,Y,a),m(y,y,Z),L(Y,Y,y),L(y,Z,ne),L(Z,q,c),O(q,se),o(y,q,H),o(Y,Z,H)}for(let k=0;k<16;k++)c[k+16]=y[k],c[k+32]=Y[k],c[k+48]=q[k],c[k+64]=Z[k];const w=c.subarray(32),D=c.subarray(16);I(w,w),L(D,D,w);const K=new Uint8Array(32);return f(K,D),K}t.scalarMult=$;function B(_){return $(_,n)}t.scalarMultBase=B;function W(_){if(_.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const E=new Uint8Array(_);return{publicKey:B(E),secretKey:E}}t.generateKeyPairFromSeed=W;function A(_){const E=(0,e.randomBytes)(32,_),v=W(E);return(0,r.wipe)(E),v}t.generateKeyPair=A;function R(_,E,v=!1){if(_.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(E.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=$(_,E);if(v){let y=0;for(let q=0;q<c.length;q++)y|=c[q];if(y===0)throw new Error("X25519: invalid shared key")}return c}t.sharedKey=R})(ln);function Po(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function No(t,e){e||(e=t.reduce((n,a)=>n+a.length,0));const r=Po(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function Ro(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Fo=Ro("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),fn=Ro("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Po(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Uo={utf8:Fo,"utf-8":Fo,hex:yi.base16,latin1:fn,ascii:fn,binary:fn,...yi};function Ot(t,e="utf8"){const r=Uo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Ct(t,e="utf8"){const r=Uo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Lo=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,a;i<n;i++)(a||!(i in e))&&(a||(a=Array.prototype.slice.call(e,0,i)),a[i]=e[i]);return t.concat(a||Array.prototype.slice.call(e))},gd=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),yd=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),wd=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),bd=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),md=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),_d=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Ed=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Mo=3,vd=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",_d]],Bo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Dd(t){return t?$o(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new md:typeof navigator<"u"?$o(navigator.userAgent):Id()}function xd(t){return t!==""&&vd.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var a=n.exec(t);return!!a&&[i,a]},!1)}function $o(t){var e=xd(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new bd;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Mo&&(n=Lo(Lo([],n,!0),Od(Mo-n.length),!0)):n=[];var a=n.join("."),l=Sd(t),o=Ed.exec(t);return o&&o[1]?new wd(r,a,l,o[1]):new gd(r,a,l)}function Sd(t){for(var e=0,r=Bo.length;e<r;e++){var i=Bo[e],n=i[0],a=i[1],l=a.exec(t);if(l)return n}return null}function Id(){var t=typeof process<"u"&&process.version;return t?new yd(process.version.slice(1)):null}function Od(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Te={};Object.defineProperty(Te,"__esModule",{value:!0}),Te.getLocalStorage=Te.getLocalStorageOrThrow=Te.getCrypto=Te.getCryptoOrThrow=Ho=Te.getLocation=Te.getLocationOrThrow=dn=Te.getNavigator=Te.getNavigatorOrThrow=jo=Te.getDocument=Te.getDocumentOrThrow=Te.getFromWindowOrThrow=Te.getFromWindow=void 0;function or(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Te.getFromWindow=or;function br(t){const e=or(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Te.getFromWindowOrThrow=br;function Cd(){return br("document")}Te.getDocumentOrThrow=Cd;function Ad(){return or("document")}var jo=Te.getDocument=Ad;function Td(){return br("navigator")}Te.getNavigatorOrThrow=Td;function Pd(){return or("navigator")}var dn=Te.getNavigator=Pd;function Nd(){return br("location")}Te.getLocationOrThrow=Nd;function Rd(){return or("location")}var Ho=Te.getLocation=Rd;function Fd(){return br("crypto")}Te.getCryptoOrThrow=Fd;function Ud(){return or("crypto")}Te.getCrypto=Ud;function Ld(){return br("localStorage")}Te.getLocalStorageOrThrow=Ld;function Md(){return or("localStorage")}Te.getLocalStorage=Md;var pn={};Object.defineProperty(pn,"__esModule",{value:!0});var zo=pn.getWindowMetadata=void 0;const qo=Te;function Bd(){let t,e;try{t=qo.getDocumentOrThrow(),e=qo.getLocationOrThrow()}catch{return null}function r(){const C=t.getElementsByTagName("link"),L=[];for(let O=0;O<C.length;O++){const I=C[O],$=I.getAttribute("rel");if($&&$.toLowerCase().indexOf("icon")>-1){const B=I.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let W=e.protocol+"//"+e.host;if(B.indexOf("/")===0)W+=B;else{const A=e.pathname.split("/");A.pop();const R=A.join("/");W+=R+"/"+B}L.push(W)}else if(B.indexOf("//")===0){const W=e.protocol+B;L.push(W)}else L.push(B)}}return L}function i(...C){const L=t.getElementsByTagName("meta");for(let O=0;O<L.length;O++){const I=L[O],$=["itemprop","property","name"].map(B=>I.getAttribute(B)).filter(B=>B?C.includes(B):!1);if($.length&&$){const B=I.getAttribute("content");if(B)return B}}return""}function n(){let C=i("name","og:site_name","og:title","twitter:title");return C||(C=t.title),C}function a(){return i("description","og:description","twitter:description","keywords")}const l=n(),o=a(),f=e.origin,p=r();return{description:o,url:f,icons:p,name:l}}zo=pn.getWindowMetadata=Bd;var $r={},$d=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Ko="%[a-f0-9]{2}",Vo=new RegExp("("+Ko+")|([^%]+?)","gi"),ko=new RegExp("("+Ko+")+","gi");function gn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],gn(r),gn(i))}function jd(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Vo)||[],r=1;r<e.length;r++)t=gn(e,r).join(""),e=t.match(Vo)||[];return t}}function Hd(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=ko.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=jd(r[0]);i!==r[0]&&(e[r[0]]=i)}r=ko.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),a=0;a<n.length;a++){var l=n[a];t=t.replace(new RegExp(l,"g"),e[l])}return t}var zd=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Hd(t)}},qd=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Kd=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),a=0;a<i.length;a++){var l=i[a],o=t[l];(n?e.indexOf(l)!==-1:e(l,o,t))&&(r[l]=o)}return r};(function(t){const e=$d,r=zd,i=qd,n=Kd,a=A=>A==null,l=Symbol("encodeFragmentIdentifier");function o(A){switch(A.arrayFormat){case"index":return R=>(_,E)=>{const v=_.length;return E===void 0||A.skipNull&&E===null||A.skipEmptyString&&E===""?_:E===null?[..._,[m(R,A),"[",v,"]"].join("")]:[..._,[m(R,A),"[",m(v,A),"]=",m(E,A)].join("")]};case"bracket":return R=>(_,E)=>E===void 0||A.skipNull&&E===null||A.skipEmptyString&&E===""?_:E===null?[..._,[m(R,A),"[]"].join("")]:[..._,[m(R,A),"[]=",m(E,A)].join("")];case"colon-list-separator":return R=>(_,E)=>E===void 0||A.skipNull&&E===null||A.skipEmptyString&&E===""?_:E===null?[..._,[m(R,A),":list="].join("")]:[..._,[m(R,A),":list=",m(E,A)].join("")];case"comma":case"separator":case"bracket-separator":{const R=A.arrayFormat==="bracket-separator"?"[]=":"=";return _=>(E,v)=>v===void 0||A.skipNull&&v===null||A.skipEmptyString&&v===""?E:(v=v===null?"":v,E.length===0?[[m(_,A),R,m(v,A)].join("")]:[[E,m(v,A)].join(A.arrayFormatSeparator)])}default:return R=>(_,E)=>E===void 0||A.skipNull&&E===null||A.skipEmptyString&&E===""?_:E===null?[..._,m(R,A)]:[..._,[m(R,A),"=",m(E,A)].join("")]}}function f(A){let R;switch(A.arrayFormat){case"index":return(_,E,v)=>{if(R=/\[(\d*)\]$/.exec(_),_=_.replace(/\[\d*\]$/,""),!R){v[_]=E;return}v[_]===void 0&&(v[_]={}),v[_][R[1]]=E};case"bracket":return(_,E,v)=>{if(R=/(\[\])$/.exec(_),_=_.replace(/\[\]$/,""),!R){v[_]=E;return}if(v[_]===void 0){v[_]=[E];return}v[_]=[].concat(v[_],E)};case"colon-list-separator":return(_,E,v)=>{if(R=/(:list)$/.exec(_),_=_.replace(/:list$/,""),!R){v[_]=E;return}if(v[_]===void 0){v[_]=[E];return}v[_]=[].concat(v[_],E)};case"comma":case"separator":return(_,E,v)=>{const c=typeof E=="string"&&E.includes(A.arrayFormatSeparator),y=typeof E=="string"&&!c&&C(E,A).includes(A.arrayFormatSeparator);E=y?C(E,A):E;const q=c||y?E.split(A.arrayFormatSeparator).map(Y=>C(Y,A)):E===null?E:C(E,A);v[_]=q};case"bracket-separator":return(_,E,v)=>{const c=/(\[\])$/.test(_);if(_=_.replace(/\[\]$/,""),!c){v[_]=E&&C(E,A);return}const y=E===null?[]:E.split(A.arrayFormatSeparator).map(q=>C(q,A));if(v[_]===void 0){v[_]=y;return}v[_]=[].concat(v[_],y)};default:return(_,E,v)=>{if(v[_]===void 0){v[_]=E;return}v[_]=[].concat(v[_],E)}}}function p(A){if(typeof A!="string"||A.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function m(A,R){return R.encode?R.strict?e(A):encodeURIComponent(A):A}function C(A,R){return R.decode?r(A):A}function L(A){return Array.isArray(A)?A.sort():typeof A=="object"?L(Object.keys(A)).sort((R,_)=>Number(R)-Number(_)).map(R=>A[R]):A}function O(A){const R=A.indexOf("#");return R!==-1&&(A=A.slice(0,R)),A}function I(A){let R="";const _=A.indexOf("#");return _!==-1&&(R=A.slice(_)),R}function $(A){A=O(A);const R=A.indexOf("?");return R===-1?"":A.slice(R+1)}function B(A,R){return R.parseNumbers&&!Number.isNaN(Number(A))&&typeof A=="string"&&A.trim()!==""?A=Number(A):R.parseBooleans&&A!==null&&(A.toLowerCase()==="true"||A.toLowerCase()==="false")&&(A=A.toLowerCase()==="true"),A}function W(A,R){R=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},R),p(R.arrayFormatSeparator);const _=f(R),E=Object.create(null);if(typeof A!="string"||(A=A.trim().replace(/^[?#&]/,""),!A))return E;for(const v of A.split("&")){if(v==="")continue;let[c,y]=i(R.decode?v.replace(/\+/g," "):v,"=");y=y===void 0?null:["comma","separator","bracket-separator"].includes(R.arrayFormat)?y:C(y,R),_(C(c,R),y,E)}for(const v of Object.keys(E)){const c=E[v];if(typeof c=="object"&&c!==null)for(const y of Object.keys(c))c[y]=B(c[y],R);else E[v]=B(c,R)}return R.sort===!1?E:(R.sort===!0?Object.keys(E).sort():Object.keys(E).sort(R.sort)).reduce((v,c)=>{const y=E[c];return Boolean(y)&&typeof y=="object"&&!Array.isArray(y)?v[c]=L(y):v[c]=y,v},Object.create(null))}t.extract=$,t.parse=W,t.stringify=(A,R)=>{if(!A)return"";R=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},R),p(R.arrayFormatSeparator);const _=y=>R.skipNull&&a(A[y])||R.skipEmptyString&&A[y]==="",E=o(R),v={};for(const y of Object.keys(A))_(y)||(v[y]=A[y]);const c=Object.keys(v);return R.sort!==!1&&c.sort(R.sort),c.map(y=>{const q=A[y];return q===void 0?"":q===null?m(y,R):Array.isArray(q)?q.length===0&&R.arrayFormat==="bracket-separator"?m(y,R)+"[]":q.reduce(E(y),[]).join("&"):m(y,R)+"="+m(q,R)}).filter(y=>y.length>0).join("&")},t.parseUrl=(A,R)=>{R=Object.assign({decode:!0},R);const[_,E]=i(A,"#");return Object.assign({url:_.split("?")[0]||"",query:W($(A),R)},R&&R.parseFragmentIdentifier&&E?{fragmentIdentifier:C(E,R)}:{})},t.stringifyUrl=(A,R)=>{R=Object.assign({encode:!0,strict:!0,[l]:!0},R);const _=O(A.url).split("?")[0]||"",E=t.extract(A.url),v=t.parse(E,{sort:!1}),c=Object.assign(v,A.query);let y=t.stringify(c,R);y&&(y=`?${y}`);let q=I(A.url);return A.fragmentIdentifier&&(q=`#${R[l]?m(A.fragmentIdentifier,R):A.fragmentIdentifier}`),`${_}${y}${q}`},t.pick=(A,R,_)=>{_=Object.assign({parseFragmentIdentifier:!0,[l]:!1},_);const{url:E,query:v,fragmentIdentifier:c}=t.parseUrl(A,_);return t.stringifyUrl({url:E,query:n(v,R),fragmentIdentifier:c},_)},t.exclude=(A,R,_)=>{const E=Array.isArray(R)?v=>!R.includes(v):(v,c)=>!R(v,c);return t.pick(A,E,_)}})($r);const Vd={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},Wo="base10",ht="base16",yn="base64pad",wn="utf8",Go=0,ar=1,kd=0,Yo=1,bn=12,mn=32;function Wd(){const t=ln.generateKeyPair();return{privateKey:Ct(t.secretKey,ht),publicKey:Ct(t.publicKey,ht)}}function _n(){const t=wr.randomBytes(mn);return Ct(t,ht)}function Gd(t,e){const r=ln.sharedKey(Ot(t,ht),Ot(e,ht)),i=new pd(mi.SHA256,r).expand(mn);return Ct(i,ht)}function Yd(t){const e=mi.hash(Ot(t,ht));return Ct(e,ht)}function En(t){const e=mi.hash(Ot(t,wn));return Ct(e,ht)}function Jd(t){return Ot(`${t}`,Wo)}function jr(t){return Number(Ct(t,Wo))}function Xd(t){const e=Jd(typeof t.type<"u"?t.type:Go);if(jr(e)===ar&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Ot(t.senderPublicKey,ht):void 0,i=typeof t.iv<"u"?Ot(t.iv,ht):wr.randomBytes(bn),n=new cn.ChaCha20Poly1305(Ot(t.symKey,ht)).seal(i,Ot(t.message,wn));return Qd({type:e,sealed:n,iv:i,senderPublicKey:r})}function Zd(t){const e=new cn.ChaCha20Poly1305(Ot(t.symKey,ht)),{sealed:r,iv:i}=vn(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return Ct(n,wn)}function Qd(t){if(jr(t.type)===ar){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Ct(No([t.type,t.senderPublicKey,t.iv,t.sealed]),yn)}return Ct(No([t.type,t.iv,t.sealed]),yn)}function vn(t){const e=Ot(t,yn),r=e.slice(kd,Yo),i=Yo;if(jr(r)===ar){const o=i+mn,f=o+bn,p=e.slice(i,o),m=e.slice(o,f),C=e.slice(f);return{type:r,sealed:C,iv:m,senderPublicKey:p}}const n=i+bn,a=e.slice(i,n),l=e.slice(n);return{type:r,sealed:l,iv:a}}function ep(t,e){const r=vn(t);return Jo({type:jr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Ct(r.senderPublicKey,ht):void 0,receiverPublicKey:e?.receiverPublicKey})}function Jo(t){const e=t?.type||Go;if(e===ar){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Xo(t){return t.type===ar&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var tp=Object.defineProperty,Zo=Object.getOwnPropertySymbols,rp=Object.prototype.hasOwnProperty,ip=Object.prototype.propertyIsEnumerable,Qo=(t,e,r)=>e in t?tp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ea=(t,e)=>{for(var r in e||(e={}))rp.call(e,r)&&Qo(t,r,e[r]);if(Zo)for(var r of Zo(e))ip.call(e,r)&&Qo(t,r,e[r]);return t};const np="ReactNative",Hr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},sp="js";function ta(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function op(){return!jo()&&!!dn()&&navigator.product===np}function ap(){return!ta()&&!!dn()}function cp(){return op()?Hr.reactNative:ta()?Hr.node:ap()?Hr.browser:Hr.unknown}function up(t,e){let r=$r.parse(t);return r=ea(ea({},r),e),t=$r.stringify(r),t}function hp(){return zo()||{name:"",description:"",url:"",icons:[""]}}function lp(){const t=Dd();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function fp(){var t;const e=cp();return e===Hr.browser?[e,((t=Ho())==null?void 0:t.host)||"unknown"].join(":"):e}function dp(t,e,r){const i=lp(),n=fp();return[[t,e].join("-"),[sp,r].join("-"),i,n].join("/")}function pp({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:a}){const l=r.split("?"),o=dp(t,e,i),f={auth:n,ua:o,projectId:a},p=up(l[1]||"",f);return l[0]+"?"+p}function lt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function ra(t){return Object.fromEntries(t.entries())}function ia(t){return new Map(Object.entries(t))}function Bt(t,e){return le.fromMiliseconds((e||Date.now())+le.toMiliseconds(t))}function kt(t){return le.fromMiliseconds(Date.now())>=le.toMiliseconds(t)}function cr(){const t=le.toMiliseconds(le.FIVE_MINUTES);let e,r,i;return{resolve:n=>{i&&e&&(clearTimeout(i),e(n))},reject:n=>{i&&r&&(clearTimeout(i),r(n))},done:()=>new Promise((n,a)=>{i=setTimeout(a,t),e=n,r=a})}}function na(t,e){return new Promise(async(r,i)=>{const n=setTimeout(()=>i(),e),a=await t;clearTimeout(n),r(a)})}function sa(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function gp(t){return sa("topic",t)}function yp(t){return sa("id",t)}function oa(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function $e(t,e){return`${t}${e?`:${e}`:""}`}const wp="irn";function Dn(t){return t?.relay||{protocol:wp}}function xn(t){const e=Vd[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var bp=Object.defineProperty,aa=Object.getOwnPropertySymbols,mp=Object.prototype.hasOwnProperty,_p=Object.prototype.propertyIsEnumerable,ca=(t,e,r)=>e in t?bp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ep=(t,e)=>{for(var r in e||(e={}))mp.call(e,r)&&ca(t,r,e[r]);if(aa)for(var r of aa(e))_p.call(e,r)&&ca(t,r,e[r]);return t};function vp(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const a=n.replace(i,""),l=t[n];r[a]=l}}),r}function Dp(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),a=typeof r<"u"?t.substring(r):"",l=$r.parse(a);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:l.symKey,relay:vp(l)}}function xp(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const a=r+e+n;t[n]&&(i[a]=t[n])}),i}function Sp(t){return`${t.protocol}:${t.topic}@${t.version}?`+$r.stringify(Ep({symKey:t.symKey},xp(t.relay)))}function Nt(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function Ip(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Nt(r.accounts)),r.extension&&r.extension.forEach(i=>{e.push(...Nt(i.accounts))})}),e}function Op(t,e){const r=[];return Object.values(t).forEach(i=>{Nt(i.accounts).includes(e)&&r.push(...i.methods),i.extension&&i.extension.forEach(n=>{Nt(n.accounts).includes(e)&&r.push(...n.methods)})}),r}function Cp(t,e){const r=[];return Object.values(t).forEach(i=>{Nt(i.accounts).includes(e)&&r.push(...i.events),i.extension&&i.extension.forEach(n=>{Nt(n.accounts).includes(e)&&r.push(...n.events)})}),r}const Ap={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Tp={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ee(t,e){const{message:r,code:i}=Tp[t];return{message:e?`${r} ${e}`:r,code:i}}function ke(t,e){const{message:r,code:i}=Ap[t];return{message:e?`${r} ${e}`:r,code:i}}function zr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function ua(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function vt(t){return typeof t>"u"}function it(t,e){return e&&vt(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function ha(t,e){return e&&vt(t)?!0:typeof t=="number"&&!isNaN(t)}function Pp(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let a=!0;return lt(n,i)?(i.forEach(l=>{const{accounts:o,methods:f,events:p,extension:m}=t.namespaces[l],C=Nt(o),L=r[l];(!lt(L.chains,C)||!lt(L.methods,f)||!lt(L.events,p))&&(a=!1),a&&m&&m.forEach(O=>{var I;const{accounts:$,methods:B,events:W}=O,A=Nt($);(I=L.extension)!=null&&I.find(R=>lt(R.chains,A)&&lt(R.methods,B)&&lt(R.events,W))||(a=!1)})}),a):!1}function Sn(t){return it(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Np(t){if(it(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Sn(r)}}return!1}function Rp(t){if(it(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Fp(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Up(t){return t?.topic}function Lp(t,e){let r=null;return it(t?.publicKey,!1)||(r=ee("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function In(t,e){let r=null;return vt(t?.extension)||(!zr(t.extension)||!t.extension.length)&&(r=ee("MISSING_OR_INVALID",`${e} extension should be an array of namespaces, or omitted`)),r}function la(t){let e=!0;return zr(t)?t.length&&(e=t.every(r=>it(r,!1))):e=!1,e}function fa(t,e,r){let i=null;return zr(e)?e.forEach(n=>{i||(!Sn(n)||!n.includes(t))&&(i=ke("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=ke("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function Mp(t,e){let r=null;return Object.entries(t).forEach(([i,n])=>{if(r)return;const a=fa(i,n?.chains,`${e} requiredNamespace`),l=In(n,e);a?r=a:l?r=l:n.extension&&n.extension.forEach(o=>{if(r)return;const f=fa(i,o.chains,`${e} extension`);f&&(r=f)})}),r}function da(t,e){let r=null;return zr(t)?t.forEach(i=>{r||Np(i)||(r=ke("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=ke("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Bp(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=da(i?.accounts,`${e} namespace`),a=In(i,e);n?r=n:a?r=a:i.extension&&i.extension.forEach(l=>{if(r)return;const o=da(l.accounts,`${e} extension`);o&&(r=o)})}),r}function pa(t,e){let r=null;return la(t?.methods)?la(t?.events)||(r=ke("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=ke("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function ga(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=pa(i,`${e}, namespace`),a=In(i,e);n?r=n:a?r=a:i.extension&&i.extension.forEach(l=>{if(r)return;const o=pa(l,`${e}, extension`);o&&(r=o)})}),r}function $p(t,e){let r=null;if(t&&ua(t)){const i=ga(t,e);i&&(r=i);const n=Mp(t,e);n&&(r=n)}else r=ee("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function On(t,e){let r=null;if(t&&ua(t)){const i=ga(t,e);i&&(r=i);const n=Bp(t,e);n&&(r=n)}else r=ee("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function ya(t){return it(t.protocol,!0)}function jp(t,e){let r=!1;return e&&!t?r=!0:t&&zr(t)&&t.length&&t.forEach(i=>{r=ya(i)}),r}function Hp(t){return typeof t=="number"}function ft(t){return typeof t<"u"&&typeof t!==null}function zp(t){return!(!t||typeof t!="object"||!t.code||!ha(t.code,!1)||!t.message||!it(t.message,!1))}function qp(t){return!(vt(t)||!it(t.method,!1))}function Kp(t){return!(vt(t)||vt(t.result)&&vt(t.error)||!ha(t.id,!1)||!it(t.jsonrpc,!1))}function Vp(t){return!(vt(t)||!it(t.name,!1))}function wa(t,e){return!(!Sn(e)||!Ip(t).includes(e))}function kp(t,e,r){return it(r,!1)?Op(t,e).includes(r):!1}function Wp(t,e,r){return it(r,!1)?Cp(t,e).includes(r):!1}function ba(t,e,r){let i=null;const n=Object.keys(t),a=Object.keys(e);return lt(n,a)?n.forEach(l=>{var o;if(i)return;const f=t[l].chains,p=Nt(e[l].accounts);lt(f,p)?lt(t[l].methods,e[l].methods)?lt(t[l].events,e[l].events)?t[l].extension&&!e[l].extension?i=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${l}`):t[l].extension&&e[l].extension&&((o=t[l].extension)==null||o.forEach(({methods:m,events:C,chains:L})=>{var O;i||(O=e[l].extension)!=null&&O.find(I=>{const $=Nt(I.accounts);return lt(L,$)&&lt(C,I.events)&&lt(m,I.methods)})||(i=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${l}`))})):i=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${l}`):i=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${l}`):i=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${l}`)}):i=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),i}const Gp="PARSE_ERROR",Yp="INVALID_REQUEST",Jp="METHOD_NOT_FOUND",Xp="INVALID_PARAMS",ma="INTERNAL_ERROR",Cn="SERVER_ERROR",Zp=[-32700,-32600,-32601,-32602,-32603],qr={[Gp]:{code:-32700,message:"Parse error"},[Yp]:{code:-32600,message:"Invalid Request"},[Jp]:{code:-32601,message:"Method not found"},[Xp]:{code:-32602,message:"Invalid params"},[ma]:{code:-32603,message:"Internal error"},[Cn]:{code:-32e3,message:"Server error"}},_a=Cn;function Qp(t){return Zp.includes(t)}function Ea(t){return Object.keys(qr).includes(t)?qr[t]:qr[_a]}function e0(t){const e=Object.values(qr).find(r=>r.code===t);return e||qr[_a]}function va(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Da={},$t={},xa;function t0(){if(xa)return $t;xa=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.isBrowserCryptoAvailable=$t.getSubtleCrypto=$t.getBrowerCrypto=void 0;function t(){return ut?.crypto||ut?.msCrypto||{}}$t.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}$t.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return $t.isBrowserCryptoAvailable=r,$t}var jt={},Sa;function r0(){if(Sa)return jt;Sa=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.isBrowser=jt.isNode=jt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}jt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}jt.isNode=e;function r(){return!t()&&!e()}return jt.isBrowser=r,jt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Et;e.__exportStar(t0(),t),e.__exportStar(r0(),t)})(Da);function i0(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function _i(t,e,r){return{id:r||i0(),jsonrpc:"2.0",method:t,params:e}}function An(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Ei(t,e,r){return{id:t,jsonrpc:"2.0",error:n0(e,r)}}function n0(t,e){return typeof t>"u"?Ea(ma):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ea(Cn)),{message:t})),typeof e<"u"&&(t.data=e),Qp(t.code)&&(t=e0(t.code)),t)}class s0{}class o0 extends s0{constructor(){super()}}class a0 extends o0{constructor(e){super()}}const c0="^https?:",u0="^wss?:";function h0(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Ia(t,e){const r=h0(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Oa(t){return Ia(t,c0)}function Ca(t){return Ia(t,u0)}function l0(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Aa(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Tn(t){return Aa(t)&&"method"in t}function Pn(t){return Aa(t)&&(Ht(t)||At(t))}function Ht(t){return"result"in t}function At(t){return"error"in t}class Nn extends a0{constructor(e){super(e),this.events=new ot.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(_i(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(a){n(a)}this.events.on(`${e.id}`,a=>{At(a)?n(a.error):i(a.result)});try{await this.connection.send(e,r)}catch(a){n(a)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Pn(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}const Ta=10,f0=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),d0=()=>typeof window<"u",p0=f0();class g0{constructor(e){if(this.url=e,this.events=new ot.exports.EventEmitter,this.registering=!1,!Ca(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Lr(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!Ca(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),n(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=Da.isReactNative()?void 0:{rejectUnauthorized:!l0(e)},a=new p0(e,[],n);d0()?a.onerror=l=>{const o=l;i(this.emitError(o.error))}:a.on("error",l=>{i(this.emitError(l))}),a.onopen=()=>{this.onOpen(a),r(a)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Yi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),a=Ei(e,n);this.events.emit("payload",a)}parseError(e,r=this.url){return va(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Ta&&this.events.setMaxListeners(Ta)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Rn={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,a=2,l=9007199254740991,o="[object Arguments]",f="[object Array]",p="[object AsyncFunction]",m="[object Boolean]",C="[object Date]",L="[object Error]",O="[object Function]",I="[object GeneratorFunction]",$="[object Map]",B="[object Number]",W="[object Null]",A="[object Object]",R="[object Promise]",_="[object Proxy]",E="[object RegExp]",v="[object Set]",c="[object String]",y="[object Symbol]",q="[object Undefined]",Y="[object WeakMap]",Z="[object ArrayBuffer]",se="[object DataView]",ne="[object Float32Array]",w="[object Float64Array]",D="[object Int8Array]",K="[object Int16Array]",k="[object Int32Array]",H="[object Uint8Array]",j="[object Uint8ClampedArray]",G="[object Uint16Array]",z="[object Uint32Array]",oe=/[\\^$.*+?()[\]{}|]/g,J=/^\[object .+?Constructor\]$/,ce=/^(?:0|[1-9]\d*)$/,re={};re[ne]=re[w]=re[D]=re[K]=re[k]=re[H]=re[j]=re[G]=re[z]=!0,re[o]=re[f]=re[Z]=re[m]=re[se]=re[C]=re[L]=re[O]=re[$]=re[B]=re[A]=re[E]=re[v]=re[c]=re[Y]=!1;var ge=typeof ut=="object"&&ut&&ut.Object===Object&&ut,U=typeof self=="object"&&self&&self.Object===Object&&self,F=ge||U||Function("return this")(),T=e&&!e.nodeType&&e,h=T&&!0&&t&&!t.nodeType&&t,x=h&&h.exports===T,X=x&&ge.process,Q=function(){try{return X&&X.binding&&X.binding("util")}catch{}}(),fe=Q&&Q.isTypedArray;function xe(b,P){for(var V=-1,ie=b==null?0:b.length,Pe=0,we=[];++V<ie;){var Be=b[V];P(Be,V,b)&&(we[Pe++]=Be)}return we}function _e(b,P){for(var V=-1,ie=P.length,Pe=b.length;++V<ie;)b[Pe+V]=P[V];return b}function Se(b,P){for(var V=-1,ie=b==null?0:b.length;++V<ie;)if(P(b[V],V,b))return!0;return!1}function Fe(b,P){for(var V=-1,ie=Array(b);++V<b;)ie[V]=P(V);return ie}function Ne(b){return function(P){return b(P)}}function Ee(b,P){return b.has(P)}function be(b,P){return b?.[P]}function he(b){var P=-1,V=Array(b.size);return b.forEach(function(ie,Pe){V[++P]=[Pe,ie]}),V}function ye(b,P){return function(V){return b(P(V))}}function me(b){var P=-1,V=Array(b.size);return b.forEach(function(ie){V[++P]=ie}),V}var ue=Array.prototype,de=Function.prototype,d=Object.prototype,s=F["__core-js_shared__"],u=de.toString,g=d.hasOwnProperty,S=function(){var b=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),N=d.toString,M=RegExp("^"+u.call(g).replace(oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=x?F.Buffer:void 0,ae=F.Symbol,ve=F.Uint8Array,Ie=d.propertyIsEnumerable,De=ue.splice,pt=ae?ae.toStringTag:void 0,Xt=Object.getOwnPropertySymbols,_r=te?te.isBuffer:void 0,Xr=ye(Object.keys,Object),je=lr(F,"DataView"),Le=lr(F,"Map"),He=lr(F,"Promise"),ze=lr(F,"Set"),qe=lr(F,"WeakMap"),Me=lr(Object,"create"),We=Qt(je),Ge=Qt(Le),Ye=Qt(He),Je=Qt(ze),Xe=Qt(qe),Ve=ae?ae.prototype:void 0,Ke=Ve?Ve.valueOf:void 0;function Re(b){var P=-1,V=b==null?0:b.length;for(this.clear();++P<V;){var ie=b[P];this.set(ie[0],ie[1])}}function Ze(){this.__data__=Me?Me(null):{},this.size=0}function Qe(b){var P=this.has(b)&&delete this.__data__[b];return this.size-=P?1:0,P}function Tc(b){var P=this.__data__;if(Me){var V=P[b];return V===i?void 0:V}return g.call(P,b)?P[b]:void 0}function Pc(b){var P=this.__data__;return Me?P[b]!==void 0:g.call(P,b)}function Nc(b,P){var V=this.__data__;return this.size+=this.has(b)?0:1,V[b]=Me&&P===void 0?i:P,this}Re.prototype.clear=Ze,Re.prototype.delete=Qe,Re.prototype.get=Tc,Re.prototype.has=Pc,Re.prototype.set=Nc;function Lt(b){var P=-1,V=b==null?0:b.length;for(this.clear();++P<V;){var ie=b[P];this.set(ie[0],ie[1])}}function Rc(){this.__data__=[],this.size=0}function Fc(b){var P=this.__data__,V=Qr(P,b);if(V<0)return!1;var ie=P.length-1;return V==ie?P.pop():De.call(P,V,1),--this.size,!0}function Uc(b){var P=this.__data__,V=Qr(P,b);return V<0?void 0:P[V][1]}function Lc(b){return Qr(this.__data__,b)>-1}function Mc(b,P){var V=this.__data__,ie=Qr(V,b);return ie<0?(++this.size,V.push([b,P])):V[ie][1]=P,this}Lt.prototype.clear=Rc,Lt.prototype.delete=Fc,Lt.prototype.get=Uc,Lt.prototype.has=Lc,Lt.prototype.set=Mc;function Zt(b){var P=-1,V=b==null?0:b.length;for(this.clear();++P<V;){var ie=b[P];this.set(ie[0],ie[1])}}function Bc(){this.size=0,this.__data__={hash:new Re,map:new(Le||Lt),string:new Re}}function $c(b){var P=ei(this,b).delete(b);return this.size-=P?1:0,P}function jc(b){return ei(this,b).get(b)}function Hc(b){return ei(this,b).has(b)}function zc(b,P){var V=ei(this,b),ie=V.size;return V.set(b,P),this.size+=V.size==ie?0:1,this}Zt.prototype.clear=Bc,Zt.prototype.delete=$c,Zt.prototype.get=jc,Zt.prototype.has=Hc,Zt.prototype.set=zc;function Zr(b){var P=-1,V=b==null?0:b.length;for(this.__data__=new Zt;++P<V;)this.add(b[P])}function qc(b){return this.__data__.set(b,i),this}function Kc(b){return this.__data__.has(b)}Zr.prototype.add=Zr.prototype.push=qc,Zr.prototype.has=Kc;function zt(b){var P=this.__data__=new Lt(b);this.size=P.size}function Vc(){this.__data__=new Lt,this.size=0}function kc(b){var P=this.__data__,V=P.delete(b);return this.size=P.size,V}function Wc(b){return this.__data__.get(b)}function Gc(b){return this.__data__.has(b)}function Yc(b,P){var V=this.__data__;if(V instanceof Lt){var ie=V.__data__;if(!Le||ie.length<r-1)return ie.push([b,P]),this.size=++V.size,this;V=this.__data__=new Zt(ie)}return V.set(b,P),this.size=V.size,this}zt.prototype.clear=Vc,zt.prototype.delete=kc,zt.prototype.get=Wc,zt.prototype.has=Gc,zt.prototype.set=Yc;function Jc(b,P){var V=ti(b),ie=!V&&lu(b),Pe=!V&&!ie&&Fi(b),we=!V&&!ie&&!Pe&&ns(b),Be=V||ie||Pe||we,et=Be?Fe(b.length,String):[],tt=et.length;for(var Ue in b)(P||g.call(b,Ue))&&!(Be&&(Ue=="length"||Pe&&(Ue=="offset"||Ue=="parent")||we&&(Ue=="buffer"||Ue=="byteLength"||Ue=="byteOffset")||ou(Ue,tt)))&&et.push(Ue);return et}function Qr(b,P){for(var V=b.length;V--;)if(es(b[V][0],P))return V;return-1}function Xc(b,P,V){var ie=P(b);return ti(b)?ie:_e(ie,V(b))}function Er(b){return b==null?b===void 0?q:W:pt&&pt in Object(b)?nu(b):hu(b)}function Jn(b){return vr(b)&&Er(b)==o}function Xn(b,P,V,ie,Pe){return b===P?!0:b==null||P==null||!vr(b)&&!vr(P)?b!==b&&P!==P:Zc(b,P,V,ie,Xn,Pe)}function Zc(b,P,V,ie,Pe,we){var Be=ti(b),et=ti(P),tt=Be?f:qt(b),Ue=et?f:qt(P);tt=tt==o?A:tt,Ue=Ue==o?A:Ue;var gt=tt==A,It=Ue==A,st=tt==Ue;if(st&&Fi(b)){if(!Fi(P))return!1;Be=!0,gt=!1}if(st&&!gt)return we||(we=new zt),Be||ns(b)?Zn(b,P,V,ie,Pe,we):ru(b,P,tt,V,ie,Pe,we);if(!(V&n)){var mt=gt&&g.call(b,"__wrapped__"),_t=It&&g.call(P,"__wrapped__");if(mt||_t){var Kt=mt?b.value():b,Mt=_t?P.value():P;return we||(we=new zt),Pe(Kt,Mt,V,ie,we)}}return st?(we||(we=new zt),iu(b,P,V,ie,Pe,we)):!1}function Qc(b){if(!is(b)||cu(b))return!1;var P=ts(b)?M:J;return P.test(Qt(b))}function eu(b){return vr(b)&&rs(b.length)&&!!re[Er(b)]}function tu(b){if(!uu(b))return Xr(b);var P=[];for(var V in Object(b))g.call(b,V)&&V!="constructor"&&P.push(V);return P}function Zn(b,P,V,ie,Pe,we){var Be=V&n,et=b.length,tt=P.length;if(et!=tt&&!(Be&&tt>et))return!1;var Ue=we.get(b);if(Ue&&we.get(P))return Ue==P;var gt=-1,It=!0,st=V&a?new Zr:void 0;for(we.set(b,P),we.set(P,b);++gt<et;){var mt=b[gt],_t=P[gt];if(ie)var Kt=Be?ie(_t,mt,gt,P,b,we):ie(mt,_t,gt,b,P,we);if(Kt!==void 0){if(Kt)continue;It=!1;break}if(st){if(!Se(P,function(Mt,er){if(!Ee(st,er)&&(mt===Mt||Pe(mt,Mt,V,ie,we)))return st.push(er)})){It=!1;break}}else if(!(mt===_t||Pe(mt,_t,V,ie,we))){It=!1;break}}return we.delete(b),we.delete(P),It}function ru(b,P,V,ie,Pe,we,Be){switch(V){case se:if(b.byteLength!=P.byteLength||b.byteOffset!=P.byteOffset)return!1;b=b.buffer,P=P.buffer;case Z:return!(b.byteLength!=P.byteLength||!we(new ve(b),new ve(P)));case m:case C:case B:return es(+b,+P);case L:return b.name==P.name&&b.message==P.message;case E:case c:return b==P+"";case $:var et=he;case v:var tt=ie&n;if(et||(et=me),b.size!=P.size&&!tt)return!1;var Ue=Be.get(b);if(Ue)return Ue==P;ie|=a,Be.set(b,P);var gt=Zn(et(b),et(P),ie,Pe,we,Be);return Be.delete(b),gt;case y:if(Ke)return Ke.call(b)==Ke.call(P)}return!1}function iu(b,P,V,ie,Pe,we){var Be=V&n,et=Qn(b),tt=et.length,Ue=Qn(P),gt=Ue.length;if(tt!=gt&&!Be)return!1;for(var It=tt;It--;){var st=et[It];if(!(Be?st in P:g.call(P,st)))return!1}var mt=we.get(b);if(mt&&we.get(P))return mt==P;var _t=!0;we.set(b,P),we.set(P,b);for(var Kt=Be;++It<tt;){st=et[It];var Mt=b[st],er=P[st];if(ie)var ss=Be?ie(er,Mt,st,P,b,we):ie(Mt,er,st,b,P,we);if(!(ss===void 0?Mt===er||Pe(Mt,er,V,ie,we):ss)){_t=!1;break}Kt||(Kt=st=="constructor")}if(_t&&!Kt){var ri=b.constructor,ii=P.constructor;ri!=ii&&"constructor"in b&&"constructor"in P&&!(typeof ri=="function"&&ri instanceof ri&&typeof ii=="function"&&ii instanceof ii)&&(_t=!1)}return we.delete(b),we.delete(P),_t}function Qn(b){return Xc(b,pu,su)}function ei(b,P){var V=b.__data__;return au(P)?V[typeof P=="string"?"string":"hash"]:V.map}function lr(b,P){var V=be(b,P);return Qc(V)?V:void 0}function nu(b){var P=g.call(b,pt),V=b[pt];try{b[pt]=void 0;var ie=!0}catch{}var Pe=N.call(b);return ie&&(P?b[pt]=V:delete b[pt]),Pe}var su=Xt?function(b){return b==null?[]:(b=Object(b),xe(Xt(b),function(P){return Ie.call(b,P)}))}:gu,qt=Er;(je&&qt(new je(new ArrayBuffer(1)))!=se||Le&&qt(new Le)!=$||He&&qt(He.resolve())!=R||ze&&qt(new ze)!=v||qe&&qt(new qe)!=Y)&&(qt=function(b){var P=Er(b),V=P==A?b.constructor:void 0,ie=V?Qt(V):"";if(ie)switch(ie){case We:return se;case Ge:return $;case Ye:return R;case Je:return v;case Xe:return Y}return P});function ou(b,P){return P=P??l,!!P&&(typeof b=="number"||ce.test(b))&&b>-1&&b%1==0&&b<P}function au(b){var P=typeof b;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?b!=="__proto__":b===null}function cu(b){return!!S&&S in b}function uu(b){var P=b&&b.constructor,V=typeof P=="function"&&P.prototype||d;return b===V}function hu(b){return N.call(b)}function Qt(b){if(b!=null){try{return u.call(b)}catch{}try{return b+""}catch{}}return""}function es(b,P){return b===P||b!==b&&P!==P}var lu=Jn(function(){return arguments}())?Jn:function(b){return vr(b)&&g.call(b,"callee")&&!Ie.call(b,"callee")},ti=Array.isArray;function fu(b){return b!=null&&rs(b.length)&&!ts(b)}var Fi=_r||yu;function du(b,P){return Xn(b,P)}function ts(b){if(!is(b))return!1;var P=Er(b);return P==O||P==I||P==p||P==_}function rs(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=l}function is(b){var P=typeof b;return b!=null&&(P=="object"||P=="function")}function vr(b){return b!=null&&typeof b=="object"}var ns=fe?Ne(fe):eu;function pu(b){return fu(b)?Jc(b):tu(b)}function gu(){return[]}function yu(){return!1}t.exports=du})(Rn,Rn.exports);var y0=Rn.exports;function w0(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var a=t.charAt(n),l=a.charCodeAt(0);if(r[l]!==255)throw new TypeError(a+" is ambiguous");r[l]=n}var o=t.length,f=t.charAt(0),p=Math.log(o)/Math.log(256),m=Math.log(256)/Math.log(o);function C(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(I.length===0)return"";for(var $=0,B=0,W=0,A=I.length;W!==A&&I[W]===0;)W++,$++;for(var R=(A-W)*m+1>>>0,_=new Uint8Array(R);W!==A;){for(var E=I[W],v=0,c=R-1;(E!==0||v<B)&&c!==-1;c--,v++)E+=256*_[c]>>>0,_[c]=E%o>>>0,E=E/o>>>0;if(E!==0)throw new Error("Non-zero carry");B=v,W++}for(var y=R-B;y!==R&&_[y]===0;)y++;for(var q=f.repeat($);y<R;++y)q+=t.charAt(_[y]);return q}function L(I){if(typeof I!="string")throw new TypeError("Expected String");if(I.length===0)return new Uint8Array;var $=0;if(I[$]!==" "){for(var B=0,W=0;I[$]===f;)B++,$++;for(var A=(I.length-$)*p+1>>>0,R=new Uint8Array(A);I[$];){var _=r[I.charCodeAt($)];if(_===255)return;for(var E=0,v=A-1;(_!==0||E<W)&&v!==-1;v--,E++)_+=o*R[v]>>>0,R[v]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");W=E,$++}if(I[$]!==" "){for(var c=A-W;c!==A&&R[c]===0;)c++;for(var y=new Uint8Array(B+(A-c)),q=B;c!==A;)y[q++]=R[c++];return y}}}function O(I){var $=L(I);if($)return $;throw new Error(`Non-${e} character`)}return{encode:C,decodeUnsafe:L,decode:O}}var b0=w0,m0=b0;const Pa=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},_0=t=>new TextEncoder().encode(t),E0=t=>new TextDecoder().decode(t);class v0{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class D0{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Na(this,e)}}class x0{constructor(e){this.decoders=e}or(e){return Na(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Na=(t,e)=>new x0({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class S0{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new v0(e,r,i),this.decoder=new D0(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const vi=({name:t,prefix:e,encode:r,decode:i})=>new S0(t,e,r,i),Kr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=m0(r,e);return vi({prefix:t,name:e,encode:i,decode:a=>Pa(n(a))})},I0=(t,e,r,i)=>{const n={};for(let m=0;m<e.length;++m)n[e[m]]=m;let a=t.length;for(;t[a-1]==="=";)--a;const l=new Uint8Array(a*r/8|0);let o=0,f=0,p=0;for(let m=0;m<a;++m){const C=n[t[m]];if(C===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|C,o+=r,o>=8&&(o-=8,l[p++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return l},O0=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let a="",l=0,o=0;for(let f=0;f<t.length;++f)for(o=o<<8|t[f],l+=8;l>r;)l-=r,a+=e[n&o>>l];if(l&&(a+=e[n&o<<r-l]),i)for(;a.length*r&7;)a+="=";return a},nt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>vi({prefix:e,name:t,encode(n){return O0(n,i,r)},decode(n){return I0(n,i,r,t)}}),C0=vi({prefix:"\0",name:"identity",encode:t=>E0(t),decode:t=>_0(t)});var A0=Object.freeze({__proto__:null,identity:C0});const T0=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var P0=Object.freeze({__proto__:null,base2:T0});const N0=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var R0=Object.freeze({__proto__:null,base8:N0});const F0=Kr({prefix:"9",name:"base10",alphabet:"0123456789"});var U0=Object.freeze({__proto__:null,base10:F0});const L0=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),M0=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var B0=Object.freeze({__proto__:null,base16:L0,base16upper:M0});const $0=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),j0=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),H0=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),z0=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),q0=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),K0=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),V0=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),k0=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),W0=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var G0=Object.freeze({__proto__:null,base32:$0,base32upper:j0,base32pad:H0,base32padupper:z0,base32hex:q0,base32hexupper:K0,base32hexpad:V0,base32hexpadupper:k0,base32z:W0});const Y0=Kr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),J0=Kr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var X0=Object.freeze({__proto__:null,base36:Y0,base36upper:J0});const Z0=Kr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Q0=Kr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var eg=Object.freeze({__proto__:null,base58btc:Z0,base58flickr:Q0});const tg=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),rg=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ig=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ng=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var sg=Object.freeze({__proto__:null,base64:tg,base64pad:rg,base64url:ig,base64urlpad:ng});const Ra=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),og=Ra.reduce((t,e,r)=>(t[r]=e,t),[]),ag=Ra.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function cg(t){return t.reduce((e,r)=>(e+=og[r],e),"")}function ug(t){const e=[];for(const r of t){const i=ag[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const hg=vi({prefix:"\u{1F680}",name:"base256emoji",encode:cg,decode:ug});var lg=Object.freeze({__proto__:null,base256emoji:hg}),fg=Ua,Fa=128,dg=127,pg=~dg,gg=Math.pow(2,31);function Ua(t,e,r){e=e||[],r=r||0;for(var i=r;t>=gg;)e[r++]=t&255|Fa,t/=128;for(;t&pg;)e[r++]=t&255|Fa,t>>>=7;return e[r]=t|0,Ua.bytes=r-i+1,e}var yg=Fn,wg=128,La=127;function Fn(t,i){var r=0,i=i||0,n=0,a=i,l,o=t.length;do{if(a>=o)throw Fn.bytes=0,new RangeError("Could not decode varint");l=t[a++],r+=n<28?(l&La)<<n:(l&La)*Math.pow(2,n),n+=7}while(l>=wg);return Fn.bytes=a-i,r}var bg=Math.pow(2,7),mg=Math.pow(2,14),_g=Math.pow(2,21),Eg=Math.pow(2,28),vg=Math.pow(2,35),Dg=Math.pow(2,42),xg=Math.pow(2,49),Sg=Math.pow(2,56),Ig=Math.pow(2,63),Og=function(t){return t<bg?1:t<mg?2:t<_g?3:t<Eg?4:t<vg?5:t<Dg?6:t<xg?7:t<Sg?8:t<Ig?9:10},Cg={encode:fg,decode:yg,encodingLength:Og},Ma=Cg;const Ba=(t,e,r=0)=>(Ma.encode(t,e,r),e),$a=t=>Ma.encodingLength(t),Un=(t,e)=>{const r=e.byteLength,i=$a(t),n=i+$a(r),a=new Uint8Array(n+r);return Ba(t,a,0),Ba(r,a,i),a.set(e,n),new Ag(t,r,e,a)};class Ag{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const ja=({name:t,code:e,encode:r})=>new Tg(t,e,r);class Tg{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Un(this.code,r):r.then(i=>Un(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Ha=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Pg=ja({name:"sha2-256",code:18,encode:Ha("SHA-256")}),Ng=ja({name:"sha2-512",code:19,encode:Ha("SHA-512")});var Rg=Object.freeze({__proto__:null,sha256:Pg,sha512:Ng});const za=0,Fg="identity",qa=Pa,Ug=t=>Un(za,qa(t)),Lg={code:za,name:Fg,encode:qa,digest:Ug};var Mg=Object.freeze({__proto__:null,identity:Lg});new TextEncoder,new TextDecoder;const Ka={...A0,...P0,...R0,...U0,...B0,...G0,...X0,...eg,...sg,...lg};({...Rg,...Mg});function Bg(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Va(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const ka=Va("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ln=Va("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Bg(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),$g={utf8:ka,"utf-8":ka,hex:Ka.base16,latin1:Ln,ascii:Ln,binary:Ln,...Ka};function jg(t,e="utf8"){const r=$g[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const Wa="wc",Hg=2,Mn="core",Wt=`${Wa}@${2}:${Mn}:`,zg={name:Mn,logger:"error"},qg={database:":memory:"},Kg="crypto",Ga="client_ed25519_seed",Vg=le.ONE_DAY,kg="keychain",Wg="0.3",Gg="messages",Yg="0.3",Jg=le.SIX_HOURS,Xg="publisher",Ya="irn",Zg="error",Qg="wss://relay.walletconnect.com",ey="relayer",dt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed"},ty="_subscription",Di={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Ja=le.ONE_SECOND,ry="2.1.3",iy="0.3",Rt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ny="subscription",sy="0.3",oy=le.FIVE_SECONDS*1e3,ay="pairing",cy="0.3",Vr={wc_pairingDelete:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:le.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:le.ONE_DAY,prompt:!1,tag:0},res:{ttl:le.ONE_DAY,prompt:!1,tag:0}}},Ft={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},uy="history",hy="0.3",ly="expirer",Dt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},fy="0.3";class dy{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=kg,this.version=Wg,this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:a}=ee("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(a)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ra(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ia(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}class py{constructor(e,r,i){this.core=e,this.logger=r,this.name=Kg,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),a=Do(n);return vo(a.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=Wd();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const a=await this.getClientSeed(),l=Do(a),o=_n();return await td(o,n,Vg,l)},this.generateSharedKey=(n,a,l)=>{this.isInitialized();const o=this.getPrivateKey(n),f=Gd(o,a);return this.setSymKey(f,l)},this.setSymKey=async(n,a)=>{this.isInitialized();const l=a||Yd(n);return await this.keychain.set(l,n),l},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,a,l)=>{this.isInitialized();const o=Jo(l),f=Lr(a);if(Xo(o)){const L=o.senderPublicKey,O=o.receiverPublicKey;n=await this.generateSharedKey(L,O)}const p=this.getSymKey(n),{type:m,senderPublicKey:C}=o;return Xd({type:m,symKey:p,message:f,senderPublicKey:C})},this.decode=async(n,a,l)=>{this.isInitialized();const o=ep(a,l);if(Xo(o)){const m=o.receiverPublicKey,C=o.senderPublicKey;n=await this.generateSharedKey(m,C)}const f=this.getSymKey(n),p=Zd({symKey:f,encoded:a});return Yi(p)},this.core=e,this.logger=Oe.generateChildLogger(r,this.name),this.keychain=i||new dy(this.core,this.logger)}get context(){return Oe.getLoggerContext(this.logger)}getPayloadType(e){const r=vn(e);return jr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Ga)}catch{e=_n(),await this.keychain.set(Ga,e)}return jg(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}class gy extends Fh{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=Gg,this.version=Yg,this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const a=En(n);let l=this.messages.get(i);return typeof l>"u"&&(l={}),typeof l[a]<"u"||(l[a]=n,this.messages.set(i,l),await this.persist()),a},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const a=this.get(i),l=En(n);return typeof a[l]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Oe.generateChildLogger(e,this.name),this.core=r}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ra(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ia(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}class yy extends Uh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ot.exports.EventEmitter,this.name=Xg,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,a)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:a}});try{const l=a?.ttl||Jg,o=Dn(a),f=a?.prompt||!1,p=a?.tag||0,m={topic:i,message:n,opts:{ttl:l,relay:o,prompt:f,tag:p}},C=En(n);this.queue.set(C,m);try{await await na(this.rpcPublish(i,n,l,o,f,p),this.publishTimeout)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(dt.connection_stalled);return}this.onPublish(C,m),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:a}})}catch(l){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(l),l}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Oe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Oe.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,a,l){var o,f,p,m;const C={method:xn(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:a,tag:l}};return vt((o=C.params)==null?void 0:o.prompt)&&((f=C.params)==null||delete f.prompt),vt((p=C.params)==null?void 0:p.tag)&&((m=C.params)==null||delete m.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:C}),this.relayer.provider.request(C)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Pr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class wy{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(a=>a!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var by=Object.defineProperty,my=Object.defineProperties,_y=Object.getOwnPropertyDescriptors,Xa=Object.getOwnPropertySymbols,Ey=Object.prototype.hasOwnProperty,vy=Object.prototype.propertyIsEnumerable,Za=(t,e,r)=>e in t?by(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xi=(t,e)=>{for(var r in e||(e={}))Ey.call(e,r)&&Za(t,r,e[r]);if(Xa)for(var r of Xa(e))vy.call(e,r)&&Za(t,r,e[r]);return t},Bn=(t,e)=>my(t,_y(e));class Dy extends Bh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new wy,this.events=new ot.exports.EventEmitter,this.name=ny,this.version=sy,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Wt,this.subscribeTimeout=1e4,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const a=Dn(n),l={topic:i,relay:a};this.pending.set(i,l);const o=await this.rpcSubscribe(i,a);return this.onSubscribe(o,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),o}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}},this.unsubscribe=async(i,n)=>{this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,a)=>{const l=new le.Watch;l.start(this.pendingSubscriptionWatchLabel);const o=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(o),l.stop(this.pendingSubscriptionWatchLabel),n(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=oy&&(clearInterval(o),l.stop(this.pendingSubscriptionWatchLabel),a(!1))},this.pendingSubInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=e,this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=Dn(i);await this.rpcUnsubscribe(e,r,n);const a=ke("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,a),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:xn(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let n;try{n=await await na(this.relayer.provider.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(dt.connection_stalled)}return n}rpcUnsubscribe(e,r,i){const n={method:xn(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(e,r){this.setSubscription(e,Bn(xi({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,Bn(xi({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,xi({},r)),this.topicMap.set(r.topic,e),this.events.emit(Rt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Rt.deleted,Bn(xi({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Rt.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(Rt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:i}=e,n={topic:r,relay:i};this.pending.set(n.topic,n);const a=await this.rpcSubscribe(n.topic,n.relay);this.onResubscribe(a,n)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Pr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(dt.connect,async()=>{await this.onConnect()}),this.relayer.on(dt.disconnect,()=>{this.onDisconnect()}),this.events.on(Rt.created,async e=>{const r=Rt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Rt.deleted,async e=>{const r=Rt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}var xy=Object.defineProperty,Qa=Object.getOwnPropertySymbols,Sy=Object.prototype.hasOwnProperty,Iy=Object.prototype.propertyIsEnumerable,ec=(t,e,r)=>e in t?xy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Oy=(t,e)=>{for(var r in e||(e={}))Sy.call(e,r)&&ec(t,r,e[r]);if(Qa)for(var r of Qa(e))Iy.call(e,r)&&ec(t,r,e[r]);return t};class Cy extends Lh{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ot.exports.EventEmitter,this.name=ey,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Oe.generateChildLogger(e.logger,this.name):Dr(Oe.getDefaultLoggerOptions({level:e.logger||Zg})),this.messages=new gy(this.logger,e.core),this.subscriber=new Dy(this,this.logger),this.publisher=new yy(this,this.logger),this.relayUrl=e?.relayUrl||Qg,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Oe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(Rt.created,a=>{a.topic===e&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(e,r),n()})]),i}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&await this.provider.disconnect(),this.events.emit(dt.transport_closed)}async transportOpen(e){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Rt.resubscribed,()=>{r()})}),await Promise.race([this.provider.connect(),new Promise((r,i)=>this.once(dt.transport_closed,()=>{i()}))])])}catch(r){const i=r;if(!/socket hang up/i.test(i.message))throw new Error(i.message);this.logger.error(i),this.events.emit(dt.transport_closed)}}async restartTransport(e){await this.transportClose(),await new Promise(r=>setTimeout(r,Ja)),await this.transportOpen(e)}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new Nn(new g0(pp({sdkVersion:ry,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Tn(e)){if(!e.method.endsWith(ty))return;const r=e.params,{topic:i,message:n}=r.data,a={topic:i,message:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Oy({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(dt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=An(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(Di.payload,e=>this.onProviderPayload(e)),this.provider.on(Di.connect,()=>{this.events.emit(dt.connect)}),this.provider.on(Di.disconnect,()=>{this.events.emit(dt.disconnect),this.attemptToReconnect()}),this.provider.on(Di.error,e=>this.events.emit(dt.error,e)),this.events.on(dt.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},le.toMiliseconds(Ja))}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Ay=Object.defineProperty,tc=Object.getOwnPropertySymbols,Ty=Object.prototype.hasOwnProperty,Py=Object.prototype.propertyIsEnumerable,rc=(t,e,r)=>e in t?Ay(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ic=(t,e)=>{for(var r in e||(e={}))Ty.call(e,r)&&rc(t,r,e[r]);if(tc)for(var r of tc(e))Py.call(e,r)&&rc(t,r,e[r]);return t};class Si extends Mh{constructor(e,r,i,n=Wt,a=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=iy,this.cached=[],this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{Fp(l)?this.map.set(l.id,l):Up(l)?this.map.set(l.topic,l):this.getKey&&l!==null&&!vt(l)&&this.map.set(this.getKey(l),l)}),this.cached=[],this.initialized=!0)},this.set=async(l,o)=>{this.isInitialized(),this.map.has(l)?await this.update(l,o):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:o}),this.map.set(l,o),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(o=>Object.keys(l).every(f=>y0(o[f],l[f]))):this.values),this.update=async(l,o)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:o});const f=ic(ic({},this.getData(l)),o);this.map.set(l,f),await this.persist()},this.delete=async(l,o)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:o}),this.map.delete(l),await this.persist())},this.logger=Oe.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=a}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ny{constructor(e,r){this.core=e,this.logger=r,this.name=ay,this.version=cy,this.events=new ot.exports,this.initialized=!1,this.storagePrefix=Wt,this.ignoredPayloadTypes=[ar],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=_n(),n=await this.core.crypto.setSymKey(i),a=Bt(le.FIVE_MINUTES),l={protocol:Ya},o={topic:n,expiry:a,relay:l,active:!1},f=Sp({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:l});return await this.pairings.set(n,o),await this.core.relayer.subscribe(n),this.core.expirer.set(n,a),{topic:n,uri:f}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:a,relay:l}=Dp(i.uri),o=Bt(le.FIVE_MINUTES),f={topic:n,relay:l,expiry:o,active:!1};return await this.pairings.set(n,f),await this.core.crypto.setSymKey(a,n),await this.core.relayer.subscribe(n,{relay:l}),this.core.expirer.set(n,o),i.activatePairing&&await this.activate({topic:n}),f},this.activate=async({topic:i})=>{this.isInitialized();const n=Bt(le.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const a=await this.sendRequest(n,"wc_pairingPing",{}),{done:l,resolve:o,reject:f}=cr();this.events.once($e("pairing_ping",a),({error:p})=>{p?f(p):o()}),await l()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",ke("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,a)=>{const l=_i(n,a),o=await this.core.crypto.encode(i,l),f=Vr[n].req;return this.core.history.set(i,l),await this.core.relayer.publish(i,o,f),l.id},this.sendResult=async(i,n,a)=>{const l=An(i,a),o=await this.core.crypto.encode(n,l),f=await this.core.history.get(n,i),p=Vr[f.request.method].res;await this.core.relayer.publish(n,o,p),await this.core.history.resolve(l)},this.sendError=async(i,n,a)=>{const l=Ei(i,a),o=await this.core.crypto.encode(n,l),f=await this.core.history.get(n,i),p=Vr[f.request.method]?Vr[f.request.method].res:Vr.unregistered_method.res;await this.core.relayer.publish(n,o,p),await this.core.history.resolve(l)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,ke("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>kt(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:a}=i;switch(a.method){case"wc_pairingPing":return this.onPairingPingRequest(n,a);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,a);default:return this.onUnknownRpcMethodRequest(n,a)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:a}=i,l=(await this.core.history.get(n,a.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(n,a);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(i,n)=>{const{id:a}=n;try{this.isValidPing({topic:i}),await this.sendResult(a,i,!0),this.events.emit("pairing_ping",{id:a,topic:i})}catch(l){await this.sendError(a,i,l),this.logger.error(l)}},this.onPairingPingResponse=(i,n)=>{const{id:a}=n;setTimeout(()=>{Ht(n)?this.events.emit($e("pairing_ping",a),{}):At(n)&&this.events.emit($e("pairing_ping",a),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:i}),await this.sendResult(a,i,!0),await this.deletePairing(i),this.events.emit("pairing_delete",{id:a,topic:i})}catch(l){await this.sendError(a,i,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:a,method:l}=n;try{if(this.registeredMethods.includes(l))return;const o=ke("WC_METHOD_UNSUPPORTED",l);await this.sendError(a,i,o),this.logger.error(o)}catch(o){await this.sendError(a,i,o),this.logger.error(o)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(ke("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!ft(i)){const{message:n}=ee("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!Rp(i.uri)){const{message:n}=ee("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!ft(i)){const{message:a}=ee("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!ft(i)){const{message:a}=ee("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!it(i,!1)){const{message:n}=ee("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(kt(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=ee("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=Oe.generateChildLogger(r,this.name),this.pairings=new Si(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Oe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(dt.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);Tn(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Pn(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(Dt.expired,async e=>{const{topic:r}=oa(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Ry extends Rh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ot.exports.EventEmitter,this.name=uy,this.version=hy,this.cached=[],this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,a)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:a}),this.records.has(n.id))return;const l={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:a};this.records.set(l.id,l),this.events.emit(Ft.created,l)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=At(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(Ft.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(a=>{if(a.topic===i){if(typeof n<"u"&&a.id!==n)return;this.records.delete(a.id),this.events.emit(Ft.deleted,a)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:_i(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ft.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ft.created,e=>{const r=Ft.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ft.updated,e=>{const r=Ft.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ft.deleted,e=>{const r=Ft.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Fy extends $h{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ot.exports.EventEmitter,this.name=ly,this.version=fy,this.cached=[],this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const a=this.formatTarget(i),l={target:a,expiry:n};this.expirations.set(a,l),this.checkExpiry(a,l),this.events.emit(Dt.created,{target:a,expiration:l})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{this.isInitialized();const n=this.formatTarget(i);if(this.has(n)){const a=this.getExpiration(n);this.expirations.delete(n),this.events.emit(Dt.deleted,{target:n,expiration:a})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return gp(e);if(typeof e=="number")return yp(e);const{message:r}=ee("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Dt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;le.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Dt.expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Pr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Dt.created,e=>{const r=Dt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Dt.expired,e=>{const r=Dt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Dt.deleted,e=>{const r=Dt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Uy=Object.defineProperty,nc=Object.getOwnPropertySymbols,Ly=Object.prototype.hasOwnProperty,My=Object.prototype.propertyIsEnumerable,sc=(t,e,r)=>e in t?Uy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,oc=(t,e)=>{for(var r in e||(e={}))Ly.call(e,r)&&sc(t,r,e[r]);if(nc)for(var r of nc(e))My.call(e,r)&&sc(t,r,e[r]);return t};class Wn extends Nh{constructor(e){super(e),this.protocol=Wa,this.version=Hg,this.name=Mn,this.events=new ot.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Dr(Oe.getDefaultLoggerOptions({level:e?.logger||zg.logger}));this.logger=Oe.generateChildLogger(r,this.name),this.heartbeat=new Pr.HeartBeat,this.crypto=new py(this,this.logger,e?.keychain),this.history=new Ry(this,this.logger),this.expirer=new Fy(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new wh(oc(oc({},qg),e?.storageOptions)),this.relayer=new Cy({core:this,logger:this.logger,relayUrl:e?.relayUrl,projectId:this.projectId}),this.pairing=new Ny(this,this.logger)}static async init(e){const r=new Wn(e);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initilization Success")}catch(e){throw this.logger.warn(`Core Initilization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const By=Wn,ac="wc",cc=2,uc="client",$n=`${ac}@${cc}:${uc}:`,jn={name:uc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},$y="proposal",jy="session",Ii=le.SEVEN_DAYS,Hy="engine",kr={wc_sessionPropose:{req:{ttl:le.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1104},res:{ttl:le.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1106},res:{ttl:le.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:le.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:le.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1112},res:{ttl:le.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1115}}},zy="request";var qy=Object.defineProperty,Ky=Object.defineProperties,Vy=Object.getOwnPropertyDescriptors,hc=Object.getOwnPropertySymbols,ky=Object.prototype.hasOwnProperty,Wy=Object.prototype.propertyIsEnumerable,lc=(t,e,r)=>e in t?qy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Gt=(t,e)=>{for(var r in e||(e={}))ky.call(e,r)&&lc(t,r,e[r]);if(hc)for(var r of hc(e))Wy.call(e,r)&&lc(t,r,e[r]);return t},fc=(t,e)=>Ky(t,Vy(e));class Gy extends Hh{constructor(e){super(e),this.name=Hy,this.events=new ot.exports,this.initialized=!1,this.ignoredPayloadTypes=[ar],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(kr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized(),await this.isValidConnect(r);const{pairingTopic:i,requiredNamespaces:n,relays:a}=r;let l=i,o,f=!1;if(l&&(f=this.client.core.pairing.pairings.get(l).active),!l||!f){const{topic:B,uri:W}=await this.client.core.pairing.create();l=B,o=W}const p=await this.client.core.crypto.generateKeyPair(),m={requiredNamespaces:n,relays:a??[{protocol:Ya}],proposer:{publicKey:p,metadata:this.client.metadata}},{reject:C,resolve:L,done:O}=cr();if(this.events.once($e("session_connect"),async({error:B,session:W})=>{if(B)C(B);else if(W){W.self.publicKey=p;const A=fc(Gt({},W),{requiredNamespaces:n});await this.client.session.set(W.topic,A),await this.setExpiry(W.topic,W.expiry),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:W.peer.metadata}),L(A)}}),!l){const{message:B}=ee("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(B)}const I=await this.sendRequest(l,"wc_sessionPropose",m),$=Bt(le.FIVE_MINUTES);return await this.setProposal(I,Gt({id:I,expiry:$},m)),{uri:o,approval:O}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:a}=r,{pairingTopic:l,proposer:o,requiredNamespaces:f}=this.client.proposal.get(i),p=await this.client.core.crypto.generateKeyPair(),m=o.publicKey,C=await this.client.core.crypto.generateSharedKey(p,m),L={relay:{protocol:n??"irn"},namespaces:a,requiredNamespaces:f,controller:{publicKey:p,metadata:this.client.metadata},expiry:Bt(Ii)};await this.client.core.relayer.subscribe(C);const O=await this.sendRequest(C,"wc_sessionSettle",L),{done:I,resolve:$,reject:B}=cr();this.events.once($e("session_approve",O),({error:A})=>{A?B(A):$(this.client.session.get(C))});const W=fc(Gt({},L),{topic:C,acknowledged:!1,self:L.controller,peer:{publicKey:o.publicKey,metadata:o.metadata},controller:p});return await this.client.session.set(C,W),await this.setExpiry(C,Bt(Ii)),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:W.peer.metadata}),l&&i&&(await this.sendResult(i,l,{relay:{protocol:n??"irn"},responderPublicKey:p}),await this.client.proposal.delete(i,ke("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:l})),{topic:C,acknowledged:I}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:a}=this.client.proposal.get(i);a&&(await this.sendError(i,a,n),await this.client.proposal.delete(i,ke("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,a=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:l,resolve:o,reject:f}=cr();return this.events.once($e("session_update",a),({error:p})=>{p?f(p):o()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:l}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:a,resolve:l,reject:o}=cr();return this.events.once($e("session_extend",n),({error:f})=>{f?o(f):l()}),await this.setExpiry(i,Bt(Ii)),{acknowledged:a}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:a}=r,l=await this.sendRequest(a,"wc_sessionRequest",{request:n,chainId:i}),{done:o,resolve:f,reject:p}=cr();return this.events.once($e("session_request",l),({error:m,result:C})=>{m?p(m):f(C)}),await o()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:a}=n;Ht(n)?await this.sendResult(a,i,n.result):At(n)&&await this.sendError(a,i,n.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:a,resolve:l,reject:o}=cr();this.events.once($e("session_ping",n),({error:f})=>{f?o(f):l()}),await a()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:a}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:a})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",ke("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>Pp(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,ke("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(r),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,ke("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=kr.wc_sessionRequest.req.ttl,{id:n,topic:a,params:l}=r;await this.client.pendingRequest.set(n,{id:n,topic:a,params:l}),i&&this.client.core.expirer.set(n,i)},this.sendRequest=async(r,i,n)=>{const a=_i(i,n),l=await this.client.core.crypto.encode(r,a),o=kr[i].req;return this.client.core.history.set(r,a),this.client.core.relayer.publish(r,l,o),a.id},this.sendResult=async(r,i,n)=>{const a=An(r,n),l=await this.client.core.crypto.encode(i,a),o=await this.client.core.history.get(i,r),f=kr[o.request.method].res;this.client.core.relayer.publish(i,l,f),await this.client.core.history.resolve(a)},this.sendError=async(r,i,n)=>{const a=Ei(r,n),l=await this.client.core.crypto.encode(i,a),o=await this.client.core.history.get(i,r),f=kr[o.request.method].res;this.client.core.relayer.publish(i,l,f),await this.client.core.history.resolve(a)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{kt(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{kt(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,a=n.method;switch(a){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${a}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,a=(await this.client.core.history.get(i,n.id)).request.method;switch(a){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${a}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:a}=i;try{this.isValidConnect(Gt({},i.params));const l=Bt(le.FIVE_MINUTES),o=Gt({id:a,pairingTopic:r,expiry:l},n);await this.setProposal(a,o),this.client.events.emit("session_proposal",{id:a,params:o})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(Ht(i)){const{result:a}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:a});const l=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const o=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});const f=a.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:f});const p=await this.client.core.crypto.generateSharedKey(o,f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const m=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:m}),await this.client.core.pairing.activate({topic:r})}else At(i)&&(await this.client.proposal.delete(n,ke("USER_DISCONNECTED")),this.events.emit($e("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:a}=i;try{this.isValidSessionSettleRequest(a);const{relay:l,controller:o,expiry:f,namespaces:p}=i.params,m={topic:r,relay:l,expiry:f,namespaces:p,acknowledged:!0,controller:o.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:o.publicKey,metadata:o.metadata}};await this.sendResult(i.id,r,!0),this.events.emit($e("session_connect"),{session:m})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;Ht(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit($e("session_approve",n),{})):At(i)&&(await this.client.session.delete(r,ke("USER_DISCONNECTED")),this.events.emit($e("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:a}=i;try{this.isValidUpdate(Gt({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(a,r,!0),this.client.events.emit("session_update",{id:a,topic:r,params:n})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;Ht(i)?this.events.emit($e("session_update",n),{}):At(i)&&this.events.emit($e("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Bt(Ii)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;Ht(i)?this.events.emit($e("session_extend",n),{}):At(i)&&this.events.emit($e("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{Ht(i)?this.events.emit($e("session_ping",n),{}):At(i)&&this.events.emit($e("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await this.sendResult(n,r,!0),await this.deleteSession(r),this.client.events.emit("session_delete",{id:n,topic:r})}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:a}=i;try{this.isValidRequest(Gt({topic:r},a)),await this.setPendingSessionRequest({id:n,topic:r,params:a}),this.client.events.emit("session_request",{id:n,topic:r,params:a})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;Ht(i)?this.events.emit($e("session_request",n),{result:i.result}):At(i)&&this.events.emit($e("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:a}=i;try{this.isValidEmit(Gt({topic:r},a)),this.client.events.emit("session_event",{id:n,topic:r,params:a})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.isValidConnect=async r=>{if(!ft(r)){const{message:o}=ee("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(o)}const{pairingTopic:i,requiredNamespaces:n,relays:a}=r;vt(i)||await this.isValidPairingTopic(i);const l=$p(n,"connect()");if(l)throw new Error(l.message);if(!jp(a,!0)){const{message:o}=ee("MISSING_OR_INVALID",`connect() relays: ${a}`);throw new Error(o)}},this.isValidApprove=async r=>{if(!ft(r))throw new Error(ee("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:a}=r;await this.isValidProposalId(i);const l=this.client.proposal.get(i),o=On(n,"approve()");if(o)throw new Error(o.message);const f=ba(l.requiredNamespaces,n,"update()");if(f)throw new Error(f.message);if(!it(a,!0)){const{message:p}=ee("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(p)}},this.isValidReject=async r=>{if(!ft(r)){const{message:a}=ee("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(a)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!zp(n)){const{message:a}=ee("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(a)}},this.isValidSessionSettleRequest=r=>{if(!ft(r)){const{message:p}=ee("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(p)}const{relay:i,controller:n,namespaces:a,expiry:l}=r;if(!ya(i)){const{message:p}=ee("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const o=Lp(n,"onSessionSettleRequest()");if(o)throw new Error(o.message);const f=On(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);if(kt(l)){const{message:p}=ee("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async r=>{if(!ft(r)){const{message:f}=ee("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(f)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const a=this.client.session.get(i),l=On(n,"update()");if(l)throw new Error(l.message);const o=ba(a.requiredNamespaces,n,"update()");if(o)throw new Error(o.message)},this.isValidExtend=async r=>{if(!ft(r)){const{message:n}=ee("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!ft(r)){const{message:o}=ee("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(o)}const{topic:i,request:n,chainId:a}=r;await this.isValidSessionTopic(i);const{namespaces:l}=this.client.session.get(i);if(!wa(l,a)){const{message:o}=ee("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(o)}if(!qp(n)){const{message:o}=ee("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(o)}if(!kp(l,a,n.method)){const{message:o}=ee("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(o)}},this.isValidRespond=async r=>{if(!ft(r)){const{message:a}=ee("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(a)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!Kp(n)){const{message:a}=ee("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(a)}},this.isValidPing=async r=>{if(!ft(r)){const{message:n}=ee("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!ft(r)){const{message:o}=ee("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(o)}const{topic:i,event:n,chainId:a}=r;await this.isValidSessionTopic(i);const{namespaces:l}=this.client.session.get(i);if(!wa(l,a)){const{message:o}=ee("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(o)}if(!Vp(n)){const{message:o}=ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(o)}if(!Wp(l,a,n.name)){const{message:o}=ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(o)}},this.isValidDisconnect=async r=>{if(!ft(r)){const{message:n}=ee("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}}isInitialized(){if(!this.initialized){const{message:e}=ee("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(dt.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);Tn(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Pn(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(Dt.expired,async e=>{const{topic:r,id:i}=oa(e.target);if(i&&this.getPendingSessionRequests()[i])return await this.deletePendingSessionRequest(i,ee("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&await this.deleteProposal(i,!0)})}isValidPairingTopic(e){if(!it(e,!1)){const{message:r}=ee("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(kt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=ee("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!it(e,!1)){const{message:r}=ee("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=ee("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(kt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=ee("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(it(e,!1)){const{message:r}=ee("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=ee("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Hp(e)){const{message:r}=ee("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=ee("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(kt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=ee("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class Yy extends Si{constructor(e,r){super(e,r,$y,$n),this.core=e,this.logger=r}}class Jy extends Si{constructor(e,r){super(e,r,jy,$n),this.core=e,this.logger=r}}class Xy extends Si{constructor(e,r){super(e,r,zy,$n),this.core=e,this.logger=r}}class Gn extends jh{constructor(e){super(e),this.protocol=ac,this.version=cc,this.name=jn.name,this.events=new ot.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||jn.name,this.metadata=e?.metadata||hp();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Dr(Oe.getDefaultLoggerOptions({level:e?.logger||jn.logger}));this.core=e?.core||new By(e),this.logger=Oe.generateChildLogger(r,this.name),this.session=new Jy(this.core,this.logger),this.proposal=new Yy(this.core,this.logger),this.pendingRequest=new Xy(this.core,this.logger),this.engine=new Gy(this)}static async init(e){const r=new Gn(e);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initilization Success")}catch(e){throw this.logger.info("SignClient Initilization Failure"),this.logger.error(e.message),e}}}var Hn={exports:{}};(function(t,e){var r=typeof self<"u"?self:ut,i=function(){function a(){this.fetch=!1,this.DOMException=r.DOMException}return a.prototype=r,new a}();(function(a){(function(l){var o={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function f(w){return w&&DataView.prototype.isPrototypeOf(w)}if(o.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],m=ArrayBuffer.isView||function(w){return w&&p.indexOf(Object.prototype.toString.call(w))>-1};function C(w){if(typeof w!="string"&&(w=String(w)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(w))throw new TypeError("Invalid character in header field name");return w.toLowerCase()}function L(w){return typeof w!="string"&&(w=String(w)),w}function O(w){var D={next:function(){var K=w.shift();return{done:K===void 0,value:K}}};return o.iterable&&(D[Symbol.iterator]=function(){return D}),D}function I(w){this.map={},w instanceof I?w.forEach(function(D,K){this.append(K,D)},this):Array.isArray(w)?w.forEach(function(D){this.append(D[0],D[1])},this):w&&Object.getOwnPropertyNames(w).forEach(function(D){this.append(D,w[D])},this)}I.prototype.append=function(w,D){w=C(w),D=L(D);var K=this.map[w];this.map[w]=K?K+", "+D:D},I.prototype.delete=function(w){delete this.map[C(w)]},I.prototype.get=function(w){return w=C(w),this.has(w)?this.map[w]:null},I.prototype.has=function(w){return this.map.hasOwnProperty(C(w))},I.prototype.set=function(w,D){this.map[C(w)]=L(D)},I.prototype.forEach=function(w,D){for(var K in this.map)this.map.hasOwnProperty(K)&&w.call(D,this.map[K],K,this)},I.prototype.keys=function(){var w=[];return this.forEach(function(D,K){w.push(K)}),O(w)},I.prototype.values=function(){var w=[];return this.forEach(function(D){w.push(D)}),O(w)},I.prototype.entries=function(){var w=[];return this.forEach(function(D,K){w.push([K,D])}),O(w)},o.iterable&&(I.prototype[Symbol.iterator]=I.prototype.entries);function $(w){if(w.bodyUsed)return Promise.reject(new TypeError("Already read"));w.bodyUsed=!0}function B(w){return new Promise(function(D,K){w.onload=function(){D(w.result)},w.onerror=function(){K(w.error)}})}function W(w){var D=new FileReader,K=B(D);return D.readAsArrayBuffer(w),K}function A(w){var D=new FileReader,K=B(D);return D.readAsText(w),K}function R(w){for(var D=new Uint8Array(w),K=new Array(D.length),k=0;k<D.length;k++)K[k]=String.fromCharCode(D[k]);return K.join("")}function _(w){if(w.slice)return w.slice(0);var D=new Uint8Array(w.byteLength);return D.set(new Uint8Array(w)),D.buffer}function E(){return this.bodyUsed=!1,this._initBody=function(w){this._bodyInit=w,w?typeof w=="string"?this._bodyText=w:o.blob&&Blob.prototype.isPrototypeOf(w)?this._bodyBlob=w:o.formData&&FormData.prototype.isPrototypeOf(w)?this._bodyFormData=w:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)?this._bodyText=w.toString():o.arrayBuffer&&o.blob&&f(w)?(this._bodyArrayBuffer=_(w.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(w)||m(w))?this._bodyArrayBuffer=_(w):this._bodyText=w=Object.prototype.toString.call(w):this._bodyText="",this.headers.get("content-type")||(typeof w=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var w=$(this);if(w)return w;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?$(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(W)}),this.text=function(){var w=$(this);if(w)return w;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(R(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(q)}),this.json=function(){return this.text().then(JSON.parse)},this}var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(w){var D=w.toUpperCase();return v.indexOf(D)>-1?D:w}function y(w,D){D=D||{};var K=D.body;if(w instanceof y){if(w.bodyUsed)throw new TypeError("Already read");this.url=w.url,this.credentials=w.credentials,D.headers||(this.headers=new I(w.headers)),this.method=w.method,this.mode=w.mode,this.signal=w.signal,!K&&w._bodyInit!=null&&(K=w._bodyInit,w.bodyUsed=!0)}else this.url=String(w);if(this.credentials=D.credentials||this.credentials||"same-origin",(D.headers||!this.headers)&&(this.headers=new I(D.headers)),this.method=c(D.method||this.method||"GET"),this.mode=D.mode||this.mode||null,this.signal=D.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&K)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(K)}y.prototype.clone=function(){return new y(this,{body:this._bodyInit})};function q(w){var D=new FormData;return w.trim().split("&").forEach(function(K){if(K){var k=K.split("="),H=k.shift().replace(/\+/g," "),j=k.join("=").replace(/\+/g," ");D.append(decodeURIComponent(H),decodeURIComponent(j))}}),D}function Y(w){var D=new I,K=w.replace(/\r?\n[\t ]+/g," ");return K.split(/\r?\n/).forEach(function(k){var H=k.split(":"),j=H.shift().trim();if(j){var G=H.join(":").trim();D.append(j,G)}}),D}E.call(y.prototype);function Z(w,D){D||(D={}),this.type="default",this.status=D.status===void 0?200:D.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in D?D.statusText:"OK",this.headers=new I(D.headers),this.url=D.url||"",this._initBody(w)}E.call(Z.prototype),Z.prototype.clone=function(){return new Z(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new I(this.headers),url:this.url})},Z.error=function(){var w=new Z(null,{status:0,statusText:""});return w.type="error",w};var se=[301,302,303,307,308];Z.redirect=function(w,D){if(se.indexOf(D)===-1)throw new RangeError("Invalid status code");return new Z(null,{status:D,headers:{location:w}})},l.DOMException=a.DOMException;try{new l.DOMException}catch{l.DOMException=function(D,K){this.message=D,this.name=K;var k=Error(D);this.stack=k.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function ne(w,D){return new Promise(function(K,k){var H=new y(w,D);if(H.signal&&H.signal.aborted)return k(new l.DOMException("Aborted","AbortError"));var j=new XMLHttpRequest;function G(){j.abort()}j.onload=function(){var z={status:j.status,statusText:j.statusText,headers:Y(j.getAllResponseHeaders()||"")};z.url="responseURL"in j?j.responseURL:z.headers.get("X-Request-URL");var oe="response"in j?j.response:j.responseText;K(new Z(oe,z))},j.onerror=function(){k(new TypeError("Network request failed"))},j.ontimeout=function(){k(new TypeError("Network request failed"))},j.onabort=function(){k(new l.DOMException("Aborted","AbortError"))},j.open(H.method,H.url,!0),H.credentials==="include"?j.withCredentials=!0:H.credentials==="omit"&&(j.withCredentials=!1),"responseType"in j&&o.blob&&(j.responseType="blob"),H.headers.forEach(function(z,oe){j.setRequestHeader(oe,z)}),H.signal&&(H.signal.addEventListener("abort",G),j.onreadystatechange=function(){j.readyState===4&&H.signal.removeEventListener("abort",G)}),j.send(typeof H._bodyInit>"u"?null:H._bodyInit)})}return ne.polyfill=!0,a.fetch||(a.fetch=ne,a.Headers=I,a.Request=y,a.Response=Z),l.Headers=I,l.Request=y,l.Response=Z,l.fetch=ne,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var n=i;e=n.fetch,e.default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,t.exports=e})(Hn,Hn.exports);var dc=Du(Hn.exports);const Zy={Accept:"application/json","Content-Type":"application/json"},Qy="POST",pc={headers:Zy,method:Qy},gc=10;class yc{constructor(e){if(this.url=e,this.events=new ot.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Oa(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const i=Lr(e),a=await(await dc(this.url,Object.assign(Object.assign({},pc),{body:i}))).json();this.onPayload({data:a})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!Oa(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),n(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{const r=Lr({id:1,jsonrpc:"2.0",method:"test",params:[]});await dc(e,Object.assign(Object.assign({},pc),{body:r})),this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Yi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),a=Ei(e,n);this.events.emit("payload",a)}parseError(e,r=this.url){return va(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>gc&&this.events.setMaxListeners(gc)}}function e1(t){var e;const r=(e=t[Object.keys(t)[0]])==null?void 0:e.chains[0];return[r.split(":")[0],r.split(":")[1]]}function Oi(t,e){let r;return e.rpcMap&&(r=e.rpcMap[t1([t])]),r}function t1(t){return Number(t[0].split(":")[1])}class r1{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=this.getDefaultChainId()}async request(e){var r;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":{const i=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";return this.setDefaultChain(parseInt(i,16).toString()),null}case"eth_chainId":return this.getDefaultChainId()}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){if(this.chainId=parseInt(e),!this.httpProviders[e]){const i=r||Oi(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}createHttpProvider(e,r){const i=r||Oi(e,this.namespace);return typeof i>"u"?void 0:new Nn(new yc(i))}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return parseInt(e.split(":")[1])}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}}class i1{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||Oi(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Oi(e,this.namespace);return typeof i>"u"?void 0:new Nn(new yc(i))}}const wc="error",n1="wss://relay.walletconnect.com",s1="wc",o1="universal_provider",bc=`${s1}@${2}:${o1}:`;var a1=Object.defineProperty,c1=Object.defineProperties,u1=Object.getOwnPropertyDescriptors,mc=Object.getOwnPropertySymbols,h1=Object.prototype.hasOwnProperty,l1=Object.prototype.propertyIsEnumerable,_c=(t,e,r)=>e in t?a1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ec=(t,e)=>{for(var r in e||(e={}))h1.call(e,r)&&_c(t,r,e[r]);if(mc)for(var r of mc(e))l1.call(e,r)&&_c(t,r,e[r]);return t},f1=(t,e)=>c1(t,u1(e));class Yn{constructor(e){this.events=new ot.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Dr(Oe.getDefaultLoggerOptions({level:e?.logger||wc}))}static async init(e){const r=new Yn(e);return await r.initialize(),r}async request(e,r){var i;const[n,a]=this.validateChain(r);return await this.getProvider(n).request({request:Ec({},e),chainId:`${n}:${a}`,topic:(i=this.session)==null?void 0:i.topic})}sendAsync(e,r,i){this.request(e,i).then(n=>r(null,n)).catch(n=>r(n,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return await this.request({method:"eth_requestAccounts",params:[]})}async disconnect(){if(!this.client)throw new Error("Sign Client not initialized");await this.client.disconnect({topic:this.session.topic,reason:ke("USER_DISCONNECTED")})}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");return this.setNamespaces(e.namespaces),this.createProviders(),e.skipPairing===!0?void 0:await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces});return r&&(this.uri=r,this.events.emit("display_uri",r)),this.session=await i(),this.onSessionUpdate(),this.session}setDefaultChain(e,r){const[i,n]=this.validateChain(e);this.getProvider(i).setDefaultChain(n,r)}async checkStorage(){if(this.namespaces=await this.client.core.storage.getItem(`${bc}/namespaces`),this.namespaces&&this.createProviders(),this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.onSessionUpdate()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Gn.init({logger:this.providerOpts.logger||wc,relayUrl:this.providerOpts.relayUrl||n1,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{switch(e){case"eip155":this.rpcProviders[e]=new r1({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"solana":this.rpcProviders[e]=new i1({client:this.client,namespace:this.namespaces[e],events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var i;const{namespaces:n}=r,a=(i=this.client)==null?void 0:i.session.get(e);this.session=f1(Ec({},a),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",()=>{this.events.emit("session_delete")})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>this.getProvider(e).updateNamespace(this.session.namespaces[e]))}setNamespaces(e){if(!e||!Object.keys(e).length)throw new Error("Namespaces must be not empty");this.client.core.storage.setItem(`${bc}/namespaces`,e),this.namespaces=e}validateChain(e){const[r,i]=e?.split(":")||["",""];if(r&&!Object.keys(this.namespaces).includes(r))throw new Error(`Invalid namespace: ${r}`);return!r||!i?e1(this.namespaces):[r,i]}}const d1=Symbol(),vc=Object.getPrototypeOf,zn=new WeakMap,p1=t=>t&&(zn.has(t)?zn.get(t):vc(t)===Object.prototype||vc(t)===Array.prototype),g1=t=>p1(t)&&t[d1]||null,Dc=(t,e=!0)=>{zn.set(t,e)},qn=t=>typeof t=="object"&&t!==null,xt=Symbol(),Kn=new WeakSet,y1=(t=Object.is,e=(p,m)=>new Proxy(p,m),r=p=>qn(p)&&!Kn.has(p)&&(Array.isArray(p)||!(Symbol.iterator in p))&&!(p instanceof WeakMap)&&!(p instanceof WeakSet)&&!(p instanceof Error)&&!(p instanceof Number)&&!(p instanceof Date)&&!(p instanceof String)&&!(p instanceof RegExp)&&!(p instanceof ArrayBuffer),i=p=>{switch(p.status){case"fulfilled":return p.value;case"rejected":throw p.reason;default:throw p}},n=new WeakMap,a=(p,m,C,L=i)=>{const O=n.get(m);if(O?.[0]===C)return O[1];const I=Array.isArray(p)?[]:Object.create(Object.getPrototypeOf(p));return Dc(I,!0),n.set(m,[C,I]),Reflect.ownKeys(p).forEach($=>{const B=Reflect.get(p,$,m);Kn.has(B)?(Dc(B,!1),I[$]=B):B instanceof Promise?Object.defineProperty(I,$,{get(){return L(B)}}):B?.[xt]?I[$]=b1(B,L):I[$]=B}),Object.freeze(I)},l=new WeakMap,o=[1],f=p=>{if(!qn(p))throw new Error("object required");const m=l.get(p);if(m)return m;let C=o[0];const L=new Set,O=(_,E=++o[0])=>{C!==E&&(C=E,L.forEach(v=>v(_,E)))},I=new Map,$=_=>{let E=I.get(_);return E||(E=(v,c)=>{const y=[...v];y[1]=[_,...y[1]],O(y,c)},I.set(_,E)),E},B=_=>{const E=I.get(_);return I.delete(_),E},W=Array.isArray(p)?[]:Object.create(Object.getPrototypeOf(p)),R=e(W,{get(_,E,v){return E===xt?[_,v,C,a,L]:Reflect.get(_,E,v)},deleteProperty(_,E){var v;const c=Reflect.get(_,E),y=(v=c?.[xt])==null?void 0:v[4];y&&y.delete(B(E));const q=Reflect.deleteProperty(_,E);return q&&O(["delete",[E],c]),q},set(_,E,v,c){var y,q;const Y=Reflect.has(_,E),Z=Reflect.get(_,E,c);if(Y&&t(Z,v))return!0;const se=(y=Z?.[xt])==null?void 0:y[4];se&&se.delete(B(E)),qn(v)&&(v=g1(v)||v);let ne=v;return(q=Object.getOwnPropertyDescriptor(_,E))!=null&&q.set||(v instanceof Promise?v.then(w=>{v.status="fulfilled",v.value=w,O(["resolve",[E],w])}).catch(w=>{v.status="rejected",v.reason=w,O(["reject",[E],w])}):(!v?.[xt]&&r(v)&&(ne=Yt(v)),ne?.[xt]&&ne[xt][4].add($(E)))),Reflect.set(_,E,ne,c),O(["set",[E],v,Z]),!0}});return l.set(p,R),Reflect.ownKeys(p).forEach(_=>{const E=Object.getOwnPropertyDescriptor(p,_);E.get||E.set?Object.defineProperty(W,_,E):R[_]=p[_]}),R})=>[f,xt,Kn,t,e,r,i,n,a,l,o],[w1]=y1();function Yt(t={}){return w1(t)}function Wr(t,e,r){(import.meta.env&&import.meta.env.MODE)!=="production"&&!t?.[xt]&&console.warn("Please use proxy object");let i;const n=[],a=t[xt][4],l=o=>{if(n.push(o),r){e(n.splice(0));return}i||(i=Promise.resolve().then(()=>{i=void 0,a.has(l)&&e(n.splice(0))}))};return a.add(l),()=>a.delete(l)}function b1(t,e){(import.meta.env&&import.meta.env.MODE)!=="production"&&!t?.[xt]&&console.warn("Please use proxy object");const[r,i,n,a]=t[xt];return a(r,i,n,e)}var xc={},Ci={};Ci.byteLength=E1,Ci.toByteArray=D1,Ci.fromByteArray=I1;for(var Ut=[],St=[],m1=typeof Uint8Array<"u"?Uint8Array:Array,Vn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mr=0,_1=Vn.length;mr<_1;++mr)Ut[mr]=Vn[mr],St[Vn.charCodeAt(mr)]=mr;St["-".charCodeAt(0)]=62,St["_".charCodeAt(0)]=63;function Sc(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var i=r===e?0:4-r%4;return[r,i]}function E1(t){var e=Sc(t),r=e[0],i=e[1];return(r+i)*3/4-i}function v1(t,e,r){return(e+r)*3/4-r}function D1(t){var e,r=Sc(t),i=r[0],n=r[1],a=new m1(v1(t,i,n)),l=0,o=n>0?i-4:i,f;for(f=0;f<o;f+=4)e=St[t.charCodeAt(f)]<<18|St[t.charCodeAt(f+1)]<<12|St[t.charCodeAt(f+2)]<<6|St[t.charCodeAt(f+3)],a[l++]=e>>16&255,a[l++]=e>>8&255,a[l++]=e&255;return n===2&&(e=St[t.charCodeAt(f)]<<2|St[t.charCodeAt(f+1)]>>4,a[l++]=e&255),n===1&&(e=St[t.charCodeAt(f)]<<10|St[t.charCodeAt(f+1)]<<4|St[t.charCodeAt(f+2)]>>2,a[l++]=e>>8&255,a[l++]=e&255),a}function x1(t){return Ut[t>>18&63]+Ut[t>>12&63]+Ut[t>>6&63]+Ut[t&63]}function S1(t,e,r){for(var i,n=[],a=e;a<r;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),n.push(x1(i));return n.join("")}function I1(t){for(var e,r=t.length,i=r%3,n=[],a=16383,l=0,o=r-i;l<o;l+=a)n.push(S1(t,l,l+a>o?o:l+a));return i===1?(e=t[r-1],n.push(Ut[e>>2]+Ut[e<<4&63]+"==")):i===2&&(e=(t[r-2]<<8)+t[r-1],n.push(Ut[e>>10]+Ut[e>>4&63]+Ut[e<<2&63]+"=")),n.join("")}var kn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */kn.read=function(t,e,r,i,n){var a,l,o=n*8-i-1,f=(1<<o)-1,p=f>>1,m=-7,C=r?n-1:0,L=r?-1:1,O=t[e+C];for(C+=L,a=O&(1<<-m)-1,O>>=-m,m+=o;m>0;a=a*256+t[e+C],C+=L,m-=8);for(l=a&(1<<-m)-1,a>>=-m,m+=i;m>0;l=l*256+t[e+C],C+=L,m-=8);if(a===0)a=1-p;else{if(a===f)return l?NaN:(O?-1:1)*(1/0);l=l+Math.pow(2,i),a=a-p}return(O?-1:1)*l*Math.pow(2,a-i)},kn.write=function(t,e,r,i,n,a){var l,o,f,p=a*8-n-1,m=(1<<p)-1,C=m>>1,L=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=i?0:a-1,I=i?1:-1,$=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,l=m):(l=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-l))<1&&(l--,f*=2),l+C>=1?e+=L/f:e+=L*Math.pow(2,1-C),e*f>=2&&(l++,f/=2),l+C>=m?(o=0,l=m):l+C>=1?(o=(e*f-1)*Math.pow(2,n),l=l+C):(o=e*Math.pow(2,C-1)*Math.pow(2,n),l=0));n>=8;t[r+O]=o&255,O+=I,o/=256,n-=8);for(l=l<<n|o,p+=n;p>0;t[r+O]=l&255,O+=I,l/=256,p-=8);t[r+O-I]|=$*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=Ci,r=kn,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=A,t.INSPECT_MAX_BYTES=50;const n=2147483647;t.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=a(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const d=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(d,s),d.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.byteOffset}});function l(d){if(d>n)throw new RangeError('The value "'+d+'" is invalid for option "size"');const s=new Uint8Array(d);return Object.setPrototypeOf(s,o.prototype),s}function o(d,s,u){if(typeof d=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return C(d)}return f(d,s,u)}o.poolSize=8192;function f(d,s,u){if(typeof d=="string")return L(d,s);if(ArrayBuffer.isView(d))return I(d);if(d==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(he(d,ArrayBuffer)||d&&he(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(he(d,SharedArrayBuffer)||d&&he(d.buffer,SharedArrayBuffer)))return $(d,s,u);if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const g=d.valueOf&&d.valueOf();if(g!=null&&g!==d)return o.from(g,s,u);const S=B(d);if(S)return S;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof d[Symbol.toPrimitive]=="function")return o.from(d[Symbol.toPrimitive]("string"),s,u);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}o.from=function(d,s,u){return f(d,s,u)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function p(d){if(typeof d!="number")throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function m(d,s,u){return p(d),d<=0?l(d):s!==void 0?typeof u=="string"?l(d).fill(s,u):l(d).fill(s):l(d)}o.alloc=function(d,s,u){return m(d,s,u)};function C(d){return p(d),l(d<0?0:W(d)|0)}o.allocUnsafe=function(d){return C(d)},o.allocUnsafeSlow=function(d){return C(d)};function L(d,s){if((typeof s!="string"||s==="")&&(s="utf8"),!o.isEncoding(s))throw new TypeError("Unknown encoding: "+s);const u=R(d,s)|0;let g=l(u);const S=g.write(d,s);return S!==u&&(g=g.slice(0,S)),g}function O(d){const s=d.length<0?0:W(d.length)|0,u=l(s);for(let g=0;g<s;g+=1)u[g]=d[g]&255;return u}function I(d){if(he(d,Uint8Array)){const s=new Uint8Array(d);return $(s.buffer,s.byteOffset,s.byteLength)}return O(d)}function $(d,s,u){if(s<0||d.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<s+(u||0))throw new RangeError('"length" is outside of buffer bounds');let g;return s===void 0&&u===void 0?g=new Uint8Array(d):u===void 0?g=new Uint8Array(d,s):g=new Uint8Array(d,s,u),Object.setPrototypeOf(g,o.prototype),g}function B(d){if(o.isBuffer(d)){const s=W(d.length)|0,u=l(s);return u.length===0||d.copy(u,0,0,s),u}if(d.length!==void 0)return typeof d.length!="number"||ye(d.length)?l(0):O(d);if(d.type==="Buffer"&&Array.isArray(d.data))return O(d.data)}function W(d){if(d>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return d|0}function A(d){return+d!=d&&(d=0),o.alloc(+d)}o.isBuffer=function(s){return s!=null&&s._isBuffer===!0&&s!==o.prototype},o.compare=function(s,u){if(he(s,Uint8Array)&&(s=o.from(s,s.offset,s.byteLength)),he(u,Uint8Array)&&(u=o.from(u,u.offset,u.byteLength)),!o.isBuffer(s)||!o.isBuffer(u))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===u)return 0;let g=s.length,S=u.length;for(let N=0,M=Math.min(g,S);N<M;++N)if(s[N]!==u[N]){g=s[N],S=u[N];break}return g<S?-1:S<g?1:0},o.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(s,u){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(s.length===0)return o.alloc(0);let g;if(u===void 0)for(u=0,g=0;g<s.length;++g)u+=s[g].length;const S=o.allocUnsafe(u);let N=0;for(g=0;g<s.length;++g){let M=s[g];if(he(M,Uint8Array))N+M.length>S.length?(o.isBuffer(M)||(M=o.from(M)),M.copy(S,N)):Uint8Array.prototype.set.call(S,M,N);else if(o.isBuffer(M))M.copy(S,N);else throw new TypeError('"list" argument must be an Array of Buffers');N+=M.length}return S};function R(d,s){if(o.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||he(d,ArrayBuffer))return d.byteLength;if(typeof d!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);const u=d.length,g=arguments.length>2&&arguments[2]===!0;if(!g&&u===0)return 0;let S=!1;for(;;)switch(s){case"ascii":case"latin1":case"binary":return u;case"utf8":case"utf-8":return Se(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u*2;case"hex":return u>>>1;case"base64":return Ee(d).length;default:if(S)return g?-1:Se(d).length;s=(""+s).toLowerCase(),S=!0}}o.byteLength=R;function _(d,s,u){let g=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((u===void 0||u>this.length)&&(u=this.length),u<=0)||(u>>>=0,s>>>=0,u<=s))return"";for(d||(d="utf8");;)switch(d){case"hex":return j(this,s,u);case"utf8":case"utf-8":return w(this,s,u);case"ascii":return k(this,s,u);case"latin1":case"binary":return H(this,s,u);case"base64":return ne(this,s,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,s,u);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),g=!0}}o.prototype._isBuffer=!0;function E(d,s,u){const g=d[s];d[s]=d[u],d[u]=g}o.prototype.swap16=function(){const s=this.length;if(s%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let u=0;u<s;u+=2)E(this,u,u+1);return this},o.prototype.swap32=function(){const s=this.length;if(s%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let u=0;u<s;u+=4)E(this,u,u+3),E(this,u+1,u+2);return this},o.prototype.swap64=function(){const s=this.length;if(s%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let u=0;u<s;u+=8)E(this,u,u+7),E(this,u+1,u+6),E(this,u+2,u+5),E(this,u+3,u+4);return this},o.prototype.toString=function(){const s=this.length;return s===0?"":arguments.length===0?w(this,0,s):_.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(s){if(!o.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s?!0:o.compare(this,s)===0},o.prototype.inspect=function(){let s="";const u=t.INSPECT_MAX_BYTES;return s=this.toString("hex",0,u).replace(/(.{2})/g,"$1 ").trim(),this.length>u&&(s+=" ... "),"<Buffer "+s+">"},i&&(o.prototype[i]=o.prototype.inspect),o.prototype.compare=function(s,u,g,S,N){if(he(s,Uint8Array)&&(s=o.from(s,s.offset,s.byteLength)),!o.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(u===void 0&&(u=0),g===void 0&&(g=s?s.length:0),S===void 0&&(S=0),N===void 0&&(N=this.length),u<0||g>s.length||S<0||N>this.length)throw new RangeError("out of range index");if(S>=N&&u>=g)return 0;if(S>=N)return-1;if(u>=g)return 1;if(u>>>=0,g>>>=0,S>>>=0,N>>>=0,this===s)return 0;let M=N-S,te=g-u;const ae=Math.min(M,te),ve=this.slice(S,N),Ie=s.slice(u,g);for(let De=0;De<ae;++De)if(ve[De]!==Ie[De]){M=ve[De],te=Ie[De];break}return M<te?-1:te<M?1:0};function v(d,s,u,g,S){if(d.length===0)return-1;if(typeof u=="string"?(g=u,u=0):u>2147483647?u=2147483647:u<-2147483648&&(u=-2147483648),u=+u,ye(u)&&(u=S?0:d.length-1),u<0&&(u=d.length+u),u>=d.length){if(S)return-1;u=d.length-1}else if(u<0)if(S)u=0;else return-1;if(typeof s=="string"&&(s=o.from(s,g)),o.isBuffer(s))return s.length===0?-1:c(d,s,u,g,S);if(typeof s=="number")return s=s&255,typeof Uint8Array.prototype.indexOf=="function"?S?Uint8Array.prototype.indexOf.call(d,s,u):Uint8Array.prototype.lastIndexOf.call(d,s,u):c(d,[s],u,g,S);throw new TypeError("val must be string, number or Buffer")}function c(d,s,u,g,S){let N=1,M=d.length,te=s.length;if(g!==void 0&&(g=String(g).toLowerCase(),g==="ucs2"||g==="ucs-2"||g==="utf16le"||g==="utf-16le")){if(d.length<2||s.length<2)return-1;N=2,M/=2,te/=2,u/=2}function ae(Ie,De){return N===1?Ie[De]:Ie.readUInt16BE(De*N)}let ve;if(S){let Ie=-1;for(ve=u;ve<M;ve++)if(ae(d,ve)===ae(s,Ie===-1?0:ve-Ie)){if(Ie===-1&&(Ie=ve),ve-Ie+1===te)return Ie*N}else Ie!==-1&&(ve-=ve-Ie),Ie=-1}else for(u+te>M&&(u=M-te),ve=u;ve>=0;ve--){let Ie=!0;for(let De=0;De<te;De++)if(ae(d,ve+De)!==ae(s,De)){Ie=!1;break}if(Ie)return ve}return-1}o.prototype.includes=function(s,u,g){return this.indexOf(s,u,g)!==-1},o.prototype.indexOf=function(s,u,g){return v(this,s,u,g,!0)},o.prototype.lastIndexOf=function(s,u,g){return v(this,s,u,g,!1)};function y(d,s,u,g){u=Number(u)||0;const S=d.length-u;g?(g=Number(g),g>S&&(g=S)):g=S;const N=s.length;g>N/2&&(g=N/2);let M;for(M=0;M<g;++M){const te=parseInt(s.substr(M*2,2),16);if(ye(te))return M;d[u+M]=te}return M}function q(d,s,u,g){return be(Se(s,d.length-u),d,u,g)}function Y(d,s,u,g){return be(Fe(s),d,u,g)}function Z(d,s,u,g){return be(Ee(s),d,u,g)}function se(d,s,u,g){return be(Ne(s,d.length-u),d,u,g)}o.prototype.write=function(s,u,g,S){if(u===void 0)S="utf8",g=this.length,u=0;else if(g===void 0&&typeof u=="string")S=u,g=this.length,u=0;else if(isFinite(u))u=u>>>0,isFinite(g)?(g=g>>>0,S===void 0&&(S="utf8")):(S=g,g=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const N=this.length-u;if((g===void 0||g>N)&&(g=N),s.length>0&&(g<0||u<0)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");S||(S="utf8");let M=!1;for(;;)switch(S){case"hex":return y(this,s,u,g);case"utf8":case"utf-8":return q(this,s,u,g);case"ascii":case"latin1":case"binary":return Y(this,s,u,g);case"base64":return Z(this,s,u,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se(this,s,u,g);default:if(M)throw new TypeError("Unknown encoding: "+S);S=(""+S).toLowerCase(),M=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ne(d,s,u){return s===0&&u===d.length?e.fromByteArray(d):e.fromByteArray(d.slice(s,u))}function w(d,s,u){u=Math.min(d.length,u);const g=[];let S=s;for(;S<u;){const N=d[S];let M=null,te=N>239?4:N>223?3:N>191?2:1;if(S+te<=u){let ae,ve,Ie,De;switch(te){case 1:N<128&&(M=N);break;case 2:ae=d[S+1],(ae&192)===128&&(De=(N&31)<<6|ae&63,De>127&&(M=De));break;case 3:ae=d[S+1],ve=d[S+2],(ae&192)===128&&(ve&192)===128&&(De=(N&15)<<12|(ae&63)<<6|ve&63,De>2047&&(De<55296||De>57343)&&(M=De));break;case 4:ae=d[S+1],ve=d[S+2],Ie=d[S+3],(ae&192)===128&&(ve&192)===128&&(Ie&192)===128&&(De=(N&15)<<18|(ae&63)<<12|(ve&63)<<6|Ie&63,De>65535&&De<1114112&&(M=De))}}M===null?(M=65533,te=1):M>65535&&(M-=65536,g.push(M>>>10&1023|55296),M=56320|M&1023),g.push(M),S+=te}return K(g)}const D=4096;function K(d){const s=d.length;if(s<=D)return String.fromCharCode.apply(String,d);let u="",g=0;for(;g<s;)u+=String.fromCharCode.apply(String,d.slice(g,g+=D));return u}function k(d,s,u){let g="";u=Math.min(d.length,u);for(let S=s;S<u;++S)g+=String.fromCharCode(d[S]&127);return g}function H(d,s,u){let g="";u=Math.min(d.length,u);for(let S=s;S<u;++S)g+=String.fromCharCode(d[S]);return g}function j(d,s,u){const g=d.length;(!s||s<0)&&(s=0),(!u||u<0||u>g)&&(u=g);let S="";for(let N=s;N<u;++N)S+=me[d[N]];return S}function G(d,s,u){const g=d.slice(s,u);let S="";for(let N=0;N<g.length-1;N+=2)S+=String.fromCharCode(g[N]+g[N+1]*256);return S}o.prototype.slice=function(s,u){const g=this.length;s=~~s,u=u===void 0?g:~~u,s<0?(s+=g,s<0&&(s=0)):s>g&&(s=g),u<0?(u+=g,u<0&&(u=0)):u>g&&(u=g),u<s&&(u=s);const S=this.subarray(s,u);return Object.setPrototypeOf(S,o.prototype),S};function z(d,s,u){if(d%1!==0||d<0)throw new RangeError("offset is not uint");if(d+s>u)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(s,u,g){s=s>>>0,u=u>>>0,g||z(s,u,this.length);let S=this[s],N=1,M=0;for(;++M<u&&(N*=256);)S+=this[s+M]*N;return S},o.prototype.readUintBE=o.prototype.readUIntBE=function(s,u,g){s=s>>>0,u=u>>>0,g||z(s,u,this.length);let S=this[s+--u],N=1;for(;u>0&&(N*=256);)S+=this[s+--u]*N;return S},o.prototype.readUint8=o.prototype.readUInt8=function(s,u){return s=s>>>0,u||z(s,1,this.length),this[s]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(s,u){return s=s>>>0,u||z(s,2,this.length),this[s]|this[s+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(s,u){return s=s>>>0,u||z(s,2,this.length),this[s]<<8|this[s+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(s,u){return s=s>>>0,u||z(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+this[s+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(s,u){return s=s>>>0,u||z(s,4,this.length),this[s]*16777216+(this[s+1]<<16|this[s+2]<<8|this[s+3])},o.prototype.readBigUInt64LE=ue(function(s){s=s>>>0,Q(s,"offset");const u=this[s],g=this[s+7];(u===void 0||g===void 0)&&fe(s,this.length-8);const S=u+this[++s]*2**8+this[++s]*2**16+this[++s]*2**24,N=this[++s]+this[++s]*2**8+this[++s]*2**16+g*2**24;return BigInt(S)+(BigInt(N)<<BigInt(32))}),o.prototype.readBigUInt64BE=ue(function(s){s=s>>>0,Q(s,"offset");const u=this[s],g=this[s+7];(u===void 0||g===void 0)&&fe(s,this.length-8);const S=u*2**24+this[++s]*2**16+this[++s]*2**8+this[++s],N=this[++s]*2**24+this[++s]*2**16+this[++s]*2**8+g;return(BigInt(S)<<BigInt(32))+BigInt(N)}),o.prototype.readIntLE=function(s,u,g){s=s>>>0,u=u>>>0,g||z(s,u,this.length);let S=this[s],N=1,M=0;for(;++M<u&&(N*=256);)S+=this[s+M]*N;return N*=128,S>=N&&(S-=Math.pow(2,8*u)),S},o.prototype.readIntBE=function(s,u,g){s=s>>>0,u=u>>>0,g||z(s,u,this.length);let S=u,N=1,M=this[s+--S];for(;S>0&&(N*=256);)M+=this[s+--S]*N;return N*=128,M>=N&&(M-=Math.pow(2,8*u)),M},o.prototype.readInt8=function(s,u){return s=s>>>0,u||z(s,1,this.length),this[s]&128?(255-this[s]+1)*-1:this[s]},o.prototype.readInt16LE=function(s,u){s=s>>>0,u||z(s,2,this.length);const g=this[s]|this[s+1]<<8;return g&32768?g|4294901760:g},o.prototype.readInt16BE=function(s,u){s=s>>>0,u||z(s,2,this.length);const g=this[s+1]|this[s]<<8;return g&32768?g|4294901760:g},o.prototype.readInt32LE=function(s,u){return s=s>>>0,u||z(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},o.prototype.readInt32BE=function(s,u){return s=s>>>0,u||z(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},o.prototype.readBigInt64LE=ue(function(s){s=s>>>0,Q(s,"offset");const u=this[s],g=this[s+7];(u===void 0||g===void 0)&&fe(s,this.length-8);const S=this[s+4]+this[s+5]*2**8+this[s+6]*2**16+(g<<24);return(BigInt(S)<<BigInt(32))+BigInt(u+this[++s]*2**8+this[++s]*2**16+this[++s]*2**24)}),o.prototype.readBigInt64BE=ue(function(s){s=s>>>0,Q(s,"offset");const u=this[s],g=this[s+7];(u===void 0||g===void 0)&&fe(s,this.length-8);const S=(u<<24)+this[++s]*2**16+this[++s]*2**8+this[++s];return(BigInt(S)<<BigInt(32))+BigInt(this[++s]*2**24+this[++s]*2**16+this[++s]*2**8+g)}),o.prototype.readFloatLE=function(s,u){return s=s>>>0,u||z(s,4,this.length),r.read(this,s,!0,23,4)},o.prototype.readFloatBE=function(s,u){return s=s>>>0,u||z(s,4,this.length),r.read(this,s,!1,23,4)},o.prototype.readDoubleLE=function(s,u){return s=s>>>0,u||z(s,8,this.length),r.read(this,s,!0,52,8)},o.prototype.readDoubleBE=function(s,u){return s=s>>>0,u||z(s,8,this.length),r.read(this,s,!1,52,8)};function oe(d,s,u,g,S,N){if(!o.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>S||s<N)throw new RangeError('"value" argument is out of bounds');if(u+g>d.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(s,u,g,S){if(s=+s,u=u>>>0,g=g>>>0,!S){const te=Math.pow(2,8*g)-1;oe(this,s,u,g,te,0)}let N=1,M=0;for(this[u]=s&255;++M<g&&(N*=256);)this[u+M]=s/N&255;return u+g},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(s,u,g,S){if(s=+s,u=u>>>0,g=g>>>0,!S){const te=Math.pow(2,8*g)-1;oe(this,s,u,g,te,0)}let N=g-1,M=1;for(this[u+N]=s&255;--N>=0&&(M*=256);)this[u+N]=s/M&255;return u+g},o.prototype.writeUint8=o.prototype.writeUInt8=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,1,255,0),this[u]=s&255,u+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,2,65535,0),this[u]=s&255,this[u+1]=s>>>8,u+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,2,65535,0),this[u]=s>>>8,this[u+1]=s&255,u+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,4,4294967295,0),this[u+3]=s>>>24,this[u+2]=s>>>16,this[u+1]=s>>>8,this[u]=s&255,u+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,4,4294967295,0),this[u]=s>>>24,this[u+1]=s>>>16,this[u+2]=s>>>8,this[u+3]=s&255,u+4};function J(d,s,u,g,S){X(s,g,S,d,u,7);let N=Number(s&BigInt(4294967295));d[u++]=N,N=N>>8,d[u++]=N,N=N>>8,d[u++]=N,N=N>>8,d[u++]=N;let M=Number(s>>BigInt(32)&BigInt(4294967295));return d[u++]=M,M=M>>8,d[u++]=M,M=M>>8,d[u++]=M,M=M>>8,d[u++]=M,u}function ce(d,s,u,g,S){X(s,g,S,d,u,7);let N=Number(s&BigInt(4294967295));d[u+7]=N,N=N>>8,d[u+6]=N,N=N>>8,d[u+5]=N,N=N>>8,d[u+4]=N;let M=Number(s>>BigInt(32)&BigInt(4294967295));return d[u+3]=M,M=M>>8,d[u+2]=M,M=M>>8,d[u+1]=M,M=M>>8,d[u]=M,u+8}o.prototype.writeBigUInt64LE=ue(function(s,u=0){return J(this,s,u,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=ue(function(s,u=0){return ce(this,s,u,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(s,u,g,S){if(s=+s,u=u>>>0,!S){const ae=Math.pow(2,8*g-1);oe(this,s,u,g,ae-1,-ae)}let N=0,M=1,te=0;for(this[u]=s&255;++N<g&&(M*=256);)s<0&&te===0&&this[u+N-1]!==0&&(te=1),this[u+N]=(s/M>>0)-te&255;return u+g},o.prototype.writeIntBE=function(s,u,g,S){if(s=+s,u=u>>>0,!S){const ae=Math.pow(2,8*g-1);oe(this,s,u,g,ae-1,-ae)}let N=g-1,M=1,te=0;for(this[u+N]=s&255;--N>=0&&(M*=256);)s<0&&te===0&&this[u+N+1]!==0&&(te=1),this[u+N]=(s/M>>0)-te&255;return u+g},o.prototype.writeInt8=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,1,127,-128),s<0&&(s=255+s+1),this[u]=s&255,u+1},o.prototype.writeInt16LE=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,2,32767,-32768),this[u]=s&255,this[u+1]=s>>>8,u+2},o.prototype.writeInt16BE=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,2,32767,-32768),this[u]=s>>>8,this[u+1]=s&255,u+2},o.prototype.writeInt32LE=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,4,2147483647,-2147483648),this[u]=s&255,this[u+1]=s>>>8,this[u+2]=s>>>16,this[u+3]=s>>>24,u+4},o.prototype.writeInt32BE=function(s,u,g){return s=+s,u=u>>>0,g||oe(this,s,u,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[u]=s>>>24,this[u+1]=s>>>16,this[u+2]=s>>>8,this[u+3]=s&255,u+4},o.prototype.writeBigInt64LE=ue(function(s,u=0){return J(this,s,u,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=ue(function(s,u=0){return ce(this,s,u,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function re(d,s,u,g,S,N){if(u+g>d.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("Index out of range")}function ge(d,s,u,g,S){return s=+s,u=u>>>0,S||re(d,s,u,4),r.write(d,s,u,g,23,4),u+4}o.prototype.writeFloatLE=function(s,u,g){return ge(this,s,u,!0,g)},o.prototype.writeFloatBE=function(s,u,g){return ge(this,s,u,!1,g)};function U(d,s,u,g,S){return s=+s,u=u>>>0,S||re(d,s,u,8),r.write(d,s,u,g,52,8),u+8}o.prototype.writeDoubleLE=function(s,u,g){return U(this,s,u,!0,g)},o.prototype.writeDoubleBE=function(s,u,g){return U(this,s,u,!1,g)},o.prototype.copy=function(s,u,g,S){if(!o.isBuffer(s))throw new TypeError("argument should be a Buffer");if(g||(g=0),!S&&S!==0&&(S=this.length),u>=s.length&&(u=s.length),u||(u=0),S>0&&S<g&&(S=g),S===g||s.length===0||this.length===0)return 0;if(u<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("sourceEnd out of bounds");S>this.length&&(S=this.length),s.length-u<S-g&&(S=s.length-u+g);const N=S-g;return this===s&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(u,g,S):Uint8Array.prototype.set.call(s,this.subarray(g,S),u),N},o.prototype.fill=function(s,u,g,S){if(typeof s=="string"){if(typeof u=="string"?(S=u,u=0,g=this.length):typeof g=="string"&&(S=g,g=this.length),S!==void 0&&typeof S!="string")throw new TypeError("encoding must be a string");if(typeof S=="string"&&!o.isEncoding(S))throw new TypeError("Unknown encoding: "+S);if(s.length===1){const M=s.charCodeAt(0);(S==="utf8"&&M<128||S==="latin1")&&(s=M)}}else typeof s=="number"?s=s&255:typeof s=="boolean"&&(s=Number(s));if(u<0||this.length<u||this.length<g)throw new RangeError("Out of range index");if(g<=u)return this;u=u>>>0,g=g===void 0?this.length:g>>>0,s||(s=0);let N;if(typeof s=="number")for(N=u;N<g;++N)this[N]=s;else{const M=o.isBuffer(s)?s:o.from(s,S),te=M.length;if(te===0)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(N=0;N<g-u;++N)this[N+u]=M[N%te]}return this};const F={};function T(d,s,u){F[d]=class extends u{constructor(){super(),Object.defineProperty(this,"message",{value:s.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${d}]`,this.stack,delete this.name}get code(){return d}set code(S){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:S,writable:!0})}toString(){return`${this.name} [${d}]: ${this.message}`}}}T("ERR_BUFFER_OUT_OF_BOUNDS",function(d){return d?`${d} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),T("ERR_INVALID_ARG_TYPE",function(d,s){return`The "${d}" argument must be of type number. Received type ${typeof s}`},TypeError),T("ERR_OUT_OF_RANGE",function(d,s,u){let g=`The value of "${d}" is out of range.`,S=u;return Number.isInteger(u)&&Math.abs(u)>2**32?S=h(String(u)):typeof u=="bigint"&&(S=String(u),(u>BigInt(2)**BigInt(32)||u<-(BigInt(2)**BigInt(32)))&&(S=h(S)),S+="n"),g+=` It must be ${s}. Received ${S}`,g},RangeError);function h(d){let s="",u=d.length;const g=d[0]==="-"?1:0;for(;u>=g+4;u-=3)s=`_${d.slice(u-3,u)}${s}`;return`${d.slice(0,u)}${s}`}function x(d,s,u){Q(s,"offset"),(d[s]===void 0||d[s+u]===void 0)&&fe(s,d.length-(u+1))}function X(d,s,u,g,S,N){if(d>u||d<s){const M=typeof s=="bigint"?"n":"";let te;throw N>3?s===0||s===BigInt(0)?te=`>= 0${M} and < 2${M} ** ${(N+1)*8}${M}`:te=`>= -(2${M} ** ${(N+1)*8-1}${M}) and < 2 ** ${(N+1)*8-1}${M}`:te=`>= ${s}${M} and <= ${u}${M}`,new F.ERR_OUT_OF_RANGE("value",te,d)}x(g,S,N)}function Q(d,s){if(typeof d!="number")throw new F.ERR_INVALID_ARG_TYPE(s,"number",d)}function fe(d,s,u){throw Math.floor(d)!==d?(Q(d,u),new F.ERR_OUT_OF_RANGE(u||"offset","an integer",d)):s<0?new F.ERR_BUFFER_OUT_OF_BOUNDS:new F.ERR_OUT_OF_RANGE(u||"offset",`>= ${u?1:0} and <= ${s}`,d)}const xe=/[^+/0-9A-Za-z-_]/g;function _e(d){if(d=d.split("=")[0],d=d.trim().replace(xe,""),d.length<2)return"";for(;d.length%4!==0;)d=d+"=";return d}function Se(d,s){s=s||1/0;let u;const g=d.length;let S=null;const N=[];for(let M=0;M<g;++M){if(u=d.charCodeAt(M),u>55295&&u<57344){if(!S){if(u>56319){(s-=3)>-1&&N.push(239,191,189);continue}else if(M+1===g){(s-=3)>-1&&N.push(239,191,189);continue}S=u;continue}if(u<56320){(s-=3)>-1&&N.push(239,191,189),S=u;continue}u=(S-55296<<10|u-56320)+65536}else S&&(s-=3)>-1&&N.push(239,191,189);if(S=null,u<128){if((s-=1)<0)break;N.push(u)}else if(u<2048){if((s-=2)<0)break;N.push(u>>6|192,u&63|128)}else if(u<65536){if((s-=3)<0)break;N.push(u>>12|224,u>>6&63|128,u&63|128)}else if(u<1114112){if((s-=4)<0)break;N.push(u>>18|240,u>>12&63|128,u>>6&63|128,u&63|128)}else throw new Error("Invalid code point")}return N}function Fe(d){const s=[];for(let u=0;u<d.length;++u)s.push(d.charCodeAt(u)&255);return s}function Ne(d,s){let u,g,S;const N=[];for(let M=0;M<d.length&&!((s-=2)<0);++M)u=d.charCodeAt(M),g=u>>8,S=u%256,N.push(S),N.push(g);return N}function Ee(d){return e.toByteArray(_e(d))}function be(d,s,u,g){let S;for(S=0;S<g&&!(S+u>=s.length||S>=d.length);++S)s[S+u]=d[S];return S}function he(d,s){return d instanceof s||d!=null&&d.constructor!=null&&d.constructor.name!=null&&d.constructor.name===s.name}function ye(d){return d!==d}const me=function(){const d="0123456789abcdef",s=new Array(256);for(let u=0;u<16;++u){const g=u*16;for(let S=0;S<16;++S)s[g+S]=d[u]+d[S]}return s}();function ue(d){return typeof BigInt>"u"?de:d}function de(){throw new Error("BigInt not supported")}})(xc);const Ae=Yt({selectedChain:void 0,chains:void 0,standaloneChains:void 0,standaloneUri:void 0,address:void 0,profileName:void 0,profileAvatar:void 0,profileLoading:!1,balanceLoading:!1,balance:void 0,isConnected:!1,isStandalone:!1,isCustomDesktop:!1,isCustomMobile:!1,isExplorer:!1}),wt={state:Ae,subscribe(t){return Wr(Ae,()=>t(Ae))},setChains(t){Ae.chains=t},setStandaloneChains(t){Ae.standaloneChains=t},setStandaloneUri(t){Ae.standaloneUri=t},getSelectedChain(){if(!Ae.selectedChain){const t=Ai.client().getNetwork().chain;Ae.selectedChain=t}return Ae.selectedChain},setSelectedChain(t){Ae.selectedChain=t},setIsStandalone(t){Ae.isStandalone=t},setIsCustomDesktop(t){Ae.isCustomDesktop=t},setIsCustomMobile(t){Ae.isCustomMobile=t},setIsExplorer(t){Ae.isExplorer=t},getAccount(){const t=Ai.client().getAccount();Ae.address=t.address,Ae.isConnected=t.isConnected},setAddress(t){Ae.address=t},setIsConnected(t){Ae.isConnected=t},setProfileName(t){Ae.profileName=t},setProfileAvatar(t){Ae.profileAvatar=t},setProfileLoading(t){Ae.profileLoading=t},setBalanceLoading(t){Ae.balanceLoading=t},setBalance(t){Ae.balance=t},resetProfile(){Ae.profileName=void 0,Ae.profileAvatar=void 0,Ae.balance=void 0},resetAccount(){Ae.address=void 0,wt.resetProfile()}},Gr=Yt({initialized:!1,ethereumClient:void 0}),Ai={setEthereumClient(t){!Gr.initialized&&t&&(Gr.ethereumClient=t,wt.setChains(t.chains),Gr.initialized=!0)},client(){if(Gr.ethereumClient)return Gr.ethereumClient;throw new Error("ClientCtrl has no client set")}},Jt={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",isMobile(){return typeof window<"u"?Boolean(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},isAndroid(){return Jt.isMobile()&&navigator.userAgent.toLowerCase().includes("android")},isEmptyObject(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.getOwnPropertyNames(t).length===0&&Object.getOwnPropertySymbols(t).length===0},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,r){if(Jt.isHttpUrl(t))return this.formatUniversalUrl(t,e,r);let i=t;i.includes("://")||(i=t.replaceAll("/","").replaceAll(":",""),i=`${i}://`),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(e);return`${i}wc?uri=${n}`},formatUniversalUrl(t,e,r){if(!Jt.isHttpUrl(t))return this.formatNativeUrl(t,e,r);let i=t;t.endsWith("/")&&(i=t.slice(0,-1)),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(e);return`${i}/wc?uri=${n}`},async wait(t){return new Promise(e=>{setTimeout(e,t)})},openHref(t,e="_self"){window.open(t,e,"noreferrer noopener")},setWalletConnectDeepLink(t,e){localStorage.setItem(Jt.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))},setWalletConnectAndroidDeepLink(t){const[e]=t.split("?");localStorage.setItem(Jt.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:"Android"}))},removeWalletConnectDeepLink(){localStorage.removeItem(Jt.WALLETCONNECT_DEEPLINK_CHOICE)},isNull(t){return t===null}};function O1(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}const Yr=Yt({projectId:void 0,themeMode:O1()?"dark":"light",themeColor:"default",themeBackground:Jt.isMobile()?"themeColor":"gradient",themeZIndex:89,mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chainImages:void 0,tokenImages:void 0,standaloneChains:void 0,enableStandaloneMode:!1,enableNetworkView:!1,defaultChain:void 0,explorerAllowList:void 0,explorerDenyList:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),Ti={state:Yr,subscribe(t){return Wr(Yr,()=>t(Yr))},setConfig(t){var e,r,i,n;if(wt.setStandaloneChains(t.standaloneChains),wt.setIsStandalone(Boolean((e=t.standaloneChains)==null?void 0:e.length)||Boolean(t.enableStandaloneMode)),wt.setIsCustomMobile(Boolean((r=t.mobileWallets)==null?void 0:r.length)),wt.setIsCustomDesktop(Boolean((i=t.desktopWallets)==null?void 0:i.length)),wt.setIsExplorer(Boolean((n=t.projectId)==null?void 0:n.length)),t.defaultChain)wt.setSelectedChain(t.defaultChain);else if(!wt.state.isStandalone){const a=Ai.client().getDefaultChain();wt.setSelectedChain(a)}Object.assign(Yr,t)},setThemeConfig(t){Object.assign(Yr,t)}},Ic="https://explorer-api.walletconnect.com";function C1(t){const e=Object.fromEntries(Object.entries(t).filter(([r,i])=>typeof i<"u"&&i!==null&&i!=="").map(([r,i])=>[r,i.toString()]));return new URLSearchParams(e).toString()}const Pi={async fetchWallets(t,e){const r=C1(e),i=`${Ic}/v3/wallets?projectId=${t}&${r}`;return(await fetch(i)).json()},formatImageUrl(t,e){return`${Ic}/v3/logo/lg/${e}?projectId=${t}`}},ur=Yt({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},previewWallets:[],recomendedWallets:[]});function Ni(){const{projectId:t}=Ti.state;if(!t)throw new Error("projectId is required to work with explorer api");return t}const A1={state:ur,async getPreviewWallets(t){const{listings:e}=await Pi.fetchWallets(Ni(),t);return ur.previewWallets=Object.values(e),ur.previewWallets},async getRecomendedWallets(){const{listings:t}=await Pi.fetchWallets(Ni(),{page:1,entries:6});ur.recomendedWallets=Object.values(t)},async getPaginatedWallets(t){const{page:e,search:r}=t,{listings:i,total:n}=await Pi.fetchWallets(Ni(),t),a=Object.values(i),l=r?"search":"wallets";return ur[l]={listings:[...ur[l].listings,...a],total:n,page:e??1},{listings:a,total:n}},getImageUrl(t){return Pi.formatImageUrl(Ni(),t)},resetSearch(){ur.search={listings:[],total:0,page:1}}},bt=Yt({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),Oc={state:bt,subscribe(t){return Wr(bt,()=>t(bt))},push(t,e){t!==bt.view&&(bt.view=t,e&&(bt.data=e),bt.history.push(t))},replace(t){bt.view=t,bt.history=[t]},goBack(){if(bt.history.length>1){bt.history.pop();const[t]=bt.history.slice(-1);bt.view=t}}},Jr=Yt({open:!1}),Ri={state:Jr,subscribe(t){return Wr(Jr,()=>t(Jr))},open(t){var e;t!=null&&t.route&&Oc.replace(t.route),t!=null&&t.uri&&wt.setStandaloneUri(t.uri),(e=t?.standaloneChains)!=null&&e.length&&wt.setStandaloneChains(t.standaloneChains),Jr.open=!0},close(){Jr.open=!1}},hr=Yt({open:!1,message:"",variant:"success"}),T1={state:hr,subscribe(t){return Wr(hr,()=>t(hr))},openToast(t,e){hr.open=!0,hr.message=t,hr.variant=e},closeToast(){hr.open=!1}};typeof window<"u"&&(window.Buffer||(window.Buffer=xc.Buffer),window.global||(window.global=window),window.process||(window.process={env:{}}));var P1=Object.defineProperty,Cc=Object.getOwnPropertySymbols,N1=Object.prototype.hasOwnProperty,R1=Object.prototype.propertyIsEnumerable,Ac=(t,e,r)=>e in t?P1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,F1=(t,e)=>{for(var r in e||(e={}))N1.call(e,r)&&Ac(t,r,e[r]);if(Cc)for(var r of Cc(e))R1.call(e,r)&&Ac(t,r,e[r]);return t};class U1{constructor(e){this.openModal=Ri.open,this.closeModal=Ri.close,this.subscribeModal=Ri.subscribe,this.setTheme=Ti.setThemeConfig,Ti.setConfig(F1({enableStandaloneMode:!0},e)),this.initUi()}async initUi(){if(typeof window<"u"){await import("./index-f0064dec.js");const e=document.createElement("w3m-modal");document.body.insertAdjacentElement("beforeend",e)}}}class L1 extends os{constructor({logger:e,chains:r,projectId:i,modalZIndex:n}){super(e,ni.WalletConnect,r),this.waitModalClose=()=>{let a;return new Promise((l,o)=>{a=this._web3Modal.subscribeModal(f=>{this.logger.debug(`modal.open: ${f.open.toString()}`),f.open===!1&&l()})}).then(a)},this.getRawProvider=()=>this.universalProvider,this._rpc={},r.forEach(a=>{a.rpcUrl&&(this._rpc[`${a.chainId}`]=a.rpcUrl)}),this._projectId=i,this._web3Modal=new U1({themeZIndex:n,projectId:this._projectId,themeMode:"light"}),this._waitInit=this.init()}async disconnect(){await this._waitInit,await super.disconnect(),await this._universalProvider.disconnect()}get canSwitchChain(){return!0}async switchChain(e){await this.disconnect(),await this.connect(e)}get isConnected(){return this._waitInit.then(()=>!!this._session)}get isInstalled(){return!0}get installUrl(){return""}async connect(e){const r=await this.universalProvider,i=this.waitModalClose(),n=r.connect({namespaces:{eip155:{methods:["eth_sendTransaction","eth_signTransaction","eth_sign","personal_sign","eth_signTypedData"],chains:[`eip155:${e}`],events:["chainChanged","accountsChanged"],rpcMap:this._rpc}}}),a=await Promise.race([i,n]);return a&&a.expiry?(this._session=a,this._web3Modal.closeModal(),!0):!1}async init(){this._universalProvider=await Yn.init({projectId:this._projectId,logger:"debug",relayUrl:"wss://relay.walletconnect.com"}),this.initListeners(this._universalProvider),this.subscribeToProviderEvents(this._universalProvider),this._session=this._universalProvider.session}get universalProvider(){return this._waitInit.then(()=>this._universalProvider)}async subscribeToProviderEvents(e){e.on("display_uri",async r=>{console.log("EVENT","QR Code Modal open"),this._web3Modal.openModal({uri:r})}),e.on("session_ping",({id:r,topic:i})=>{console.log("EVENT","session_ping"),console.log(r,i)}),e.on("session_event",({event:r,chainId:i})=>{console.log("EVENT","session_event"),console.log(r,i)}),e.on("session_update",({session:r})=>{console.log("EVENT","session_updated"),this._session=r}),e.on("session_delete",({id:r,topic:i})=>{console.log("EVENT","session_deleted"),console.log(r,i),this._session=void 0})}}export{Ri as A,Eu as C,vu as I,T1 as P,A1 as U,Ti as W,wt as a,L1 as b,ni as c,Jt as d,Ai as w,Oc as y};
//# sourceMappingURL=index-a5784253.js.map
